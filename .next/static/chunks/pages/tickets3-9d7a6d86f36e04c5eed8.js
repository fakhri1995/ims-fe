_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[139],{"/Fn9":function(e,t,c){"use strict";c.r(t),c.d(t,"__N_SSP",(function(){return T}));var a=c("DtFj"),n=c.n(a),s=c("FAat"),l=c.n(s),i=c("wXtC"),r=c.n(i),o=c("rmht"),d=c.n(o),u=c("iJl9"),j=c.n(u),h=c("4IMT"),m=c.n(h),b=c("nKUr"),f=c("rePB"),x=c("20a2"),O=c("q1tI"),p=c("YFqc"),g=c.n(p),k=c("l+S1"),_=c("ZV7/"),v=c("wd/R"),N=c.n(v),w=c("g6Xq"),y=c.n(w);function S(e,t){var c=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),c.push.apply(c,a)}return c}function C(e){for(var t=1;t<arguments.length;t++){var c=null!=arguments[t]?arguments[t]:{};t%2?S(Object(c),!0).forEach((function(t){Object(f.a)(e,t,c[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(c)):S(Object(c)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(c,t))}))}return e}var T=!0;t.default=function(e){var t=e.dataProfile,c=e.sidemenu,a=e.initProps,s=Object(x.useRouter)(),i=s.pathname.split("/").slice(1),o="",u="",h="",f="",p="",v=s.query,w=v.ticket_id,S=v.location_id,T=v.from,P=v.to,I=v.status_id;w&&(o=w),S&&(u=S),I&&(p=I),T&&(h=T),P&&(f=P);var z=Object(O.useState)([]),E=z[0],R=z[1],D=Object(O.useState)({status_ticket:[{id:0,name:""}],incident_type:[],requesters:[{user_id:0,fullname:"",company_id:0}],requester_companies:[],companies:{data:[{id:0,title:"",key:"",value:0}]}}),M=D[0],F=D[1],q=Object(O.useState)([]),V=(q[0],q[1]),Y=Object(O.useState)([]),A=(Y[0],Y[1]),H=Object(O.useState)({total_tickets:0,open_tickets_count:0,on_progress_tickets_count:0,on_hold_tickets_count:0,canceled_tickets_count:0,closed_tickets_count:0,tickets:{}}),J=H[0],B=H[1],G=Object(O.useState)({current_page:0,data:[],first_page_url:"",from:0,last_page:0,last_page_url:"",next_page_url:null,path:"",per_page:"",prev_page_url:"",to:0,total:0}),L=G[0],X=G[1],K=Object(O.useState)(""!==o),U=K[0],Z=K[1],Q=Object(O.useState)(null),W=Q[0],$=Q[1],ee=Object(O.useState)(""!==u),te=ee[0],ce=ee[1],ae=Object(O.useState)(null),ne=ae[0],se=ae[1],le=Object(O.useState)(!1),ie=(le[0],le[1]),re=Object(O.useState)([]),oe=(re[0],re[1]),de=Object(O.useState)(""!==h),ue=de[0],je=de[1],he=Object(O.useState)(null),me=he[0],be=he[1],fe=Object(O.useState)(""!==f),xe=fe[0],Oe=fe[1],pe=Object(O.useState)(null),ge=pe[0],ke=pe[1],_e=Object(O.useState)(""!==p),ve=_e[0],Ne=_e[1],we=Object(O.useState)(null),ye=we[0],Se=we[1],Ce=Object(O.useState)(u),Te=Ce[0],Pe=(Ce[1],Object(O.useState)(null)),Ie=Pe[0],ze=Pe[1],Ee=Object(O.useState)(0),Re=Ee[0],De=Ee[1],Me=Object(O.useState)(!0),Fe=Me[0],qe=Me[1],Ve=Object(O.useState)(!1),Ye=Ve[0],Ae=Ve[1],He=[{title:"No Ticket",dataIndex:"num",render:function(e,t,c){return{children:Object(b.jsx)(b.Fragment,{children:Object(b.jsx)("strong",{children:t.full_name})})}}},{title:"Raised By",dataIndex:"raised_by",render:function(e,t,c){return{children:Object(b.jsx)(b.Fragment,{children:t.task.creator.name})}}},{title:"Lokasi Problem",dataIndex:"location_problem",align:"center",render:function(e,t,c){return{children:Object(b.jsx)(b.Fragment,{children:0===t.task.location.id?"-":t.task.location.full_location})}}},{title:"Date Raised",dataIndex:"date_raised",render:function(e,t,c){return{children:Object(b.jsx)(b.Fragment,{children:t.raised_at})}}}],Je=function(e){"undefined"===typeof e?(window.location.href="/tickets?ticket_id=".concat(U?o:"","&location_id=&status_id=").concat(ve?p:"","&from=").concat(ue?h:"","&to=").concat(xe?f:""),ce(!1)):(ce(!0),se(e))},Be=function(e){"undefined"===typeof e?(window.location.href="/tickets?ticket_id=".concat(U?o:"","&location_id=").concat(te?u:"","&status_id=").concat(ve?p:"","&from=&to="),ie(!1),je(!1),Oe(!1)):(ie(!0),je(!0),Oe(!0),oe(e),be(N()(e[0]).locale("id").format("YYYY-MM-DD")),ke(N()(e[1]).locale("id").format("YYYY-MM-DD")))},Ge=function(e){"undefined"===typeof e?(window.location.href="/tickets?ticket_id=".concat(U?o:"","&location_id=").concat(te?u:"","&status_id=&from=").concat(ue?h:"","&to=").concat(xe?f:""),Ne(!1)):(Ne(!0),Se(e))};return Object(O.useEffect)((function(){fetch("https://boiling-thicket-46501.herokuapp.com/".concat(1===t.data.role?"getTickets":"getClientTickets","?ticket_id=").concat(o,"&location_id=").concat(u,"&status_id=").concat(p,"&from=").concat(h,"&to=").concat(f),{method:"GET",headers:{Authorization:JSON.parse(a)}}).then((function(e){return e.json()})).then((function(e){B(e.data),X(e.data),R(e.data.data),V(e.data.data),A(e.data.data)}))}),[]),Object(O.useEffect)((function(){fetch("https://boiling-thicket-46501.herokuapp.com/".concat(1===t.data.role?"getTicketRelation":"getClientTicketRelation"),{method:"GET",headers:{Authorization:JSON.parse(a)}}).then((function(e){return e.json()})).then((function(e){var c=[];if(1!==t.data.role){for(var a in e.data.status_ticket)c.push(e.data.status_ticket[a]);F(C(C({},e.data),{},{status_ticket:c}))}else F(e.data);ze(Te),qe(!1)}))}),[]),Object(b.jsxs)(_.a,{dataProfile:t,sidemenu:c,tok:a,st:y.a,pathArr:i,children:[Object(b.jsxs)("div",{className:" w-full grid grid-cols-1 md:grid-cols-4 border-gray-400 md:border-t md:border-b bg-white mb-5 px-4 py-5",children:[Object(b.jsxs)("div",{className:" col-span-1 md:col-span-3 flex items-center mb-2 md:mb-0",children:[Object(b.jsx)("div",{className:"font-bold text-2xl w-auto mr-14",children:"Tickets"}),Object(b.jsxs)("div",{className:"flex flex-col mr-10",children:[Object(b.jsxs)("div",{className:"flex items-center mb-2",children:[Object(b.jsx)("div",{className:"w-2 h-2 rounded-full bg-blue-500 mr-1"}),Object(b.jsx)("p",{className:"mb-0",children:"Open"})]}),Object(b.jsx)("div",{className:" text-lg text-center",children:J.open_tickets_count})]}),1===t.data.role&&Object(b.jsxs)("div",{className:"flex flex-col mr-10",children:[Object(b.jsxs)("div",{className:"flex items-center mb-2",children:[Object(b.jsx)("div",{className:"w-2 h-2 rounded-full bg-green-500 mr-1"}),Object(b.jsx)("p",{className:"mb-0",children:"On Progress"})]}),Object(b.jsx)("div",{className:" text-lg text-center",children:J.on_progress_tickets_count})]}),1===t.data.role&&Object(b.jsxs)("div",{className:"flex flex-col mr-10",children:[Object(b.jsxs)("div",{className:"flex items-center mb-2",children:[Object(b.jsx)("div",{className:"w-2 h-2 rounded-full bg-yellow-500 mr-1"}),Object(b.jsx)("p",{className:"mb-0",children:"On Hold"})]}),Object(b.jsx)("div",{className:" text-lg text-center",children:J.on_hold_tickets_count})]}),Object(b.jsxs)("div",{className:"flex flex-col mr-10",children:[Object(b.jsxs)("div",{className:"flex items-center mb-2",children:[Object(b.jsx)("div",{className:"w-2 h-2 rounded-full bg-red-500 mr-1"}),Object(b.jsx)("p",{className:"mb-0",children:"Cancel"})]}),Object(b.jsx)("div",{className:" text-lg text-center",children:J.canceled_tickets_count})]}),Object(b.jsxs)("div",{className:"flex flex-col mr-12",children:[Object(b.jsxs)("div",{className:"flex items-center mb-2",children:[Object(b.jsx)("div",{className:"w-2 h-2 rounded-full bg-gray-500 mr-1"}),Object(b.jsx)("p",{className:"mb-0",children:"Closed"})]}),Object(b.jsx)("div",{className:" text-lg text-center",children:J.closed_tickets_count})]}),Object(b.jsxs)("div",{className:"flex flex-col",children:[Object(b.jsx)("div",{className:"flex items-center mb-2",children:Object(b.jsx)("p",{className:"mb-0 font-bold text-lg",children:"Total Tiket"})}),Object(b.jsx)("div",{className:" font-bold text-xl text-center",children:J.total_tickets})]})]}),Object(b.jsxs)("div",{className:" col-span-1 md:col-span-1 flex md:justify-end items-center",children:[1===t.data.role?Object(b.jsx)(g.a,{href:"/tickets/histories",children:Object(b.jsx)(m.a,{size:"large",type:"primary",style:{marginRight:"1rem"},onClick:function(){s.push("/tickets/histories")},children:"History"})}):Object(b.jsx)(b.Fragment,{children:t.data.features.includes(108)&&Object(b.jsx)(g.a,{href:"/tickets/histories",children:Object(b.jsx)(m.a,{size:"large",type:"primary",style:{marginRight:"1rem"},onClick:function(){s.push("/tickets/histories")},children:"History"})})}),1===t.data.role&&Object(b.jsx)(g.a,{href:"/tickets/exporting?closed=0",children:Object(b.jsx)(m.a,{style:{backgroundColor:"gray",borderColor:"gray",marginRight:"1rem"},size:"large",type:"primary",children:"Export"})}),Object(b.jsx)(g.a,{href:"/tickets/create",children:Object(b.jsx)(m.a,{size:"large",type:"primary",children:"Buat Tiket"})})]})]}),Object(b.jsx)("div",{className:"h-auto w-full grid grid-cols-1 md:grid-cols-5 mb-5 bg-white rounded-md",children:Object(b.jsxs)("div",{className:"md:col-span-5 col-span-1 flex flex-col py-3",children:[Fe?null:Object(b.jsx)("div",{className:"flex mb-8",children:Object(b.jsxs)("div",{className:" w-full mr-1 grid grid-cols-12",children:[Object(b.jsxs)("div",{className:"col-span-3 mr-1 flex flex-col",children:[Object(b.jsx)(j.a,{defaultValue:o,style:{width:"100%",marginRight:"0.5rem"},placeholder:"Cari Ticket Number",onChange:function(e){""===e.target.value?(window.location.href="/tickets?ticket_id=&location_id=".concat(te?u:"","&status_id=").concat(ve?p:"","&from=").concat(ue?h:"","&to=").concat(xe?f:""),Z(!1)):/(^\d*$)/.test(e.target.value)?(Ae(!1),Z(!0),$(e.target.value)):Ae(!0)},allowClear:!0}),Ye&&Object(b.jsx)("p",{className:"mb-0 text-xs text-red-400",children:"Ticket number harus angka"})]}),Object(b.jsx)("div",{className:"col-span-3 mr-1",children:Object(b.jsx)(d.a,{defaultValue:""===Te?null:Number(Ie),placeholder:"Lokasi Problem",style:{width:"100%"},allowClear:!0,onChange:function(e,t,c){"undefined"===typeof e?Je():Je(e)},treeData:1===t.data.role?[M.companies]:[M.companies.data],treeDefaultExpandAll:!0})}),Object(b.jsx)("div",{className:"col-span-3 mr-1",children:Object(b.jsx)(r.a.RangePicker,{defaultValue:""===h&&""===f?null:[N()(h),N()(f)],style:{width:"100%"},placeholder:["Tanggal Awal","Tanggal Akhir"],onChange:function(e,t){""===t[0]&&""===t[1]?Be():Be(t)}})}),Object(b.jsx)("div",{className:"col-span-2 mr-1",children:Object(b.jsx)(l.a,{defaultValue:""===p?null:Number(p),placeholder:"Status",style:{width:"100%"},allowClear:!0,onChange:function(e){"undefined"===typeof e?Ge():Ge(e)},children:M.status_ticket.map((function(e,t){return Object(b.jsx)(l.a.Option,{value:e.id,children:e.name})}))})}),Object(b.jsx)("div",{className:" col-span-1",children:Object(b.jsx)(m.a,{type:"primary",style:{width:"100%"},onClick:function(){!1===Ye&&(window.location.href="/tickets?ticket_id=".concat(U?null===W?o:W:"","&location_id=").concat(te?null===ne?u:ne:"","&status=").concat(ve?null===ye?p:ye:"","&from=").concat(ue?null===me?h:me:"","&to=").concat(xe?null===ge?f:ge:""))},children:Object(b.jsx)(k.a,{})})})]})}),Object(b.jsx)("div",{className:"px-6",children:Object(b.jsx)(n.a,{pagination:{pageSize:10,total:L.total,onChange:function(e,c){qe(!0),fetch("https://boiling-thicket-46501.herokuapp.com/".concat(1===t.data.role?"getTickets":"getClientTickets","?page=").concat(e,"&rows=10&ticket_id=").concat(o,"&location_id=").concat(u,"&status_id=").concat(p,"&from=").concat(h,"&to=").concat(f),{method:"GET",headers:{Authorization:JSON.parse(a)}}).then((function(e){return e.json()})).then((function(e){X(e.data.tickets),R(e.data.tickets.data),V(e.data.tickets.data),A(e.data.tickets.data),qe(!1)}))}},scroll:{x:200},dataSource:E,columns:He,loading:Fe,onRow:function(e,c){return{onMouseOver:function(t){De(e.id)},onClick:function(c){(1===t.data.role||t.data.features.includes(109))&&s.push("/tickets/detail/".concat(e.id))}}},rowClassName:function(e,t){return e.id===Re?"cursor-pointer":""}})})]})})]})}},Tqig:function(e,t,c){(window.__NEXT_P=window.__NEXT_P||[]).push(["/tickets3",function(){return c("/Fn9")}])},"ZV7/":function(e,t,c){"use strict";var a=c("MM9K"),n=c.n(a),s=c("Y/VR"),l=c.n(s),i=c("nKUr"),r=c("d2CI"),o=c.n(r),d=c("q1tI"),u=c("20a2"),j=c("YFqc"),h=c.n(j),m=c("p46w"),b=c.n(m),f=c("2MCQ"),x=c.n(f),O=c("MjGk"),p=c.n(O),g=c("Gv1R"),k=c("cPPd");t.a=function(e){var t=e.children,c=e.tok,a=e.dataProfile,s=e.pathArr,r=e.sidemenu,j=e.st,m=Object(u.useRouter)(),f=[];if(s)for(var O=0;O<s.length;O++)f.push(s[O]);var _=f.map((function(e,t){return e[0].toUpperCase()+e.slice(1)})),v=(o.a.Sider,o.a.Content,o.a.Header),N=Object(d.useState)(!0),w=N[0],y=N[1],S=Object(d.useState)(!0),C=S[0],T=S[1],P=Object(d.useState)(90),I=(P[0],P[1]),z=Object(d.useState)(!1),E=z[0],R=z[1],D=function(){y((function(e){return!e}))},M=function(){T((function(e){return!e}))};Object(d.useEffect)((function(){var e=window.innerHeight;I(e)}),[]);var F="";return Object(i.jsx)(n.a,{spinning:E,children:Object(i.jsxs)("div",{className:" min-h-screen flex",children:[Object(i.jsx)(g.a,{dataProfile:a,handleCollSmall:M,sidemenu:r,coll:w,collsmall:C,st:j}),Object(i.jsxs)("div",{className:"h-auto w-full",children:[Object(i.jsxs)(v,{className:"site-layout-background",style:{padding:0,backgroundColor:"white",display:"flex",alignItems:"center",flexDirection:"row",flexWrap:"wrap",width:"100%",justifyContent:"space-between",height:"auto"},children:[Object(i.jsxs)("div",{className:"flex z-50",children:[w?Object(i.jsx)(x.a,{onClick:D,style:{padding:"24px",float:"left",marginTop:"0.3rem"},className:j.trigger}):Object(i.jsx)(p.a,{onClick:D,style:{padding:"24px",float:"left"},className:j.trigger}),C?Object(i.jsx)(x.a,{onClick:M,style:{padding:"24px",float:"left",marginTop:"0.3rem"},className:j.triggerSmall}):Object(i.jsx)(p.a,{onClick:M,style:{padding:"24px",float:"left"},className:j.triggerSmall}),s?Object(i.jsx)(l.a,{separator:">",style:{float:"left",padding:"24px 10px",backgroundColor:"white"},className:j.breadcrumbClients,children:0!==_.length?_.map((function(e,t){return F+="/".concat(s[t]),0===t?"incidents"===s[t]?Object(i.jsxs)(l.a.Item,{children:[" ",Object(i.jsx)("strong",{children:e})," "]},t):Object(i.jsxs)(l.a.Item,{href:"/".concat(s[t]),children:[" ",Object(i.jsx)("strong",{children:e})," "]},t):t===_.length-1&&t>0?Object(i.jsxs)(l.a.Item,{children:[" ",Object(i.jsx)("strong",{children:e})," "]},t):Object(i.jsx)(l.a.Item,{href:F,children:Object(i.jsx)("strong",{children:e})},t)})):null}):null]}),Object(i.jsx)("label",{htmlFor:"menutoggle",className:"pointer-cursor md:hidden block cursor-pointer mr-4",children:Object(i.jsxs)("svg",{className:"fill-current text-gray-900",xmlns:"http://www.w3.org/2000/svg",width:20,height:20,viewBox:"0 0 20 20",children:[Object(i.jsx)("title",{children:"menu"}),Object(i.jsx)("path",{d:"M0 3h20v2H0V3zm0 6h20v2H0V9zm0 6h20v2H0v-2z"})]})}),Object(i.jsx)("input",{className:"hidden ".concat(j.menuToggle),type:"checkbox",id:"menutoggle"}),Object(i.jsx)(k.a,{dataProfile:a,Linkheader:h.a,handleLogout:function(){R(!0),fetch("https://boiling-thicket-46501.herokuapp.com/logout",{method:"POST",headers:{"Content-Type":"application/json",Authorization:JSON.parse(c)}}).then((function(e){return e.json()})).then((function(e){R(!1),e.success&&(b.a.remove("token"),console.log("token abis logout: "+b.a.get("token")),m.push("/login"))})).catch((function(e){R(!1),console.log(e.message)}))},st:j}),s?Object(i.jsx)(l.a,{separator:">",style:{float:"left",padding:"24px 24px",fontSize:"0.825rem",width:"100%"},className:j.breadcrumbClientsSmall,children:0!==_.length?_.map((function(e,t){return F+="/".concat(s[t]),0===t?Object(i.jsxs)(l.a.Item,{href:"/".concat(s[t]),children:[" ",Object(i.jsx)("strong",{children:e})," "]},t):t===_.length-1&&t>0?Object(i.jsxs)(l.a.Item,{children:[" ",Object(i.jsx)("strong",{children:e})," "]},t):Object(i.jsx)(l.a.Item,{href:F,children:Object(i.jsx)("strong",{children:e})},t)})):null}):null]}),Object(i.jsx)("main",{className:"slb bg-white",style:{padding:24,height:"auto"},children:t})]})]})})}},"l+S1":function(e,t,c){"use strict";var a=c("VTBJ"),n=c("q1tI"),s={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M909.6 854.5L649.9 594.8C690.2 542.7 712 479 712 412c0-80.2-31.3-155.4-87.9-212.1-56.6-56.7-132-87.9-212.1-87.9s-155.5 31.3-212.1 87.9C143.2 256.5 112 331.8 112 412c0 80.1 31.3 155.5 87.9 212.1C256.5 680.8 331.8 712 412 712c67 0 130.6-21.8 182.7-62l259.7 259.6a8.2 8.2 0 0011.6 0l43.6-43.5a8.2 8.2 0 000-11.6zM570.4 570.4C528 612.7 471.8 636 412 636s-116-23.3-158.4-65.6C211.3 528 188 471.8 188 412s23.3-116.1 65.6-158.4C296 211.3 352.2 188 412 188s116.1 23.2 158.4 65.6S636 352.2 636 412s-23.3 116.1-65.6 158.4z"}}]},name:"search",theme:"outlined"},l=c("6VBw"),i=function(e,t){return n.createElement(l.a,Object(a.a)(Object(a.a)({},e),{},{ref:t,icon:s}))};i.displayName="SearchOutlined";t.a=n.forwardRef(i)}},[["Tqig",0,2,18,1,3,4,5,6,7,8,9,11,13,17,16,19,20]]]);