_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[51],{FAat:function(e,t,a){"use strict";var n=a("TqRt"),r=a("cDf5");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a("lSNA")),s=n(a("pVnL")),o=j(a("q1tI")),c=n(a("+04X")),l=n(a("TSYQ")),d=j(a("LdHM")),u=a("vgIT"),p=n(a("xcGM")),m=n(a("fVhf")),f=a("StrI");function b(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(b=function(e){return e?a:t})(e)}function j(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!==typeof e)return{default:e};var a=b(t);if(a&&a.has(e))return a.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var o=i?Object.getOwnPropertyDescriptor(e,s):null;o&&(o.get||o.set)?Object.defineProperty(n,s,o):n[s]=e[s]}return n.default=e,a&&a.set(e,n),n}var g=function(e,t){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(a[n[r]]=e[n[r]])}return a},h="SECRET_COMBOBOX_MODE_DO_NOT_USE",O=function(e,t){var a,n,r=e.prefixCls,b=e.bordered,j=void 0===b||b,O=e.className,v=e.getPopupContainer,w=e.dropdownClassName,x=e.listHeight,y=void 0===x?256:x,_=e.listItemHeight,P=void 0===_?24:_,N=e.size,C=e.notFoundContent,I=g(e,["prefixCls","bordered","className","getPopupContainer","dropdownClassName","listHeight","listItemHeight","size","notFoundContent"]),S=o.useContext(u.ConfigContext),q=S.getPopupContainer,E=S.getPrefixCls,k=S.renderEmpty,T=S.direction,A=S.virtual,M=S.dropdownMatchSelectWidth,z=o.useContext(m.default),F=E("select",r),B=E(),D=o.useMemo((function(){var e=I.mode;if("combobox"!==e)return e===h?"combobox":e}),[I.mode]),H="multiple"===D||"tags"===D;n=void 0!==C?C:"combobox"===D?null:k("Select");var J=(0,p.default)((0,s.default)((0,s.default)({},I),{multiple:H,prefixCls:F})),L=J.suffixIcon,R=J.itemIcon,V=J.removeIcon,G=J.clearIcon,W=(0,c.default)(I,["suffixIcon","itemIcon"]),U=(0,l.default)(w,(0,i.default)({},"".concat(F,"-dropdown-").concat(T),"rtl"===T)),X=N||z,K=(0,l.default)((a={},(0,i.default)(a,"".concat(F,"-lg"),"large"===X),(0,i.default)(a,"".concat(F,"-sm"),"small"===X),(0,i.default)(a,"".concat(F,"-rtl"),"rtl"===T),(0,i.default)(a,"".concat(F,"-borderless"),!j),a),O);return o.createElement(d.default,(0,s.default)({ref:t,virtual:A,dropdownMatchSelectWidth:M},W,{transitionName:(0,f.getTransitionName)(B,"slide-up",I.transitionName),listHeight:y,listItemHeight:P,mode:D,prefixCls:F,direction:T,inputIcon:L,menuItemSelectedIcon:R,removeIcon:V,clearIcon:G,notFoundContent:n,className:K,getPopupContainer:v||q,dropdownClassName:U}))},v=o.forwardRef(O);v.SECRET_COMBOBOX_MODE_DO_NOT_USE=h,v.Option=d.Option,v.OptGroup=d.OptGroup;var w=v;t.default=w},pqcj:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/agents/create",function(){return a("zTnF")}])},rg98:function(e,t,a){"use strict";function n(e,t,a,n,r,i,s){try{var o=e[i](s),c=o.value}catch(l){return void a(l)}o.done?t(c):Promise.resolve(c).then(n,r)}function r(e){return function(){var t=this,a=arguments;return new Promise((function(r,i){var s=e.apply(t,a);function o(e){n(s,r,i,o,c,"next",e)}function c(e){n(s,r,i,o,c,"throw",e)}o(void 0)}))}}a.d(t,"a",(function(){return r}))},ye1Q:function(e,t,a){"use strict";var n=a("VTBJ"),r=a("q1tI"),i={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M988 548c-19.9 0-36-16.1-36-36 0-59.4-11.6-117-34.6-171.3a440.45 440.45 0 00-94.3-139.9 437.71 437.71 0 00-139.9-94.3C629 83.6 571.4 72 512 72c-19.9 0-36-16.1-36-36s16.1-36 36-36c69.1 0 136.2 13.5 199.3 40.3C772.3 66 827 103 874 150c47 47 83.9 101.8 109.7 162.7 26.7 63.1 40.2 130.2 40.2 199.3.1 19.9-16 36-35.9 36z"}}]},name:"loading",theme:"outlined"},s=a("6VBw"),o=function(e,t){return r.createElement(s.a,Object(n.a)(Object(n.a)({},e),{},{ref:t,icon:i}))};o.displayName="LoadingOutlined";t.a=r.forwardRef(o)},zTnF:function(e,t,a){"use strict";a.r(t),a.d(t,"__N_SSP",(function(){return D}));var n=a("FAat"),r=a.n(n),i=a("nKUr"),s=a("iJl9"),o=a.n(s),c=a("rmht"),l=a.n(c),d=a("B8+X"),u=a.n(d),p=a("4IMT"),m=a.n(p),f=a("vJKn"),b=a.n(f),j=a("rg98"),g=a("cpVT"),h=a("rR1Q"),O=a.n(h),v=a("qu0K"),w=a.n(v),x=a("xvhg"),y=a("ye1Q"),_=a("VTBJ"),P=a("q1tI"),N={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M482 152h60q8 0 8 8v704q0 8-8 8h-60q-8 0-8-8V160q0-8 8-8z"}},{tag:"path",attrs:{d:"M176 474h672q8 0 8 8v60q0 8-8 8H176q-8 0-8-8v-60q0-8 8-8z"}}]},name:"plus",theme:"outlined"},C=a("6VBw"),I=function(e,t){return P.createElement(C.a,Object(_.a)(Object(_.a)({},e),{},{ref:t,icon:N}))};I.displayName="PlusOutlined";var S=P.forwardRef(I),q=a("YFqc"),E=a.n(q),k=a("20a2"),T=a("vgPz"),A=a("p/jd"),M=a("qe3g"),z=a.n(M);function F(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function B(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?F(Object(a),!0).forEach((function(t){Object(g.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):F(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var D=!0;t.default=function(e){var t=e.initProps,a=e.dataProfile,n=e.sidemenu,s=Object(k.useRouter)(),c=s.query.originPath,d=t,p=s.pathname.split("/").slice(1);p[p.length-1]="Create";var f=w.a.useForm(),h=Object(x.a)(f,1)[0],v=Object(P.useState)({fullname:"",email:"",role_ids:[],phone_number:"",profile_image:"",company_id:1,password:"",confirm_password:"",position:""}),_=v[0],N=v[1],C=Object(P.useState)(!1),I=C[0],q=C[1],M=Object(P.useState)(!1),F=M[0],D=M[1],H=Object(P.useState)([]),J=H[0],L=H[1],R=Object(P.useState)([]),V=R[0],G=R[1],W=Object(P.useState)(!0),U=W[0],X=W[1],K=function(e){var t=e.target.value;"role"===e.target.name&&(t=parseInt(e.target.value)),N(B(B({},_),{},Object(g.a)({},e.target.name,t)))},Q=function(){var e=Object(j.a)(b.a.mark((function e(t){var a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("uploading"!==t.file.status){e.next=3;break}return q(!0),e.abrupt("return");case 3:if("done"!==t.file.status){e.next=9;break}return console.log("isi upload: "+t.file.originFileObj.name),(a=new FormData).append("file",t.file.originFileObj),a.append("upload_preset","migsys"),e.abrupt("return",fetch("https://api.Cloudinary.com/v1_1/aqlpeduli/image/upload",{method:"POST",body:a}).then((function(e){return e.json()})).then((function(e){N(B(B({},_),{},{profile_image:e.secure_url}))})));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Y=Object(i.jsxs)("div",{children:[I?Object(i.jsx)(y.a,{}):Object(i.jsx)(S,{}),Object(i.jsx)("div",{style:{marginTop:8},children:"Unggah"})]});return Object(P.useEffect)((function(){fetch("".concat("https://service-staging.mig.id","/getBranchCompanyList"),{method:"GET",headers:{Authorization:JSON.parse(t)}}).then((function(e){return e.json()})).then((function(e){L([e.data]),X(!1)}))}),[]),Object(P.useEffect)((function(){fetch("".concat("https://service-staging.mig.id","/getRoles"),{method:"GET",headers:{Authorization:JSON.parse(t)}}).then((function(e){return e.json()})).then((function(e){G(e.data)}))}),[]),Object(i.jsx)(A.a,{tok:d,dataProfile:a,pathArr:p,sidemenu:n,originPath:c,st:z.a,children:Object(i.jsxs)("div",{className:"w-full h-auto grid grid-cols-1 md:grid-cols-4",id:"createAgentsWrapper",children:[Object(i.jsx)("div",{className:" col-span-1 md:col-span-4",children:Object(i.jsx)(T.a,{containerSelectorFocus:"#createAgentsWrapper",children:Object(i.jsxs)("div",{className:" col-span-4 flex justify-between p-2 pt-4 border-t-2 border-b-2 bg-white mb-8",children:[Object(i.jsx)("h1",{className:"font-semibold py-2",children:"Buat Akun Agent"}),Object(i.jsxs)("div",{className:"flex space-x-2",children:[Object(i.jsx)(E.a,{href:"/admin/agents",children:Object(i.jsx)(m.a,{type:"default",children:"Batal"})}),Object(i.jsx)(m.a,{disabled:U,type:"primary",loading:F,onClick:h.submit,children:"Simpan"})]})]})})}),Object(i.jsx)("div",{className:"col-span-1 md:col-span-3 flex flex-col",children:Object(i.jsxs)("div",{className:"shadow-lg flex flex-col rounded-md w-full h-auto p-4 mb-14",children:[Object(i.jsxs)("div",{className:"border-b border-black p-4 font-semibold mb-5",children:["Akun Agent - ",_.fullname]}),Object(i.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4",children:[Object(i.jsx)("div",{className:"p-3 col-span-1 md:col-span-1",children:Object(i.jsx)(u.a,{name:"profile_image",listType:"picture-card",className:"profileImage",showUploadList:!1,beforeUpload:function(e){var t="image/jpeg"===e.type||"image/png"===e.type||"image/jpg"===e.type;t||message.error("You can only upload JPG/PNG file!");var a=e.size/1024/1024<2;return a||message.error("Image must smaller than 2MB!"),t&&a},onChange:Q,children:_.profile_image?Object(i.jsx)("img",{src:_.profile_image,alt:"avatar",style:{width:"100%"}}):Y})}),Object(i.jsx)("div",{className:"p-3 col-span-1 md:col-span-3",children:Object(i.jsxs)(w.a,{layout:"vertical",form:h,className:"createAgentsForm",onFinish:function(){D(!0),fetch("".concat("https://service-staging.mig.id","/addAgentMember"),{method:"POST",headers:{Authorization:JSON.parse(d),"Content-Type":"application/json"},body:JSON.stringify(_)}).then((function(e){return e.json()})).then((function(e){D(!1),e.success?(O.a.success({message:e.message,duration:3}),setTimeout((function(){s.push("/admin/agents/detail/".concat(e.id))}),1e3)):e.success||O.a.error({message:e.message,duration:3})})),console.log("isi new user: "+_.profile_image)},children:[Object(i.jsx)(w.a.Item,{label:"Asal Lokasi",name:"company_id",rules:[{required:!0,message:"Asal Lokasi wajib diisi"}],children:Object(i.jsx)(l.a,{allowClear:!0,dropdownStyle:{maxHeight:400,overflow:"auto"},treeData:J,placeholder:"Pilih Asal Lokasi",treeDefaultExpandAll:!0,onChange:function(e){N(B(B({},_),{},{company_id:e}))}})}),Object(i.jsx)(w.a.Item,{label:"Nama Lengkap",required:!0,name:"fullname",rules:[{required:!0,message:"Nama Lengkap wajib diisi"}],children:Object(i.jsx)(o.a,{value:_.fullname,name:"fullname",onChange:K})}),Object(i.jsx)(w.a.Item,{label:"Email",required:!0,name:"email",rules:[{required:!0,message:"Email wajib diisi"},{pattern:/(\-)|(^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$)/,message:"Email belum diisi dengan benar"}],children:Object(i.jsx)(o.a,{value:_.email,name:"email",onChange:K})}),Object(i.jsx)(w.a.Item,{label:"Posisi",required:!0,name:"position",rules:[{required:!0,message:"Posisi wajib diisi"}],children:Object(i.jsx)(o.a,{value:_.position,name:"position",onChange:K})}),Object(i.jsx)(w.a.Item,{label:"No. Handphone",name:"phone_number",rules:[{required:!0,message:"No.Handphone wajib diisi"},{pattern:/(\-)|(^\d*$)/,message:"No. Handphone harus berisi angka"}],children:Object(i.jsx)(o.a,{value:_.phone_number,name:"phone_number",onChange:K})}),Object(i.jsx)(w.a.Item,{label:"Password",name:"password",rules:[{required:!0,message:"Password wajib diisi"},{pattern:/([A-z0-9]{8})/,message:"Password minimal 8 karakter"}],children:Object(i.jsx)(o.a.Password,{value:_.password,name:"password",onChange:K})}),Object(i.jsx)(w.a.Item,{label:"Konfirmasi Password",name:"password",rules:[{required:!0,message:"Confirm Password wajib diisi"},{pattern:/([A-z0-9]{8})/,message:"Confirm Password minimal 8 karakter"}],children:Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)(o.a.Password,{value:_.confirm_password,name:"confirm_password",onChange:K}),_.password!==_.confirm_password&&Object(i.jsx)("p",{className:" text-red-500 mb-0",children:"Confirm Password harus sesuai dengan password"})]})}),Object(i.jsx)(w.a.Item,{label:"Role",name:"role",children:Object(i.jsx)(r.a,{mode:"multiple",onChange:function(e){N(B(B({},_),{},{role_ids:e}))},style:{width:"100%"},children:V.map((function(e,t){return Object(i.jsx)(r.a.Option,{value:e.id,children:e.name},e.id)}))})})]})})]})]})})]})})}}},[["pqcj",0,2,1,3,4,5,6,7,9,10,11,13,18,29,37]]]);