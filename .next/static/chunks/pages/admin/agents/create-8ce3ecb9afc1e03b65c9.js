_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[52],{"UQ9/":function(e,a,t){"use strict";t.r(a),t.d(a,"__N_SSP",(function(){return D}));var n=t("FAat"),s=t.n(n),r=t("nKUr"),i=t("iJl9"),o=t.n(i),c=t("rmht"),l=t.n(c),d=t("B8+X"),u=t.n(d),m=t("4IMT"),p=t.n(m),j=t("o0o1"),b=t.n(j),h=t("HaE+"),f=t("rePB"),g=t("rR1Q"),O=t.n(g),w=t("qu0K"),x=t.n(w),v=t("ODXe"),y=t("Nfnr"),_=t("20a2"),P=t("ye1Q"),N=t("VTBJ"),k=t("q1tI"),q={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M482 152h60q8 0 8 8v704q0 8-8 8h-60q-8 0-8-8V160q0-8 8-8z"}},{tag:"path",attrs:{d:"M176 474h672q8 0 8 8v60q0 8-8 8H176q-8 0-8-8v-60q0-8 8-8z"}}]},name:"plus",theme:"outlined"},A=t("6VBw"),C=function(e,a){return k.createElement(A.a,Object(N.a)(Object(N.a)({},e),{},{ref:a,icon:q}))};C.displayName="PlusOutlined";var S=k.forwardRef(C),E=t("vgPz"),I=t("YFqc"),T=t.n(I),z=t("g6Xq"),B=t.n(z);function F(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);a&&(n=n.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),t.push.apply(t,n)}return t}function J(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?F(Object(t),!0).forEach((function(a){Object(f.a)(e,a,t[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):F(Object(t)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))}))}return e}var D=!0;a.default=function(e){var a=e.initProps,t=e.dataProfile,n=e.sidemenu,i=Object(_.useRouter)(),c=i.query.originPath,d=a,m=i.pathname.split("/").slice(1);m[m.length-1]="Create";var j=x.a.useForm(),g=Object(v.a)(j,1)[0],w=Object(k.useState)({fullname:"",email:"",role_ids:[],phone_number:"",profile_image:"",company_id:1,password:"",confirm_password:"",position:""}),N=w[0],q=w[1],A=Object(k.useState)(!1),C=A[0],I=A[1],z=Object(k.useState)(!1),F=z[0],D=z[1],L=Object(k.useState)([]),H=L[0],M=L[1],R=Object(k.useState)([]),U=R[0],Q=R[1],V=Object(k.useState)(!0),X=V[0],G=V[1],K=function(e){var a=e.target.value;"role"===e.target.name&&(a=parseInt(e.target.value)),q(J(J({},N),{},Object(f.a)({},e.target.name,a)))},W=function(){var e=Object(h.a)(b.a.mark((function e(a){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("uploading"!==a.file.status){e.next=3;break}return I(!0),e.abrupt("return");case 3:if("done"!==a.file.status){e.next=9;break}return console.log("isi upload: "+a.file.originFileObj.name),(t=new FormData).append("file",a.file.originFileObj),t.append("upload_preset","migsys"),e.abrupt("return",fetch("https://api.Cloudinary.com/v1_1/aqlpeduli/image/upload",{method:"POST",body:t}).then((function(e){return e.json()})).then((function(e){q(J(J({},N),{},{profile_image:e.secure_url}))})));case 9:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}(),Y=Object(r.jsxs)("div",{children:[C?Object(r.jsx)(P.a,{}):Object(r.jsx)(S,{}),Object(r.jsx)("div",{style:{marginTop:8},children:"Unggah"})]});return Object(k.useEffect)((function(){fetch("https://boiling-thicket-46501.herokuapp.com/getBranchCompanyList",{method:"GET",headers:{Authorization:JSON.parse(a)}}).then((function(e){return e.json()})).then((function(e){M([e.data]),G(!1)}))}),[]),Object(k.useEffect)((function(){fetch("https://boiling-thicket-46501.herokuapp.com/getRoles",{method:"GET",headers:{Authorization:JSON.parse(a)}}).then((function(e){return e.json()})).then((function(e){Q(e.data)}))}),[]),Object(r.jsx)(y.a,{tok:d,dataProfile:t,pathArr:m,sidemenu:n,originPath:c,st:B.a,children:Object(r.jsxs)("div",{className:"w-full h-auto grid grid-cols-1 md:grid-cols-4",id:"createAgentsWrapper",children:[Object(r.jsx)("div",{className:" col-span-1 md:col-span-4",children:Object(r.jsx)(E.a,{containerSelectorFocus:"#createAgentsWrapper",children:Object(r.jsxs)("div",{className:" col-span-4 flex justify-between p-2 pt-4 border-t-2 border-b-2 bg-white mb-8",children:[Object(r.jsx)("h1",{className:"font-semibold py-2",children:"Buat Akun Agent"}),Object(r.jsxs)("div",{className:"flex space-x-2",children:[Object(r.jsx)(T.a,{href:"/admin/agents",children:Object(r.jsx)(p.a,{type:"default",children:"Batal"})}),Object(r.jsx)(p.a,{disabled:X,type:"primary",loading:F,onClick:g.submit,children:"Simpan"})]})]})})}),Object(r.jsx)("div",{className:"col-span-1 md:col-span-3 flex flex-col",children:Object(r.jsxs)("div",{className:"shadow-lg flex flex-col rounded-md w-full h-auto p-4 mb-14",children:[Object(r.jsxs)("div",{className:"border-b border-black p-4 font-semibold mb-5",children:["Akun Agent - ",N.fullname]}),Object(r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4",children:[Object(r.jsx)("div",{className:"p-3 col-span-1 md:col-span-1",children:Object(r.jsx)(u.a,{name:"profile_image",listType:"picture-card",className:"profileImage",showUploadList:!1,beforeUpload:function(e){var a="image/jpeg"===e.type||"image/png"===e.type||"image/jpg"===e.type;a||message.error("You can only upload JPG/PNG file!");var t=e.size/1024/1024<2;return t||message.error("Image must smaller than 2MB!"),a&&t},onChange:W,children:N.profile_image?Object(r.jsx)("img",{src:N.profile_image,alt:"avatar",style:{width:"100%"}}):Y})}),Object(r.jsx)("div",{className:"p-3 col-span-1 md:col-span-3",children:Object(r.jsxs)(x.a,{layout:"vertical",form:g,className:"createAgentsForm",onFinish:function(){D(!0),fetch("https://boiling-thicket-46501.herokuapp.com/addAgentMember",{method:"POST",headers:{Authorization:JSON.parse(d),"Content-Type":"application/json"},body:JSON.stringify(N)}).then((function(e){return e.json()})).then((function(e){D(!1),e.success?(O.a.success({message:e.message,duration:3}),setTimeout((function(){i.push("/admin/agents/detail/".concat(e.id))}),1e3)):e.success||O.a.error({message:e.message,duration:3})})),console.log("isi new user: "+N.profile_image)},children:[Object(r.jsx)(x.a.Item,{label:"Asal Lokasi",name:"company_id",rules:[{required:!0,message:"Asal Lokasi wajib diisi"}],children:Object(r.jsx)(l.a,{allowClear:!0,dropdownStyle:{maxHeight:400,overflow:"auto"},treeData:H,placeholder:"Pilih Asal Lokasi",treeDefaultExpandAll:!0,onChange:function(e){q(J(J({},N),{},{company_id:e}))}})}),Object(r.jsx)(x.a.Item,{label:"Nama Lengkap",required:!0,name:"fullname",rules:[{required:!0,message:"Nama Lengkap wajib diisi"}],children:Object(r.jsx)(o.a,{value:N.fullname,name:"fullname",onChange:K})}),Object(r.jsx)(x.a.Item,{label:"Email",required:!0,name:"email",rules:[{required:!0,message:"Email wajib diisi"},{pattern:/(\-)|(^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$)/,message:"Email belum diisi dengan benar"}],children:Object(r.jsx)(o.a,{value:N.email,name:"email",onChange:K})}),Object(r.jsx)(x.a.Item,{label:"Posisi",required:!0,name:"position",rules:[{required:!0,message:"Posisi wajib diisi"}],children:Object(r.jsx)(o.a,{value:N.position,name:"position",onChange:K})}),Object(r.jsx)(x.a.Item,{label:"No. Handphone",name:"phone_number",rules:[{required:!0,message:"No.Handphone wajib diisi"},{pattern:/(\-)|(^\d*$)/,message:"No. Handphone harus berisi angka"}],children:Object(r.jsx)(o.a,{value:N.phone_number,name:"phone_number",onChange:K})}),Object(r.jsx)(x.a.Item,{label:"Password",name:"password",rules:[{required:!0,message:"Password wajib diisi"},{pattern:/([A-z0-9]{8})/,message:"Password minimal 8 karakter"}],children:Object(r.jsx)(o.a.Password,{value:N.password,name:"password",onChange:K})}),Object(r.jsx)(x.a.Item,{label:"Konfirmasi Password",name:"password",rules:[{required:!0,message:"Confirm Password wajib diisi"},{pattern:/([A-z0-9]{8})/,message:"Confirm Password minimal 8 karakter"}],children:Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(o.a.Password,{value:N.confirm_password,name:"confirm_password",onChange:K}),N.password!==N.confirm_password&&Object(r.jsx)("p",{className:" text-red-500 mb-0",children:"Confirm Password harus sesuai dengan password"})]})}),Object(r.jsx)(x.a.Item,{label:"Role",name:"role",children:Object(r.jsx)(s.a,{mode:"multiple",onChange:function(e){q(J(J({},N),{},{role_ids:e}))},style:{width:"100%"},children:U.map((function(e,a){return Object(r.jsx)(s.a.Option,{value:e.id,children:e.name},e.id)}))})})]})})]})]})})]})})}},pqcj:function(e,a,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/agents/create",function(){return t("UQ9/")}])},ye1Q:function(e,a,t){"use strict";var n=t("VTBJ"),s=t("q1tI"),r={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M988 548c-19.9 0-36-16.1-36-36 0-59.4-11.6-117-34.6-171.3a440.45 440.45 0 00-94.3-139.9 437.71 437.71 0 00-139.9-94.3C629 83.6 571.4 72 512 72c-19.9 0-36-16.1-36-36s16.1-36 36-36c69.1 0 136.2 13.5 199.3 40.3C772.3 66 827 103 874 150c47 47 83.9 101.8 109.7 162.7 26.7 63.1 40.2 130.2 40.2 199.3.1 19.9-16 36-35.9 36z"}}]},name:"loading",theme:"outlined"},i=t("6VBw"),o=function(e,a){return s.createElement(i.a,Object(n.a)(Object(n.a)({},e),{},{ref:a,icon:r}))};o.displayName="LoadingOutlined";a.a=s.forwardRef(o)}},[["pqcj",0,2,1,3,4,5,6,7,8,9,10,12,16,30,38]]]);