_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[138],{"/Fn9":function(e,t,c){"use strict";c.r(t),c.d(t,"__N_SSP",(function(){return T}));var n=c("DtFj"),a=c.n(n),s=c("FAat"),i=c.n(s),r=c("wXtC"),l=c.n(r),o=c("rmht"),d=c.n(o),u=c("iJl9"),j=c.n(u),h=c("4IMT"),m=c.n(h),b=c("nKUr"),f=c("cpVT"),x=c("20a2"),p=c("q1tI"),O=c("YFqc"),g=c.n(O),v=c("l+S1"),k=c("ZV7/"),_=c("wd/R"),w=c.n(_),y=c("g6Xq"),N=c.n(y);function S(e,t){var c=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),c.push.apply(c,n)}return c}function C(e){for(var t=1;t<arguments.length;t++){var c=null!=arguments[t]?arguments[t]:{};t%2?S(Object(c),!0).forEach((function(t){Object(f.a)(e,t,c[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(c)):S(Object(c)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(c,t))}))}return e}var T=!0;t.default=function(e){var t=e.dataProfile,c=e.sidemenu,n=e.initProps,s=Object(x.useRouter)(),r=s.pathname.split("/").slice(1),o="",u="",h="",f="",O="",_=s.query,y=_.ticket_id,S=_.location_id,T=_.from,P=_.to,E=_.status_id;y&&(o=y),S&&(u=S),E&&(O=E),T&&(h=T),P&&(f=P);var M=Object(p.useState)([]),z=M[0],R=M[1],A=Object(p.useState)({status_ticket:[{id:0,name:""}],incident_type:[],requesters:[{user_id:0,fullname:"",company_id:0}],requester_companies:[],companies:{data:[{id:0,title:"",key:"",value:0}]}}),I=A[0],q=A[1],V=Object(p.useState)([]),D=(V[0],V[1]),F=Object(p.useState)([]),H=(F[0],F[1]),Y=Object(p.useState)({total_tickets:0,open_tickets_count:0,on_progress_tickets_count:0,on_hold_tickets_count:0,canceled_tickets_count:0,closed_tickets_count:0,tickets:{}}),J=Y[0],L=Y[1],B=Object(p.useState)({current_page:0,data:[],first_page_url:"",from:0,last_page:0,last_page_url:"",next_page_url:null,path:"",per_page:"",prev_page_url:"",to:0,total:0}),G=B[0],U=B[1],X=Object(p.useState)(""!==o),K=X[0],Z=X[1],Q=Object(p.useState)(null),W=Q[0],$=Q[1],ee=Object(p.useState)(""!==u),te=ee[0],ce=ee[1],ne=Object(p.useState)(null),ae=ne[0],se=ne[1],ie=Object(p.useState)(!1),re=(ie[0],ie[1]),le=Object(p.useState)([]),oe=(le[0],le[1]),de=Object(p.useState)(""!==h),ue=de[0],je=de[1],he=Object(p.useState)(null),me=he[0],be=he[1],fe=Object(p.useState)(""!==f),xe=fe[0],pe=fe[1],Oe=Object(p.useState)(null),ge=Oe[0],ve=Oe[1],ke=Object(p.useState)(""!==O),_e=ke[0],we=ke[1],ye=Object(p.useState)(null),Ne=ye[0],Se=ye[1],Ce=Object(p.useState)(u),Te=Ce[0],Pe=(Ce[1],Object(p.useState)(null)),Ee=Pe[0],Me=Pe[1],ze=Object(p.useState)(0),Re=ze[0],Ae=ze[1],Ie=Object(p.useState)(!0),qe=Ie[0],Ve=Ie[1],De=Object(p.useState)(!1),Fe=De[0],He=De[1],Ye=[{title:"No Ticket",dataIndex:"num",render:function(e,t,c){return{children:Object(b.jsx)(b.Fragment,{children:Object(b.jsx)("strong",{children:t.full_name})})}}},{title:"Raised By",dataIndex:"raised_by",render:function(e,t,c){return{children:Object(b.jsx)(b.Fragment,{children:t.task.creator.name})}}},{title:"Lokasi Problem",dataIndex:"location_problem",align:"center",render:function(e,t,c){return{children:Object(b.jsx)(b.Fragment,{children:0===t.task.location.id?"-":t.task.location.full_location})}}},{title:"Date Raised",dataIndex:"date_raised",render:function(e,t,c){return{children:Object(b.jsx)(b.Fragment,{children:t.raised_at})}}}],Je=function(e){"undefined"===typeof e?(window.location.href="/tickets?ticket_id=".concat(K?o:"","&location_id=&status_id=").concat(_e?O:"","&from=").concat(ue?h:"","&to=").concat(xe?f:""),ce(!1)):(ce(!0),se(e))},Le=function(e){"undefined"===typeof e?(window.location.href="/tickets?ticket_id=".concat(K?o:"","&location_id=").concat(te?u:"","&status_id=").concat(_e?O:"","&from=&to="),re(!1),je(!1),pe(!1)):(re(!0),je(!0),pe(!0),oe(e),be(w()(e[0]).locale("id").format("YYYY-MM-DD")),ve(w()(e[1]).locale("id").format("YYYY-MM-DD")))},Be=function(e){"undefined"===typeof e?(window.location.href="/tickets?ticket_id=".concat(K?o:"","&location_id=").concat(te?u:"","&status_id=&from=").concat(ue?h:"","&to=").concat(xe?f:""),we(!1)):(we(!0),Se(e))};return Object(p.useEffect)((function(){fetch("https://boiling-thicket-46501.herokuapp.com/".concat(1===t.data.role?"getTickets":"getClientTickets","?ticket_id=").concat(o,"&location_id=").concat(u,"&status_id=").concat(O,"&from=").concat(h,"&to=").concat(f),{method:"GET",headers:{Authorization:JSON.parse(n)}}).then((function(e){return e.json()})).then((function(e){L(e.data),U(e.data),R(e.data.data),D(e.data.data),H(e.data.data)}))}),[]),Object(p.useEffect)((function(){fetch("https://boiling-thicket-46501.herokuapp.com/".concat(1===t.data.role?"getTicketRelation":"getClientTicketRelation"),{method:"GET",headers:{Authorization:JSON.parse(n)}}).then((function(e){return e.json()})).then((function(e){var c=[];if(1!==t.data.role){for(var n in e.data.status_ticket)c.push(e.data.status_ticket[n]);q(C(C({},e.data),{},{status_ticket:c}))}else q(e.data);Me(Te),Ve(!1)}))}),[]),Object(b.jsxs)(k.a,{dataProfile:t,sidemenu:c,tok:n,st:N.a,pathArr:r,children:[Object(b.jsxs)("div",{className:" w-full grid grid-cols-1 md:grid-cols-4 border-gray-400 md:border-t md:border-b bg-white mb-5 px-4 py-5",children:[Object(b.jsxs)("div",{className:" col-span-1 md:col-span-3 flex items-center mb-2 md:mb-0",children:[Object(b.jsx)("div",{className:"font-bold text-2xl w-auto mr-14",children:"Tickets"}),Object(b.jsxs)("div",{className:"flex flex-col mr-10",children:[Object(b.jsxs)("div",{className:"flex items-center mb-2",children:[Object(b.jsx)("div",{className:"w-2 h-2 rounded-full bg-blue-500 mr-1"}),Object(b.jsx)("p",{className:"mb-0",children:"Open"})]}),Object(b.jsx)("div",{className:" text-lg text-center",children:J.open_tickets_count})]}),1===t.data.role&&Object(b.jsxs)("div",{className:"flex flex-col mr-10",children:[Object(b.jsxs)("div",{className:"flex items-center mb-2",children:[Object(b.jsx)("div",{className:"w-2 h-2 rounded-full bg-green-500 mr-1"}),Object(b.jsx)("p",{className:"mb-0",children:"On Progress"})]}),Object(b.jsx)("div",{className:" text-lg text-center",children:J.on_progress_tickets_count})]}),1===t.data.role&&Object(b.jsxs)("div",{className:"flex flex-col mr-10",children:[Object(b.jsxs)("div",{className:"flex items-center mb-2",children:[Object(b.jsx)("div",{className:"w-2 h-2 rounded-full bg-yellow-500 mr-1"}),Object(b.jsx)("p",{className:"mb-0",children:"On Hold"})]}),Object(b.jsx)("div",{className:" text-lg text-center",children:J.on_hold_tickets_count})]}),Object(b.jsxs)("div",{className:"flex flex-col mr-10",children:[Object(b.jsxs)("div",{className:"flex items-center mb-2",children:[Object(b.jsx)("div",{className:"w-2 h-2 rounded-full bg-red-500 mr-1"}),Object(b.jsx)("p",{className:"mb-0",children:"Cancel"})]}),Object(b.jsx)("div",{className:" text-lg text-center",children:J.canceled_tickets_count})]}),Object(b.jsxs)("div",{className:"flex flex-col mr-12",children:[Object(b.jsxs)("div",{className:"flex items-center mb-2",children:[Object(b.jsx)("div",{className:"w-2 h-2 rounded-full bg-gray-500 mr-1"}),Object(b.jsx)("p",{className:"mb-0",children:"Closed"})]}),Object(b.jsx)("div",{className:" text-lg text-center",children:J.closed_tickets_count})]}),Object(b.jsxs)("div",{className:"flex flex-col",children:[Object(b.jsx)("div",{className:"flex items-center mb-2",children:Object(b.jsx)("p",{className:"mb-0 font-bold text-lg",children:"Total Tiket"})}),Object(b.jsx)("div",{className:" font-bold text-xl text-center",children:J.total_tickets})]})]}),Object(b.jsxs)("div",{className:" col-span-1 md:col-span-1 flex md:justify-end items-center",children:[1===t.data.role?Object(b.jsx)(g.a,{href:"/tickets/histories",children:Object(b.jsx)(m.a,{size:"large",type:"primary",style:{marginRight:"1rem"},onClick:function(){s.push("/tickets/histories")},children:"History"})}):Object(b.jsx)(b.Fragment,{children:t.data.features.includes(108)&&Object(b.jsx)(g.a,{href:"/tickets/histories",children:Object(b.jsx)(m.a,{size:"large",type:"primary",style:{marginRight:"1rem"},onClick:function(){s.push("/tickets/histories")},children:"History"})})}),1===t.data.role&&Object(b.jsx)(g.a,{href:"/tickets/exporting?closed=0",children:Object(b.jsx)(m.a,{style:{backgroundColor:"gray",borderColor:"gray",marginRight:"1rem"},size:"large",type:"primary",children:"Export"})}),Object(b.jsx)(g.a,{href:"/tickets/create",children:Object(b.jsx)(m.a,{size:"large",type:"primary",children:"Buat Tiket"})})]})]}),Object(b.jsx)("div",{className:"h-auto w-full grid grid-cols-1 md:grid-cols-5 mb-5 bg-white rounded-md",children:Object(b.jsxs)("div",{className:"md:col-span-5 col-span-1 flex flex-col py-3",children:[qe?null:Object(b.jsx)("div",{className:"flex mb-8",children:Object(b.jsxs)("div",{className:" w-full mr-1 grid grid-cols-12",children:[Object(b.jsxs)("div",{className:"col-span-3 mr-1 flex flex-col",children:[Object(b.jsx)(j.a,{defaultValue:o,style:{width:"100%",marginRight:"0.5rem"},placeholder:"Cari Ticket Number",onChange:function(e){""===e.target.value?(window.location.href="/tickets?ticket_id=&location_id=".concat(te?u:"","&status_id=").concat(_e?O:"","&from=").concat(ue?h:"","&to=").concat(xe?f:""),Z(!1)):/(^\d*$)/.test(e.target.value)?(He(!1),Z(!0),$(e.target.value)):He(!0)},allowClear:!0}),Fe&&Object(b.jsx)("p",{className:"mb-0 text-xs text-red-400",children:"Ticket number harus angka"})]}),Object(b.jsx)("div",{className:"col-span-3 mr-1",children:Object(b.jsx)(d.a,{defaultValue:""===Te?null:Number(Ee),placeholder:"Lokasi Problem",style:{width:"100%"},allowClear:!0,onChange:function(e,t,c){"undefined"===typeof e?Je():Je(e)},treeData:1===t.data.role?[I.companies]:[I.companies.data],treeDefaultExpandAll:!0})}),Object(b.jsx)("div",{className:"col-span-3 mr-1",children:Object(b.jsx)(l.a.RangePicker,{defaultValue:""===h&&""===f?null:[w()(h),w()(f)],style:{width:"100%"},placeholder:["Tanggal Awal","Tanggal Akhir"],onChange:function(e,t){""===t[0]&&""===t[1]?Le():Le(t)}})}),Object(b.jsx)("div",{className:"col-span-2 mr-1",children:Object(b.jsx)(i.a,{defaultValue:""===O?null:Number(O),placeholder:"Status",style:{width:"100%"},allowClear:!0,onChange:function(e){"undefined"===typeof e?Be():Be(e)},children:I.status_ticket.map((function(e,t){return Object(b.jsx)(i.a.Option,{value:e.id,children:e.name})}))})}),Object(b.jsx)("div",{className:" col-span-1",children:Object(b.jsx)(m.a,{type:"primary",style:{width:"100%"},onClick:function(){!1===Fe&&(window.location.href="/tickets?ticket_id=".concat(K?null===W?o:W:"","&location_id=").concat(te?null===ae?u:ae:"","&status=").concat(_e?null===Ne?O:Ne:"","&from=").concat(ue?null===me?h:me:"","&to=").concat(xe?null===ge?f:ge:""))},children:Object(b.jsx)(v.a,{})})})]})}),Object(b.jsx)("div",{className:"px-6",children:Object(b.jsx)(a.a,{pagination:{pageSize:10,total:G.total,onChange:function(e,c){Ve(!0),fetch("https://boiling-thicket-46501.herokuapp.com/".concat(1===t.data.role?"getTickets":"getClientTickets","?page=").concat(e,"&rows=10&ticket_id=").concat(o,"&location_id=").concat(u,"&status_id=").concat(O,"&from=").concat(h,"&to=").concat(f),{method:"GET",headers:{Authorization:JSON.parse(n)}}).then((function(e){return e.json()})).then((function(e){U(e.data.tickets),R(e.data.tickets.data),D(e.data.tickets.data),H(e.data.tickets.data),Ve(!1)}))}},scroll:{x:200},dataSource:z,columns:Ye,loading:qe,onRow:function(e,c){return{onMouseOver:function(t){Ae(e.id)},onClick:function(c){(1===t.data.role||t.data.features.includes(109))&&s.push("/tickets/detail/".concat(e.id))}}},rowClassName:function(e,t){return e.id===Re?"cursor-pointer":""}})})]})})]})}},Tqig:function(e,t,c){(window.__NEXT_P=window.__NEXT_P||[]).push(["/tickets3",function(){return c("/Fn9")}])},UMre:function(e,t,c){"use strict";var n=c("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.isStyleSupport=function(e,t){if(!Array.isArray(e)&&void 0!==t)return function(e,t){if(!s(e))return!1;var c=document.createElement("div"),n=c.style[e];return c.style[e]=t,c.style[e]!==n}(e,t);return s(e)};var a=n(c("3Mug")),s=function(e){if((0,a.default)()&&window.document.documentElement){var t=Array.isArray(e)?e:[e],c=window.document.documentElement;return t.some((function(e){return e in c.style}))}return!1}},"ZV7/":function(e,t,c){"use strict";var n=c("MM9K"),a=c.n(n),s=c("Y/VR"),i=c.n(s),r=c("nKUr"),l=c("d2CI"),o=c.n(l),d=c("q1tI"),u=c("20a2"),j=c("YFqc"),h=c.n(j),m=c("p46w"),b=c.n(m),f=c("2MCQ"),x=c.n(f),p=c("MjGk"),O=c.n(p),g=c("Gv1R"),v=c("cPPd");t.a=function(e){var t=e.children,c=e.tok,n=e.dataProfile,s=e.pathArr,l=e.sidemenu,j=e.st,m=Object(u.useRouter)(),f=[];if(s)for(var p=0;p<s.length;p++)f.push(s[p]);var k=f.map((function(e,t){return e[0].toUpperCase()+e.slice(1)})),_=(o.a.Sider,o.a.Content,o.a.Header),w=Object(d.useState)(!0),y=w[0],N=w[1],S=Object(d.useState)(!0),C=S[0],T=S[1],P=Object(d.useState)(90),E=(P[0],P[1]),M=Object(d.useState)(!1),z=M[0],R=M[1],A=function(){N((function(e){return!e}))},I=function(){T((function(e){return!e}))};Object(d.useEffect)((function(){var e=window.innerHeight;E(e)}),[]);var q="";return Object(r.jsx)(a.a,{spinning:z,children:Object(r.jsxs)("div",{className:" min-h-screen flex",children:[Object(r.jsx)(g.a,{dataProfile:n,handleCollSmall:I,sidemenu:l,coll:y,collsmall:C,st:j}),Object(r.jsxs)("div",{className:"h-auto w-full",children:[Object(r.jsxs)(_,{className:"site-layout-background",style:{padding:0,backgroundColor:"white",display:"flex",alignItems:"center",flexDirection:"row",flexWrap:"wrap",width:"100%",justifyContent:"space-between",height:"auto"},children:[Object(r.jsxs)("div",{className:"flex z-50",children:[y?Object(r.jsx)(x.a,{onClick:A,style:{padding:"24px",float:"left",marginTop:"0.3rem"},className:j.trigger}):Object(r.jsx)(O.a,{onClick:A,style:{padding:"24px",float:"left"},className:j.trigger}),C?Object(r.jsx)(x.a,{onClick:I,style:{padding:"24px",float:"left",marginTop:"0.3rem"},className:j.triggerSmall}):Object(r.jsx)(O.a,{onClick:I,style:{padding:"24px",float:"left"},className:j.triggerSmall}),s?Object(r.jsx)(i.a,{separator:">",style:{float:"left",padding:"24px 10px",backgroundColor:"white"},className:j.breadcrumbClients,children:0!==k.length?k.map((function(e,t){return q+="/".concat(s[t]),0===t?"incidents"===s[t]?Object(r.jsxs)(i.a.Item,{children:[" ",Object(r.jsx)("strong",{children:e})," "]},t):Object(r.jsxs)(i.a.Item,{href:"/".concat(s[t]),children:[" ",Object(r.jsx)("strong",{children:e})," "]},t):t===k.length-1&&t>0?Object(r.jsxs)(i.a.Item,{children:[" ",Object(r.jsx)("strong",{children:e})," "]},t):Object(r.jsx)(i.a.Item,{href:q,children:Object(r.jsx)("strong",{children:e})},t)})):null}):null]}),Object(r.jsx)("label",{htmlFor:"menutoggle",className:"pointer-cursor md:hidden block cursor-pointer mr-4",children:Object(r.jsxs)("svg",{className:"fill-current text-gray-900",xmlns:"http://www.w3.org/2000/svg",width:20,height:20,viewBox:"0 0 20 20",children:[Object(r.jsx)("title",{children:"menu"}),Object(r.jsx)("path",{d:"M0 3h20v2H0V3zm0 6h20v2H0V9zm0 6h20v2H0v-2z"})]})}),Object(r.jsx)("input",{className:"hidden ".concat(j.menuToggle),type:"checkbox",id:"menutoggle"}),Object(r.jsx)(v.a,{dataProfile:n,Linkheader:h.a,handleLogout:function(){R(!0),fetch("https://boiling-thicket-46501.herokuapp.com/logout",{method:"POST",headers:{"Content-Type":"application/json",Authorization:JSON.parse(c)}}).then((function(e){return e.json()})).then((function(e){R(!1),e.success&&(b.a.remove("token"),console.log("token abis logout: "+b.a.get("token")),m.push("/login"))})).catch((function(e){R(!1),console.log(e.message)}))},st:j}),s?Object(r.jsx)(i.a,{separator:">",style:{float:"left",padding:"24px 24px",fontSize:"0.825rem",width:"100%"},className:j.breadcrumbClientsSmall,children:0!==k.length?k.map((function(e,t){return q+="/".concat(s[t]),0===t?Object(r.jsxs)(i.a.Item,{href:"/".concat(s[t]),children:[" ",Object(r.jsx)("strong",{children:e})," "]},t):t===k.length-1&&t>0?Object(r.jsxs)(i.a.Item,{children:[" ",Object(r.jsx)("strong",{children:e})," "]},t):Object(r.jsx)(i.a.Item,{href:q,children:Object(r.jsx)("strong",{children:e})},t)})):null}):null]}),Object(r.jsx)("main",{className:"slb bg-white",style:{padding:24,height:"auto"},children:t})]})]})})}},cpVT:function(e,t,c){"use strict";function n(e,t,c){return t in e?Object.defineProperty(e,t,{value:c,enumerable:!0,configurable:!0,writable:!0}):e[t]=c,e}c.d(t,"a",(function(){return n}))},hf16:function(e,t,c){"use strict";var n=c("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.responsiveMap=t.responsiveArray=t.default=void 0;var a=n(c("lSNA")),s=n(c("pVnL"));t.responsiveArray=["xxl","xl","lg","md","sm","xs"];var i={xs:"(max-width: 575px)",sm:"(min-width: 576px)",md:"(min-width: 768px)",lg:"(min-width: 992px)",xl:"(min-width: 1200px)",xxl:"(min-width: 1600px)"};t.responsiveMap=i;var r=new Map,l=-1,o={},d={matchHandlers:{},dispatch:function(e){return o=e,r.forEach((function(e){return e(o)})),r.size>=1},subscribe:function(e){return r.size||this.register(),l+=1,r.set(l,e),e(o),l},unsubscribe:function(e){r.delete(e),r.size||this.unregister()},unregister:function(){var e=this;Object.keys(i).forEach((function(t){var c=i[t],n=e.matchHandlers[c];null===n||void 0===n||n.mql.removeListener(null===n||void 0===n?void 0:n.listener)})),r.clear()},register:function(){var e=this;Object.keys(i).forEach((function(t){var c=i[t],n=function(c){var n=c.matches;e.dispatch((0,s.default)((0,s.default)({},o),(0,a.default)({},t,n)))},r=window.matchMedia(c);r.addListener(n),e.matchHandlers[c]={mql:r,listener:n},n(r)}))}};t.default=d},"l+S1":function(e,t,c){"use strict";var n=c("VTBJ"),a=c("q1tI"),s={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M909.6 854.5L649.9 594.8C690.2 542.7 712 479 712 412c0-80.2-31.3-155.4-87.9-212.1-56.6-56.7-132-87.9-212.1-87.9s-155.5 31.3-212.1 87.9C143.2 256.5 112 331.8 112 412c0 80.1 31.3 155.5 87.9 212.1C256.5 680.8 331.8 712 412 712c67 0 130.6-21.8 182.7-62l259.7 259.6a8.2 8.2 0 0011.6 0l43.6-43.5a8.2 8.2 0 000-11.6zM570.4 570.4C528 612.7 471.8 636 412 636s-116-23.3-158.4-65.6C211.3 528 188 471.8 188 412s23.3-116.1 65.6-158.4C296 211.3 352.2 188 412 188s116.1 23.2 158.4 65.6S636 352.2 636 412s-23.3 116.1-65.6 158.4z"}}]},name:"search",theme:"outlined"},i=c("6VBw"),r=function(e,t){return a.createElement(i.a,Object(n.a)(Object(n.a)({},e),{},{ref:t,icon:s}))};r.displayName="SearchOutlined";t.a=a.forwardRef(r)}},[["Tqig",0,2,18,1,3,4,5,6,7,8,11,13,17,16,19,20]]]);