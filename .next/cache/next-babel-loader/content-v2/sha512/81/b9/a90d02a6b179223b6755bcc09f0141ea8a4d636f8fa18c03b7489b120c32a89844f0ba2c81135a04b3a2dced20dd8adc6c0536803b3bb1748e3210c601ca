{"ast":null,"code":"import _Modal from \"antd/lib/modal\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport _Empty from \"antd/lib/empty\";\nimport _Spin from \"antd/lib/spin\";\nimport _Input from \"antd/lib/input\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport _Button from \"antd/lib/button\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport _notification from \"antd/lib/notification\";\nimport _JSXStyle from \"styled-jsx/style\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport { useRouter } from 'next/router';\nimport { useEffect, useState } from 'react';\nimport httpcookie from 'cookie';\nimport Link from 'next/link';\nimport { SearchOutlined, DeleteOutlined, EditOutlined } from '@ant-design/icons';\nimport Layout from '../../../components/layout-dashboard';\nimport st from '../../../components/layout-dashboard.module.css';\n\nconst ManufacturersIndex = ({\n  dataProfile,\n  sidemenu,\n  initProps\n}) => {\n  // 1.Init\n  const rt = useRouter();\n  const pathArr = rt.pathname.split(\"/\").slice(1); //2.useState\n\n  const {\n    0: displaydata,\n    1: setdisplaydata\n  } = useState([]);\n  const {\n    0: displaydata2,\n    1: setdisplaydata2\n  } = useState([]);\n  const {\n    0: displaydata3,\n    1: setdisplaydata3\n  } = useState([]);\n  const {\n    0: displaytrigger,\n    1: setdisplaytrigger\n  } = useState(0);\n  const {\n    0: praloading,\n    1: setpraloading\n  } = useState(true);\n  const {\n    0: namasearchact,\n    1: setnamasearchact\n  } = useState(false);\n  const {\n    0: namavalue,\n    1: setnamavalue\n  } = useState(\"\");\n  const {\n    0: hover,\n    1: sethover\n  } = useState(\"\");\n  const {\n    0: hovercolor,\n    1: sethovercolor\n  } = useState(\"\"); //Tambah\n\n  const {\n    0: dataadd,\n    1: setdataadd\n  } = useState({\n    name: \"\"\n  });\n  const {\n    0: modaladd,\n    1: setmodaladd\n  } = useState(false);\n  const {\n    0: loadingadd,\n    1: setloadingadd\n  } = useState(false);\n  const {\n    0: disabledadd,\n    1: setdisabledadd\n  } = useState(true); //Ubah\n\n  const {\n    0: dataupdate,\n    1: setdataupdate\n  } = useState({\n    id: \"\",\n    name: \"\"\n  });\n  const {\n    0: modalupdate,\n    1: setmodalupdate\n  } = useState(false);\n  const {\n    0: loadingupdate,\n    1: setloadingupdate\n  } = useState(false);\n  const {\n    0: disabledupdate,\n    1: setdisabledupdate\n  } = useState(true); //Hapus\n\n  const {\n    0: datadelete,\n    1: setdatadelete\n  } = useState({\n    id: \"\"\n  });\n  const {\n    0: modaldelete,\n    1: setmodaldelete\n  } = useState(false);\n  const {\n    0: loadingdelete,\n    1: setloadingdelete\n  } = useState(false); //3.onChange\n  //search nama\n\n  const onChangeSearch = e => {\n    if (e.target.value === \"\") {\n      setdisplaydata(displaydata3);\n      setnamasearchact(false);\n    } else {\n      setnamasearchact(true);\n      setnamavalue(e.target.value);\n    }\n  };\n\n  const onFinalClick = () => {\n    var datatemp = displaydata2;\n\n    if (namasearchact) {\n      datatemp = datatemp.filter(flt => {\n        return flt.name.toLowerCase().includes(namavalue.toLowerCase());\n      });\n    }\n\n    setdisplaydata(datatemp);\n  }; //4.handler\n\n\n  const handleAddManufacturer = () => {\n    setloadingadd(true);\n    fetch(`https://boiling-thicket-46501.herokuapp.com/addManufacturer`, {\n      method: 'POST',\n      headers: {\n        'Authorization': JSON.parse(initProps),\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify(dataadd)\n    }).then(res => res.json()).then(res2 => {\n      setloadingadd(false);\n      setmodaladd(false);\n\n      if (res2.success) {\n        _notification['success']({\n          message: \"Manufacturer berhasil ditambahkan\",\n          duration: 2\n        });\n\n        setdataadd(_objectSpread(_objectSpread({}, dataadd), {}, {\n          name: \"\"\n        }));\n        setdisplaytrigger(prev => prev + 1);\n      } else if (!res2.success) {\n        _notification['error']({\n          message: res2.message,\n          duration: 3\n        });\n      }\n    });\n  };\n\n  const handleUpdateManufacturer = () => {\n    setloadingupdate(true);\n    fetch(`https://boiling-thicket-46501.herokuapp.com/updateManufacturer`, {\n      method: 'PUT',\n      headers: {\n        'Authorization': JSON.parse(initProps),\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify(dataupdate)\n    }).then(res => res.json()).then(res2 => {\n      setloadingupdate(false);\n      setmodalupdate(false);\n\n      if (res2.success) {\n        _notification['success']({\n          message: \"Manufacturer berhasil diubah\",\n          duration: 2\n        });\n\n        setdataupdate(_objectSpread(_objectSpread({}, dataupdate), {}, {\n          name: \"\"\n        }));\n        setdisplaytrigger(prev => prev + 1);\n      } else if (!res2.success) {\n        _notification['error']({\n          message: res2.message,\n          duration: 3\n        });\n      }\n    });\n  };\n\n  const handleDeleteManufacturer = () => {\n    setloadingdelete(true);\n    fetch(`https://boiling-thicket-46501.herokuapp.com/deleteManufacturer`, {\n      method: 'DELETE',\n      headers: {\n        'Authorization': JSON.parse(initProps),\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify(datadelete)\n    }).then(res => res.json()).then(res2 => {\n      setloadingdelete(false);\n      setmodaldelete(false);\n\n      if (res2.success) {\n        _notification['success']({\n          message: \"Manufacturer berhasil dihapus\",\n          duration: 2\n        });\n\n        setdisplaytrigger(prev => prev + 1);\n      } else if (!res2.success) {\n        _notification['error']({\n          message: res2.message,\n          duration: 3\n        });\n      }\n    });\n  }; //5.useEffect\n\n\n  useEffect(() => {\n    setpraloading(true);\n    fetch(`https://boiling-thicket-46501.herokuapp.com/getManufacturers`, {\n      method: `GET`,\n      headers: {\n        'Authorization': JSON.parse(initProps)\n      }\n    }).then(res => res.json()).then(res2 => {\n      setdisplaydata(res2.data);\n      setdisplaydata2(res2.data);\n      setdisplaydata3(res2.data);\n      setpraloading(false);\n    });\n  }, [displaytrigger]);\n  return /*#__PURE__*/_jsxs(Layout, {\n    dataProfile: dataProfile,\n    sidemenu: sidemenu,\n    tok: initProps,\n    st: st,\n    pathArr: pathArr,\n    children: [/*#__PURE__*/_jsxs(\"div\", {\n      className: \"w-full grid grid-cols-1 md:grid-cols-3 border-t border-b bg-white mb-5 p-4\",\n      children: [/*#__PURE__*/_jsx(\"div\", {\n        className: \" col-span-1 md:col-span-2 flex items-center mb-2 md:mb-0\",\n        children: /*#__PURE__*/_jsx(\"div\", {\n          className: \"font-semibold text-base w-auto\",\n          children: \"Manufacturer\"\n        })\n      }), /*#__PURE__*/_jsx(\"div\", {\n        className: \" col-span-1 md:col-span-1 flex md:justify-end items-center\",\n        children: /*#__PURE__*/_jsx(_Button, {\n          onClick: () => {\n            setmodaladd(true);\n          },\n          size: \"large\",\n          type: \"primary\",\n          children: \"Tambah\"\n        })\n      })]\n    }), /*#__PURE__*/_jsx(\"div\", {\n      className: \"h-auto w-full grid grid-cols-1 md:grid-cols-5 mb-5 bg-white rounded-md\",\n      children: /*#__PURE__*/_jsxs(\"div\", {\n        className: \"md:col-span-5 col-span-1 flex flex-col py-3 px-10\",\n        children: [/*#__PURE__*/_jsx(\"div\", {\n          className: \"flex mb-8\",\n          children: /*#__PURE__*/_jsxs(\"div\", {\n            className: \" w-full mr-1 grid grid-cols-12\",\n            children: [/*#__PURE__*/_jsx(\"div\", {\n              className: \"col-span-11 mr-1\",\n              children: /*#__PURE__*/_jsx(_Input, {\n                style: {\n                  width: `100%`,\n                  marginRight: `0.5rem`\n                },\n                placeholder: \"Cari Nama Manufacturer\",\n                onChange: onChangeSearch,\n                allowClear: true\n              })\n            }), /*#__PURE__*/_jsx(\"div\", {\n              className: \" col-span-1\",\n              children: /*#__PURE__*/_jsx(_Button, {\n                type: \"primary\",\n                style: {\n                  width: `100%`\n                },\n                onClick: onFinalClick,\n                children: /*#__PURE__*/_jsx(SearchOutlined, {})\n              })\n            })]\n          })\n        }), /*#__PURE__*/_jsxs(\"div\", {\n          className: \" flex flex-col rounded shadow border\",\n          children: [/*#__PURE__*/_jsx(\"div\", {\n            className: \"flex w-full p-4 font-semibold items-center text-base border-b bg-gray-100\",\n            children: \"Nama Manufacturer\"\n          }), praloading ? /*#__PURE__*/_jsx(\"div\", {\n            className: \"h-20 flex justify-center items-center\",\n            children: /*#__PURE__*/_jsx(_Spin, {})\n          }) : /*#__PURE__*/_jsx(_Fragment, {\n            children: displaydata.length > 0 ? displaydata.map((doc, idx) => {\n              return /*#__PURE__*/_jsxs(\"div\", {\n                className: `flex justify-between w-full p-4 items-center text-sm border-b ${idx === hover && hovercolor}`,\n                onMouseOver: () => {\n                  sethover(idx);\n                  sethovercolor(\"bg-gray-50\");\n                },\n                onMouseLeave: () => {\n                  sethover(\"\");\n                  sethovercolor(\"\");\n                },\n                children: [/*#__PURE__*/_jsx(\"p\", {\n                  className: \"mb-0\",\n                  children: doc.name\n                }), idx === hover && /*#__PURE__*/_jsxs(\"div\", {\n                  className: \"flex items-center pr-5\",\n                  children: [/*#__PURE__*/_jsx(EditOutlined, {\n                    onClick: () => {\n                      setdataupdate({\n                        id: doc.id,\n                        name: doc.name\n                      });\n                      setmodalupdate(true);\n                      setdisabledupdate(false);\n                    },\n                    style: {\n                      fontSize: `1.2rem`,\n                      color: `rgb(15,146,255)`,\n                      cursor: `pointer`,\n                      marginRight: `1rem`\n                    }\n                  }), /*#__PURE__*/_jsx(DeleteOutlined, {\n                    onClick: () => {\n                      setdatadelete({\n                        id: doc.id\n                      });\n                      setdataupdate({\n                        id: doc.id,\n                        name: doc.name\n                      });\n                      setmodaldelete(true);\n                    },\n                    style: {\n                      fontSize: `1.2rem`,\n                      color: `red`,\n                      cursor: `pointer`\n                    }\n                  })]\n                })]\n              });\n            }) : /*#__PURE__*/_jsx(\"div\", {\n              className: \"w-full\",\n              children: /*#__PURE__*/_jsx(_Empty, {\n                image: _Empty.PRESENTED_IMAGE_SIMPLE\n              })\n            })\n          })]\n        })]\n      })\n    }), /*#__PURE__*/_jsx(_Modal, {\n      title: /*#__PURE__*/_jsxs(\"div\", {\n        className: \"flex justify-between p-5 mt-5\",\n        children: [/*#__PURE__*/_jsx(\"h1\", {\n          className: \"font-bold text-xl\",\n          children: \"Form Tambah Manufacturer\"\n        }), /*#__PURE__*/_jsx(\"div\", {\n          className: \"flex\",\n          children: /*#__PURE__*/_jsxs(_Fragment, {\n            children: [/*#__PURE__*/_jsx(_Button, {\n              type: \"danger\",\n              onClick: () => {\n                setmodaladd(false);\n                setdataadd(_objectSpread(_objectSpread({}, dataadd), {}, {\n                  name: \"\"\n                }));\n              },\n              style: {\n                marginRight: `1rem`\n              },\n              children: \"Batal\"\n            }), /*#__PURE__*/_jsx(_Button, {\n              type: \"primary\",\n              disabled: disabledadd,\n              onClick: handleAddManufacturer,\n              loading: loadingadd,\n              children: \"Simpan\"\n            })]\n          })\n        })]\n      }),\n      visible: modaladd,\n      onCancel: () => {\n        setmodaladd(false);\n      },\n      footer: null,\n      width: 700,\n      children: /*#__PURE__*/_jsx(\"div\", {\n        className: \"flex flex-col mb-3\",\n        children: /*#__PURE__*/_jsxs(\"div\", {\n          className: \"jsx-842967156\" + \" \" + \"flex flex-col mb-3\",\n          children: [/*#__PURE__*/_jsxs(\"p\", {\n            className: \"jsx-842967156\" + \" \" + \"mb-0\",\n            children: [\"Nama Manufacturer \", /*#__PURE__*/_jsx(\"span\", {\n              className: \"jsx-842967156\" + \" \" + \"namamanu\"\n            })]\n          }), /*#__PURE__*/_jsx(_Input, {\n            value: dataadd.name,\n            placeholder: \"Masukkan Nama Manufacturer\",\n            onChange: e => {\n              e.target.value === \"\" ? setdisabledadd(true) : setdisabledadd(false);\n              setdataadd({\n                name: e.target.value\n              });\n            }\n          }), /*#__PURE__*/_jsx(_JSXStyle, {\n            id: \"842967156\",\n            children: [\".namamanu.jsx-842967156::before{content:'*';color:red;}\"]\n          })]\n        })\n      })\n    }), /*#__PURE__*/_jsx(_Modal, {\n      title: /*#__PURE__*/_jsxs(\"div\", {\n        className: \"flex justify-between p-5 mt-5\",\n        children: [/*#__PURE__*/_jsx(\"h1\", {\n          className: \"font-bold text-xl\",\n          children: \"Form Ubah Manufacturer\"\n        }), /*#__PURE__*/_jsx(\"div\", {\n          className: \"flex\",\n          children: /*#__PURE__*/_jsxs(_Fragment, {\n            children: [/*#__PURE__*/_jsx(_Button, {\n              type: \"danger\",\n              onClick: () => {\n                setmodalupdate(false);\n              },\n              style: {\n                marginRight: `1rem`\n              },\n              children: \"Batal\"\n            }), /*#__PURE__*/_jsx(_Button, {\n              type: \"primary\",\n              disabled: disabledupdate,\n              onClick: handleUpdateManufacturer,\n              loading: loadingupdate,\n              children: \"Simpan\"\n            })]\n          })\n        })]\n      }),\n      visible: modalupdate,\n      onCancel: () => {\n        setmodalupdate(false);\n      },\n      footer: null,\n      width: 700,\n      children: /*#__PURE__*/_jsx(\"div\", {\n        className: \"flex flex-col mb-3\",\n        children: /*#__PURE__*/_jsxs(\"div\", {\n          className: \"jsx-842967156\" + \" \" + \"flex flex-col mb-3\",\n          children: [/*#__PURE__*/_jsxs(\"p\", {\n            className: \"jsx-842967156\" + \" \" + \"mb-0\",\n            children: [\"Nama Manufacturer \", /*#__PURE__*/_jsx(\"span\", {\n              className: \"jsx-842967156\" + \" \" + \"namamanu\"\n            })]\n          }), /*#__PURE__*/_jsx(_Input, {\n            placeholder: \"Masukkan Nama Manufacturer\",\n            value: dataupdate.name,\n            defaultValue: dataupdate.name,\n            onChange: e => {\n              e.target.value === \"\" ? setdisabledupdate(true) : setdisabledupdate(false);\n              setdataupdate(_objectSpread(_objectSpread({}, dataupdate), {}, {\n                name: e.target.value\n              }));\n            }\n          }), /*#__PURE__*/_jsx(_JSXStyle, {\n            id: \"842967156\",\n            children: [\".namamanu.jsx-842967156::before{content:'*';color:red;}\"]\n          })]\n        })\n      })\n    }), /*#__PURE__*/_jsxs(_Modal, {\n      title: \"Konfirmasi Hapus Manufacturer\",\n      visible: modaldelete,\n      onCancel: () => {\n        setmodaldelete(false);\n      },\n      okText: \"Ya\",\n      cancelText: \"Tidak\",\n      onOk: handleDeleteManufacturer,\n      okButtonProps: {\n        loading: loadingdelete\n      },\n      children: [\"Apakah Anda yakin ingin menghapus Manufacturer \\\"\", /*#__PURE__*/_jsx(\"strong\", {\n        children: dataupdate.name\n      }), \"\\\"?\"]\n    })]\n  });\n};\n\nexport async function getServerSideProps({\n  req,\n  res\n}) {\n  var initProps = {};\n\n  if (!req.headers.cookie) {\n    return {\n      redirect: {\n        permanent: false,\n        destination: '/login'\n      }\n    };\n  }\n\n  const cookiesJSON1 = httpcookie.parse(req.headers.cookie);\n\n  if (!cookiesJSON1.token) {\n    return {\n      redirect: {\n        permanent: false,\n        destination: '/login'\n      }\n    };\n  }\n\n  initProps = cookiesJSON1.token;\n  const resourcesGP = await fetch(`https://boiling-thicket-46501.herokuapp.com/detailProfile`, {\n    method: `GET`,\n    headers: {\n      'Authorization': JSON.parse(initProps)\n    }\n  });\n  const resjsonGP = await resourcesGP.json();\n  const dataProfile = resjsonGP; // if (![107, 108, 109, 110, 111, 112, 132].every((curr) => dataProfile.data.registered_feature.includes(curr))) {\n  //     res.writeHead(302, { Location: '/dashboard/admin' })\n  //     res.end()\n  // }\n\n  return {\n    props: {\n      initProps,\n      dataProfile,\n      sidemenu: \"84\"\n    }\n  };\n}\nexport default ManufacturersIndex;","map":null,"metadata":{},"sourceType":"module"}