{"ast":null,"code":"import _Table from \"antd/lib/table\";\nimport _Button from \"antd/lib/button\";\nimport _notification from \"antd/lib/notification\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport _regeneratorRuntime from \"/tmp/mig/ims-fe/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _defineProperty from \"/tmp/mig/ims-fe/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _asyncToGenerator from \"/tmp/mig/ims-fe/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport LoadingOutlined from \"@ant-design/icons/LoadingOutlined\";\nimport PlusOutlined from \"@ant-design/icons/PlusOutlined\";\nimport Link from \"next/link\";\nimport { useRouter } from \"next/router\";\nimport { useEffect, useState } from \"react\";\nimport Layout from \"../../../components/layout-dashboard\";\nimport st from \"../../../components/layout-dashboard.module.css\";\n\nfunction modifData(dataa) {\n  for (var i = 0; i < dataa.length; i++) {\n    dataa[i][\"key\"] = dataa[i].id;\n    dataa[i][\"value\"] = dataa[i].id;\n    dataa[i][\"title\"] = dataa[i].name;\n    dataa[i][\"children\"] = dataa[i].members;\n    delete dataa[i].members;\n    if (dataa[i].children) [modifData(dataa[i].children)];\n  }\n\n  return dataa;\n}\n\nfunction ClientsIndex(_ref) {\n  var initProps = _ref.initProps,\n      dataProfile = _ref.dataProfile,\n      sidemenu = _ref.sidemenu;\n  var rt = useRouter();\n  var tok = initProps;\n  var pathArr = rt.pathname.split(\"/\").slice(1);\n  pathArr.splice(1, 1);\n\n  var _useState = useState(false),\n      drawablecreate = _useState[0],\n      setDrawablecreate = _useState[1];\n\n  var _useState2 = useState(false),\n      loadingupload = _useState2[0],\n      setLoadingupload = _useState2[1];\n\n  var _useState3 = useState(false),\n      loadingbtn = _useState3[0],\n      setloadingbtn = _useState3[1]; // const [instanceForm] = Form.useForm()\n  // const { Option } = Select\n\n\n  var _useState4 = useState({\n    name: \"\",\n    role: 2,\n    address: \"\",\n    phone_number: \"\",\n    image_logo: \"\",\n    parent_id: 0\n  }),\n      newclients = _useState4[0],\n      setnewclients = _useState4[1];\n\n  var _useState5 = useState([]),\n      datatable = _useState5[0],\n      setdatatable = _useState5[1];\n\n  var _useState6 = useState([]),\n      datatable2 = _useState6[0],\n      setdatatable2 = _useState6[1];\n\n  var _useState7 = useState(false),\n      loaddatatable = _useState7[0],\n      setloaddatatable = _useState7[1]; // var dataTable = []\n  // if (!dataCompanyList.data) {\n  //     dataTable = []\n  //     notification['error']({\n  //         message: dataCompanyList.message.errorInfo.status_detail,\n  //         duration: 3\n  //     })\n  //     rt.push('/admin/company')\n  // }\n  // else {\n  //     dataTable = dataCompanyList.data.filter(dataa => dataa.company_id != 66).map((doc, idx) => {\n  //         return ({\n  //             image_logo: doc.image_logo,\n  //             company_id: doc.company_id,\n  //             company_name: doc.company_name,\n  //             is_enabled: doc.is_enabled\n  //         })\n  //     })\n  // }\n\n\n  var columnsTable = [{\n    title: \"Logo\",\n    dataIndex: \"image_logo\",\n    render: function render(text, record, index) {\n      return {\n        // props: {\n        //     style: { backgroundColor: index % 2 == 1 ? '#f2f2f2' : '#fff' },\n        // },\n        children: /*#__PURE__*/_jsx(_Fragment, {\n          children: /*#__PURE__*/_jsx(Link, {\n            href: \"/company/clients/\".concat(record.id),\n            children: /*#__PURE__*/_jsx(\"a\", {\n              children: /*#__PURE__*/_jsx(\"img\", {\n                src: record.image_logo === \"-\" || record.image_logo === \"\" ? \"/image/Induk.png\" : record.image_logo,\n                alt: \"imageProfile\",\n                className: \" object-cover w-10 h-10 rounded-full\"\n              })\n            })\n          })\n        })\n      };\n    }\n  }, // {\n  //     title: 'ID',\n  //     dataIndex: 'company_id',\n  //     render: (text, record, index) => {\n  //         return {\n  //             props: {\n  //                 style: { backgroundColor: index % 2 == 1 ? '#f2f2f2' : '#fff' },\n  //             },\n  //             children:\n  //                 <>\n  //                     <Link href={`/admin/company/${record.company_id}`}>\n  //                         <a><h1>{record.company_id}</h1></a>\n  //                     </Link>\n  //                 </>\n  //         }\n  //     },\n  //     // sorter: (a, b) => a.company_id - b.company_id,\n  //     // sortDirections: ['descend', 'ascend'],\n  // },\n  {\n    title: \"Nama Perusahaan\",\n    dataIndex: \"name\",\n    render: function render(text, record, index) {\n      return {\n        // props: {\n        //     style: { backgroundColor: index % 2 == 1 ? '#f2f2f2' : '#fff' },\n        // },\n        children: /*#__PURE__*/_jsx(_Fragment, {\n          children: /*#__PURE__*/_jsx(Link, {\n            href: \"/company/clients/\".concat(record.id),\n            children: /*#__PURE__*/_jsx(\"a\", {\n              children: /*#__PURE__*/_jsx(\"h1\", {\n                children: record.name\n              })\n            })\n          })\n        })\n      };\n    } // sorter: (a, b) => a.company_name.localeCompare(b.company_name),\n    // sortDirections: ['descend', 'ascend'],\n\n  }, {\n    title: \"Status\",\n    dataIndex: \"is_enabled\",\n    align: \"center\",\n    render: function render(text, record, index) {\n      return {\n        // props: {\n        //     style: { backgroundColor: index % 2 == 1 ? '#f2f2f2' : '#fff' },\n        // },\n        children: /*#__PURE__*/_jsx(\"div\", {\n          className: \"flex justify-center\",\n          children: /*#__PURE__*/_jsx(Link, {\n            href: \"/company/clients/\".concat(record.id),\n            children: record.is_enabled ? /*#__PURE__*/_jsx(\"a\", {\n              children: /*#__PURE__*/_jsx(\"div\", {\n                className: \" bg-blue-100 text-blue-600 border-blue-600 border py-1 px-3 rounded-md text-center w-40\",\n                children: \"AKTIF MODULE\"\n              })\n            }) : /*#__PURE__*/_jsx(\"a\", {\n              children: /*#__PURE__*/_jsx(\"div\", {\n                className: \" bg-red-100 text-red-600 border-red-600 border py-1 px-3 rounded-md text-center w-52\",\n                children: \"NON-AKTIF MODULE\"\n              })\n            })\n          })\n        })\n      };\n    } // filters: [\n    //     {\n    //         text: 'Aktif',\n    //         value: true,\n    //     },\n    //     {\n    //         text: 'Non-aktif',\n    //         value: false,\n    //     },\n    // ],\n    // onFilter: (value, record) => record.is_enabled === value,\n\n  } // {\n  //     title: '\\xa0\\xa0\\xa0\\xa0\\xa0\\xa0\\xa0\\xa0\\xa0\\xa0\\xa0\\xa0\\xa0\\xa0\\xa0\\xa0\\xa0',\n  //     dataIndex: 'actionss',\n  //     align: `center`,\n  //     render: (text, record, index) => {\n  //         return {\n  //             props: {\n  //                 style: { backgroundColor: index % 2 == 1 ? '#f2f2f2' : '#fff' },\n  //             },\n  //             children:\n  //                 <>\n  //                     {/* {\n  //                         events[index] ?\n  //                             <> */}\n  //                     {\n  //                         [156, 158, 159, 160, 161, 162, 163].every((curr) => dataProfile.data.registered_feature.includes(curr)) &&\n  //                         <Button onClick={() => { rt.push(`/admin/company/${record.company_id}`) }} style={{ paddingTop: `0`, paddingBottom: `0.3rem`, marginRight: `1rem` }}>\n  //                             <EditOutlined />\n  //                         </Button>\n  //                     }\n  //                     {/* <Link href={`/admin/company/${record.company_id}`}> */}\n  //                     {/* {events[index]} */}\n  //                     {/* <Link href={`/company/${record.company_id}?originPath=Admin`}> */}\n  //                     {/* <a><EditOutlined /></a> */}\n  //                     {/* </Link> */}\n  //                     {/* </Link> */}\n  //                     {/* </>\n  //                             :\n  //                             null\n  //                     } */}\n  //                 </>\n  //         }\n  //     }\n  // }\n  ];\n\n  var closeClientsDrawer = function closeClientsDrawer() {\n    setnewclients({\n      name: \"\",\n      role: 0,\n      address: \"\",\n      phone_number: \"\",\n      image_logo: \"\",\n      parent_id: null\n    });\n  };\n\n  var beforeUploadProfileImage = function beforeUploadProfileImage(file) {\n    var isJpgOrPng = file.type === \"image/jpeg\" || file.type === \"image/png\" || file.type === \"image/jpg\";\n\n    if (!isJpgOrPng) {\n      message.error(\"You can only upload JPG/PNG file!\");\n    }\n\n    var isLt2M = file.size / 1024 / 1024 < 2;\n\n    if (!isLt2M) {\n      message.error(\"Image must smaller than 2MB!\");\n    }\n\n    return isJpgOrPng && isLt2M;\n  };\n\n  var onChangeProfileImage = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(info) {\n      var formData;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              if (!(info.file.status === \"uploading\")) {\n                _context.next = 3;\n                break;\n              }\n\n              setLoadingupload(true);\n              return _context.abrupt(\"return\");\n\n            case 3:\n              if (!(info.file.status === \"done\")) {\n                _context.next = 8;\n                break;\n              }\n\n              formData = new FormData();\n              formData.append(\"file\", info.file.originFileObj);\n              formData.append(\"upload_preset\", \"migsys\");\n              return _context.abrupt(\"return\", fetch(\"https://api.Cloudinary.com/v1_1/aqlpeduli/image/upload\", {\n                method: \"POST\",\n                body: formData\n              }).then(function (res) {\n                return res.json();\n              }).then(function (res2) {\n                setLoadingupload(false);\n                setnewclients(_objectSpread(_objectSpread({}, newclients), {}, {\n                  image_logo: res2.secure_url\n                }));\n              }));\n\n            case 8:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function onChangeProfileImage(_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var uploadButton = /*#__PURE__*/_jsxs(\"div\", {\n    children: [loadingupload ? /*#__PURE__*/_jsx(LoadingOutlined, {}) : /*#__PURE__*/_jsx(PlusOutlined, {}), /*#__PURE__*/_jsx(\"div\", {\n      style: {\n        marginTop: 8\n      },\n      children: \"Unggah\"\n    })]\n  });\n\n  var onChangeCreateClients = function onChangeCreateClients(e) {\n    var val = e.target.value;\n\n    if (e.target.name === \"role\") {\n      val = parseInt(e.target.value);\n    }\n\n    setnewclients(_objectSpread(_objectSpread({}, newclients), {}, _defineProperty({}, e.target.name, val)));\n  };\n\n  var onChangeParent = function onChangeParent(value) {\n    setnewclients(_objectSpread(_objectSpread({}, newclients), {}, {\n      parent_id: value\n    }));\n  };\n\n  var onChangeSearch = function onChangeSearch(e) {\n    var filtered = datatable2.filter(function (flt) {\n      return flt.name.toLowerCase().includes(e.target.value.toLowerCase());\n    });\n    setdatatable(filtered);\n  };\n\n  var handleSubmitCreateClients = function handleSubmitCreateClients() {\n    setnewclients(_objectSpread(_objectSpread({}, newclients), {}, {\n      role: 2\n    }));\n\n    if (newclients.address === \"\") {\n      setnewclients(_objectSpread(_objectSpread({}, newclients), {}, {\n        address: \"-\"\n      }));\n    }\n\n    if (newclients.phone_number === \"\") {\n      setnewclients(_objectSpread(_objectSpread({}, newclients), {}, {\n        phone_number: \"-\"\n      }));\n    }\n\n    setloadingbtn(true);\n    fetch(\"\".concat(process.env.NEXT_PUBLIC_BACKEND_URL, \"/addCompanyClient\"), {\n      method: \"POST\",\n      headers: {\n        Authorization: JSON.parse(tok),\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify(newclients)\n    }).then(function (res) {\n      return res.json();\n    }).then(function (res2) {\n      setloadingbtn(false);\n\n      if (res2.success) {\n        _notification[\"success\"]({\n          message: res2.message,\n          duration: 3\n        });\n\n        setnewclients({\n          name: \"\",\n          role: 0,\n          address: \"\",\n          phone_number: \"\",\n          image_logo: \"\",\n          parent_id: null\n        });\n        setTimeout(function () {\n          setDrawablecreate(false);\n          rt.push(\"/admin/clients\");\n        }, 800);\n      } else if (!res2.success) {\n        _notification[\"error\"]({\n          message: res2.message.errorInfo.status_detail,\n          duration: 3,\n          style: {\n            zIndex: \"1000\"\n          }\n        });\n      }\n    });\n  }; //useEffect\n\n\n  useEffect(function () {\n    setloaddatatable(true);\n    fetch(\"\".concat(process.env.NEXT_PUBLIC_BACKEND_URL, \"/getCompanyClientList\"), {\n      method: \"GET\",\n      headers: {\n        Authorization: JSON.parse(initProps),\n        \"Content-Type\": \"application/json\"\n      }\n    }).then(function (res) {\n      return res.json();\n    }).then(function (res2) {\n      setdatatable(res2.data);\n      setdatatable2(res2.data);\n      setloaddatatable(false);\n    });\n  }, []);\n  return /*#__PURE__*/_jsxs(Layout, {\n    tok: tok,\n    dataProfile: dataProfile,\n    sidemenu: sidemenu,\n    pathArr: pathArr,\n    st: st,\n    children: [/*#__PURE__*/_jsx(\"div\", {\n      className: \"flex justify-start md:justify-end p-3 md:border-t-2 md:border-b-2 bg-white mb-4 md:mb-8\",\n      children: /*#__PURE__*/_jsxs(\"div\", {\n        className: \" w-full flex justify-between items-center px-2\",\n        children: [/*#__PURE__*/_jsx(\"h1\", {\n          className: \"font-bold\",\n          children: \"Clients\"\n        }),\n        /*#__PURE__*/\n        // [157].every((curr) => dataProfile.data.registered_feature.includes(curr)) &&\n        _jsx(_Button, {\n          type: \"primary\",\n          size: \"large\",\n          onClick: function onClick() {\n            rt.push(\"/admin/clients/locations/new?parent=list&frominduk=0\");\n          },\n          children: \"Tambah\"\n        }) // <Button type=\"primary\" size=\"large\" onClick={() => { setDrawablecreate(true); }}>Tambah</Button>\n        ]\n      })\n    }), /*#__PURE__*/_jsx(\"div\", {\n      className: \"p-5 mt-5 flex flex-col space-y-5 rounded-md w-full h-auto bg-white\",\n      children: /*#__PURE__*/_jsx(_Table, {\n        pagination: {\n          pageSize: 6\n        },\n        scroll: {\n          x: 200\n        } // onRow={(record, rowIndex) => {\n        //     return {\n        //         onMouseOver: (event) => {\n        //             var eventscopy = events\n        //             eventscopy[rowIndex] = true\n        //             setEvents(eventscopy)\n        //             setEvent(\"block\")\n        //             setColorhover(\"bg-blue-100\")\n        //         },\n        //         onMouseLeave: (event) => {\n        //             var eventscopy = events\n        //             eventscopy[rowIndex] = false\n        //             setEvents(eventscopy)\n        //             setEvent(\"hidden\")\n        //             setColorhover(\"\")\n        //         }\n        //     }\n        // }}\n        ,\n        columns: columnsTable,\n        dataSource: datatable,\n        loading: loaddatatable\n      })\n    })]\n  });\n}\n\nexport var __N_SSP = true;\nexport default ClientsIndex;","map":null,"metadata":{},"sourceType":"module"}