{"ast":null,"code":"import _Modal from \"antd/lib/modal\";\nimport _Drawer from \"antd/lib/drawer\";\nimport _Form from \"antd/lib/form\";\nimport _Table from \"antd/lib/table\";\nimport _notification from \"antd/lib/notification\";\nimport _Input from \"antd/lib/input\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport _Button from \"antd/lib/button\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport { DeleteOutlined, EditOutlined, SearchOutlined } from \"@ant-design/icons\";\nimport Link from \"next/link\";\nimport { useRouter } from \"next/router\";\nimport { useState } from \"react\";\nimport Layout from \"../../../components/layout-dashboard\";\nimport st from \"../../../components/layout-dashboard.module.css\";\nimport httpcookie from \"cookie\";\n\nconst FeaturesIndex = ({\n  initProps,\n  dataProfile,\n  dataListFeatures,\n  sidemenu\n}) => {\n  //Definisi table\n  const columnsFeature = [{\n    title: \"Nomor\",\n    dataIndex: \"nomor\",\n    key: \"nomor\",\n    render: (text, record, index) => {\n      return {\n        props: {\n          style: {\n            backgroundColor: index % 2 == 1 ? \"#f2f2f2\" : \"#fff\"\n          }\n        },\n        children: /*#__PURE__*/_jsx(_Fragment, {\n          children: /*#__PURE__*/_jsx(\"a\", {\n            href: \"#\",\n            onClick: () => {\n              setdrawedit(true);\n              setdataedit({\n                id: record.id,\n                name: record.name,\n                description: record.description\n              });\n            },\n            children: /*#__PURE__*/_jsx(\"h1\", {\n              className: \"font-semibold hover:text-gray-500\",\n              children: record.nomor\n            })\n          })\n        })\n      };\n    }\n  }, {\n    title: \"Nama Feature\",\n    dataIndex: \"name\",\n    key: \"name\",\n    render: (text, record, index) => {\n      return {\n        props: {\n          style: {\n            backgroundColor: index % 2 == 1 ? \"#f2f2f2\" : \"#fff\"\n          }\n        },\n        children: /*#__PURE__*/_jsx(_Fragment, {\n          children: /*#__PURE__*/_jsx(\"a\", {\n            href: \"#\",\n            onClick: () => {\n              setdrawedit(true);\n              setdataedit({\n                id: record.id,\n                name: record.name,\n                description: record.description\n              });\n            },\n            children: /*#__PURE__*/_jsx(\"h1\", {\n              className: \"hover:text-gray-500\",\n              children: record.name\n            })\n          })\n        })\n      };\n    }\n  }, {\n    title: \"Deskripsi\",\n    dataIndex: \"description\",\n    key: \"description\",\n    render: (text, record, index) => {\n      return {\n        props: {\n          style: {\n            backgroundColor: index % 2 == 1 ? \"#f2f2f2\" : \"#fff\"\n          }\n        },\n        children: /*#__PURE__*/_jsx(_Fragment, {\n          children: /*#__PURE__*/_jsx(\"a\", {\n            href: \"#\",\n            onClick: () => {\n              setdrawedit(true);\n              setdataedit({\n                id: record.id,\n                name: record.name,\n                description: record.description\n              });\n            },\n            children: /*#__PURE__*/_jsx(\"h1\", {\n              className: \"hover:text-gray-500 text-xs\",\n              children: record.description\n            })\n          })\n        })\n      };\n    }\n  }, {\n    dataIndex: \"status\",\n    key: \"status\",\n    render: (text, record, index) => {\n      return {\n        props: {\n          style: {\n            backgroundColor: index % 2 == 1 ? \"#f2f2f2\" : \"#fff\"\n          }\n        },\n        children: /*#__PURE__*/_jsxs(\"div\", {\n          className: \" flex\",\n          children: [/*#__PURE__*/_jsx(_Button, {\n            disabled: true,\n            onClick: () => {\n              setdrawedit(true);\n              setdataedit({\n                id: record.id,\n                name: record.name,\n                description: record.description\n              });\n            },\n            style: {\n              paddingTop: `0`,\n              paddingBottom: `0.3rem`,\n              marginRight: `1rem`\n            },\n            children: /*#__PURE__*/_jsx(EditOutlined, {})\n          }), /*#__PURE__*/_jsx(_Button, {\n            disabled: true,\n            danger: true,\n            onClick: () => {\n              setmodaldelete(true);\n              setdatadelete(_objectSpread(_objectSpread({}, datadelete), {}, {\n                id: parseInt(record.id)\n              }));\n              setfeatureselected(record.name);\n            },\n            loading: loadingdelete,\n            style: {\n              paddingTop: `0`,\n              paddingBottom: `0.3rem`\n            },\n            children: /*#__PURE__*/_jsx(DeleteOutlined, {})\n          })]\n        })\n      };\n    }\n  }];\n  const rt = useRouter();\n  const pathArr = rt.pathname.split(\"/\").slice(1);\n  const {\n    Search\n  } = _Input; //useState\n\n  dataListFeatures.data = dataListFeatures.data.map((doc, idx) => {\n    return _objectSpread(_objectSpread({}, doc), {}, {\n      nomor: idx + 1\n    });\n  });\n  const {\n    0: datatable,\n    1: setdatatable\n  } = useState(dataListFeatures.data); //create\n\n  const {\n    0: drawcreate,\n    1: setdrawcreate\n  } = useState(false);\n  const {\n    0: loadingcreate,\n    1: setloadingcreate\n  } = useState(false);\n  const {\n    0: datacreate,\n    1: setdatacreate\n  } = useState({\n    name: \"\",\n    description: \"\"\n  }); //update\n\n  const {\n    0: drawedit,\n    1: setdrawedit\n  } = useState(false);\n  const {\n    0: loadingedit,\n    1: setloadingedit\n  } = useState(false);\n  const {\n    0: dataedit,\n    1: setdataedit\n  } = useState({\n    id: 0,\n    name: \"\",\n    description: \"\"\n  }); //delete\n\n  const {\n    0: modaldelete,\n    1: setmodaldelete\n  } = useState(false);\n  const {\n    0: loadingdelete,\n    1: setloadingdelete\n  } = useState(false);\n  const {\n    0: featureselected,\n    1: setfeatureselected\n  } = useState(\"\");\n  const {\n    0: datadelete,\n    1: setdatadelete\n  } = useState({\n    id: 0\n  }); //event\n\n  const onCariFeature = e => {\n    console.log(\"asa: \" + e.target.value);\n\n    if (e.target.value === \"\") {\n      setdatatable(dataListFeatures.data);\n    } else {\n      setdatatable(dataListFeatures.data);\n      setdatatable(prev => {\n        return prev.filter(dataa => {\n          return dataa.name.toLowerCase().includes(e.target.value.toLowerCase());\n        });\n      });\n    }\n  };\n\n  const handleDelete = () => {\n    setloadingdelete(true);\n    fetch(`${process.env.NEXT_PUBLIC_BACKEND_URL}/deleteFeature`, {\n      method: \"POST\",\n      headers: {\n        Authorization: JSON.parse(initProps),\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify(datadelete)\n    }).then(res => res.json()).then(res2 => {\n      if (res2.success) {\n        _notification[\"success\"]({\n          message: res2.message,\n          duration: 3\n        });\n\n        setTimeout(() => {\n          setloadingdelete(false);\n          setmodaldelete(false);\n          rt.push(`/admin/features`);\n        }, 500);\n      } else if (!res2.success) {\n        _notification[\"error\"]({\n          message: res2.message,\n          duration: 3\n        });\n\n        setloadingdelete(false);\n        setmodaldelete(false);\n      }\n    });\n  };\n\n  const handleEdit = () => {\n    _notification[\"warning\"]({\n      message: \"API still not available\",\n      duration: 3\n    });\n  };\n\n  const handleCreate = () => {\n    setloadingcreate(true);\n    fetch(`${process.env.NEXT_PUBLIC_BACKEND_URL}/addFeature`, {\n      method: \"POST\",\n      headers: {\n        Authorization: JSON.parse(initProps),\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify(datacreate)\n    }).then(res => res.json()).then(res2 => {\n      if (res2.success) {\n        _notification[\"success\"]({\n          message: res2.message,\n          duration: 3\n        });\n\n        setTimeout(() => {\n          setloadingcreate(false);\n          setdrawcreate(false);\n          rt.push(`/admin/features`);\n        }, 500);\n      } else if (!res2.success) {\n        _notification[\"error\"]({\n          message: res2.message.errorInfo.status_detail,\n          duration: 3\n        });\n\n        setloadingcreate(false);\n        setdrawcreate(false);\n      }\n    });\n  };\n\n  return /*#__PURE__*/_jsxs(Layout, {\n    tok: initProps,\n    dataProfile: dataProfile,\n    sidemenu: sidemenu,\n    st: st,\n    pathArr: pathArr,\n    children: [/*#__PURE__*/_jsxs(\"div\", {\n      className: \"w-full grid grid-cols-5 border-t border-opacity-30 border-gray-500 bg-white\",\n      children: [/*#__PURE__*/_jsxs(\"div\", {\n        className: \"col-span-5 border-b border-opacity-30 border-gray-400 flex items-center justify-between px-0 py-4 md:p-4 mb-5\",\n        children: [/*#__PURE__*/_jsx(\"h1\", {\n          className: \"font-bold\",\n          children: \"Features\"\n        }), /*#__PURE__*/_jsx(_Button, {\n          disabled: true,\n          type: \"primary\",\n          size: \"large\",\n          onClick: () => {\n            setdrawcreate(true);\n          },\n          children: \"Add New\"\n        })]\n      }), /*#__PURE__*/_jsxs(\"div\", {\n        className: \"col-span-5 p-0 md:p-5 flex flex-col\",\n        children: [/*#__PURE__*/_jsx(\"div\", {\n          className: \"w-full md:w-5/12\",\n          children: /*#__PURE__*/_jsx(_Input, {\n            prefix: /*#__PURE__*/_jsx(SearchOutlined, {}),\n            placeholder: \"Cari Fitur\",\n            style: {\n              borderRadius: `0.1rem`,\n              marginBottom: `1rem`,\n              width: `100%`\n            },\n            onChange: onCariFeature,\n            allowClear: true\n          })\n        }), /*#__PURE__*/_jsx(_Table, {\n          columns: columnsFeature,\n          dataSource: datatable,\n          pagination: {\n            pageSize: 8\n          },\n          scroll: {\n            x: 300\n          }\n        })]\n      })]\n    }), /*#__PURE__*/_jsx(_Drawer, {\n      title: `Tambah Feature`,\n      maskClosable: false,\n      visible: drawcreate,\n      onClose: () => {\n        setdrawcreate(false);\n        /*closeClientsDrawer(); instanceForm.resetFields()*/\n      },\n      width: 380,\n      destroyOnClose: true,\n      children: /*#__PURE__*/_jsx(\"div\", {\n        className: \"flex flex-col\",\n        children: /*#__PURE__*/_jsxs(_Form, {\n          layout: \"vertical\",\n          initialValues: datacreate,\n          onFinish: handleCreate,\n          children: [/*#__PURE__*/_jsx(_Form.Item, {\n            label: \"Nama Feature\",\n            name: \"name\",\n            rules: [{\n              required: true,\n              message: \"Nama feature wajib diisi\"\n            }],\n            children: /*#__PURE__*/_jsx(_Input, {\n              defaultValue: datacreate.name,\n              onChange: e => {\n                setdatacreate(_objectSpread(_objectSpread({}, datacreate), {}, {\n                  name: e.target.value\n                }));\n              }\n            })\n          }), /*#__PURE__*/_jsx(_Form.Item, {\n            label: \"Deskripsi\",\n            name: \"description\",\n            rules: [{\n              required: true,\n              message: \"Deskripsi wajib diisi\"\n            }],\n            children: /*#__PURE__*/_jsx(_Input.TextArea, {\n              defaultValue: datacreate.description,\n              onChange: e => {\n                setdatacreate(_objectSpread(_objectSpread({}, datacreate), {}, {\n                  description: e.target.value\n                }));\n              }\n            })\n          }), /*#__PURE__*/_jsxs(\"div\", {\n            className: \"flex justify-end\",\n            children: [/*#__PURE__*/_jsx(_Button, {\n              type: \"default\",\n              onClick: () => {\n                setdrawcreate(false);\n              },\n              style: {\n                marginRight: `1rem`\n              },\n              children: \"Cancel\"\n            }), /*#__PURE__*/_jsx(_Button, {\n              htmlType: \"submit\",\n              type: \"primary\",\n              onClick: () => {\n                setdrawcreate(false);\n              },\n              children: \"Save\"\n            })]\n          })]\n        })\n      })\n    }), /*#__PURE__*/_jsx(_Drawer, {\n      title: `Edit Feature`,\n      maskClosable: false,\n      visible: drawedit,\n      onClose: () => {\n        setdrawedit(false);\n        /*closeClientsDrawer(); instanceForm.resetFields()*/\n      },\n      width: 380,\n      destroyOnClose: true,\n      children: /*#__PURE__*/_jsx(\"div\", {\n        className: \"flex flex-col\",\n        children: /*#__PURE__*/_jsxs(_Form, {\n          layout: \"vertical\",\n          initialValues: dataedit,\n          onFinish: handleEdit,\n          children: [/*#__PURE__*/_jsx(_Form.Item, {\n            label: \"Nama Feature\",\n            rules: [{\n              required: true,\n              message: \"Nama feature wajib diisi\"\n            }],\n            name: \"name\",\n            children: /*#__PURE__*/_jsx(_Input, {\n              defaultValue: dataedit.name,\n              onChange: e => {\n                setdataedit(_objectSpread(_objectSpread({}, dataedit), {}, {\n                  name: e.target.value\n                }));\n              }\n            })\n          }), /*#__PURE__*/_jsx(_Form.Item, {\n            label: \"Deskripsi\",\n            name: \"description\",\n            rules: [{\n              required: true,\n              message: \"Deskripsi wajib diisi\"\n            }],\n            style: {\n              marginBottom: `3rem`\n            },\n            children: /*#__PURE__*/_jsx(_Input.TextArea, {\n              defaultValue: dataedit.description,\n              onChange: e => {\n                setdataedit(_objectSpread(_objectSpread({}, dataedit), {}, {\n                  description: e.target.value\n                }));\n              }\n            })\n          }), /*#__PURE__*/_jsxs(\"div\", {\n            className: \"flex justify-end\",\n            children: [/*#__PURE__*/_jsx(_Button, {\n              type: \"default\",\n              onClick: () => {\n                setdrawedit(false);\n              },\n              style: {\n                marginRight: `1rem`\n              },\n              children: \"Cancel\"\n            }), /*#__PURE__*/_jsx(_Button, {\n              htmlType: \"submit\",\n              type: \"primary\",\n              onClick: () => {\n                setdrawedit(false);\n              },\n              children: \"Save\"\n            })]\n          })]\n        })\n      })\n    }), /*#__PURE__*/_jsxs(_Modal, {\n      title: `Konfirmasi hapus feature`,\n      visible: modaldelete,\n      okButtonProps: {\n        disabled: loadingdelete\n      },\n      onCancel: () => {\n        setmodaldelete(false);\n      },\n      onOk: handleDelete,\n      maskClosable: false,\n      style: {\n        top: `3rem`\n      },\n      width: 500,\n      destroyOnClose: true,\n      children: [\"Yakin ingin hapus feature \", featureselected, \"?\"]\n    })]\n  });\n};\n\nexport async function getServerSideProps({\n  req,\n  res\n}) {\n  var initProps = {};\n\n  if (req && req.headers) {\n    const cookies = req.headers.cookie;\n\n    if (!cookies) {\n      res.writeHead(302, {\n        Location: \"/login\"\n      });\n      res.end();\n    }\n\n    if (typeof cookies === \"string\") {\n      const cookiesJSON = httpcookie.parse(cookies);\n      initProps = cookiesJSON.token;\n    }\n  }\n\n  const resources = await fetch(`${process.env.NEXT_PUBLIC_BACKEND_URL}/detailProfile`, {\n    method: `GET`,\n    headers: {\n      Authorization: JSON.parse(initProps)\n    }\n  });\n  const resjson = await resources.json();\n  const dataProfile = resjson;\n  const resourcesGF = await fetch(`${process.env.NEXT_PUBLIC_BACKEND_URL}/getFeatures`, {\n    method: `GET`,\n    headers: {\n      Authorization: JSON.parse(initProps)\n    }\n  });\n  const resjsonGF = await resourcesGF.json();\n  const dataListFeatures = resjsonGF;\n  return {\n    props: {\n      initProps,\n      dataProfile,\n      dataListFeatures,\n      sidemenu: \"4\"\n    }\n  };\n}\nexport default FeaturesIndex;","map":null,"metadata":{},"sourceType":"module"}