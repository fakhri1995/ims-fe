{"ast":null,"code":"import _Select from \"antd/lib/select\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport _Input from \"antd/lib/input\";\nimport _TreeSelect from \"antd/lib/tree-select\";\nimport _Upload from \"antd/lib/upload\";\nimport _Button from \"antd/lib/button\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport _notification from \"antd/lib/notification\";\nimport _Form from \"antd/lib/form\";\nvar _jsxFileName = \"/home/kjokken/mig/code/frontend/ims-fe-ssh-dev/src/pages/admin/agents/create/index.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport { LoadingOutlined } from \"@ant-design/icons\";\nimport { PlusOutlined } from \"@ant-design/icons\";\nimport Link from \"next/link\";\nimport { useRouter } from \"next/router\";\nimport { useEffect, useState } from \"react\";\nimport Sticky from \"wil-react-sticky\";\nimport Layout from \"../../../../components/layout-dashboard\";\nimport st from \"../../../../components/layout-dashboard.module.css\";\nimport httpcookie from \"cookie\";\n\nfunction AgentsCreate({\n  initProps,\n  dataProfile,\n  sidemenu\n}) {\n  const rt = useRouter();\n  const {\n    originPath\n  } = rt.query;\n  const tok = initProps; //Breadcrumb\n\n  var pathArr = rt.pathname.split(\"/\").slice(1);\n  pathArr[pathArr.length - 1] = \"Create\"; //init Form instance\n\n  const [instanceForm] = _Form.useForm(); //useState\n  //data payload\n\n\n  const {\n    0: newuser,\n    1: setNewuser\n  } = useState({\n    fullname: \"\",\n    email: \"\",\n    role_ids: [],\n    phone_number: \"\",\n    profile_image: \"\",\n    company_id: 1,\n    password: \"\",\n    confirm_password: \"\",\n    position: \"\"\n  }); //is loading upload image\n\n  const {\n    0: loadingupload,\n    1: setLoadingupload\n  } = useState(false); //is loading upddate\n\n  const {\n    0: loadingsave,\n    1: setLoadingsave\n  } = useState(false); //data companies\n\n  const {\n    0: datacompanylist,\n    1: setdatacompanylist\n  } = useState([]); //data roles\n\n  const {\n    0: dataroles,\n    1: setdataroles\n  } = useState([]); //is pra rendered loading\n\n  const {\n    0: praloading,\n    1: setpraloading\n  } = useState(true); //handle CreateAgent\n\n  const handleCreateAgents = () => {\n    setLoadingsave(true);\n    fetch(`${process.env.NEXT_PUBLIC_BACKEND_URL}/addAgentMember`, {\n      method: \"POST\",\n      headers: {\n        Authorization: JSON.parse(tok),\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify(newuser)\n    }).then(res => res.json()).then(res2 => {\n      setLoadingsave(false);\n\n      if (res2.success) {\n        _notification[\"success\"]({\n          message: res2.message,\n          duration: 3\n        });\n\n        setTimeout(() => {\n          rt.push(`/admin/agents/detail/${res2.id}`);\n        }, 1000);\n      } else if (!res2.success) {\n        _notification[\"error\"]({\n          message: res2.message,\n          duration: 3\n        });\n      }\n    });\n    console.log(\"isi new user: \" + newuser.profile_image);\n  }; //on change create agent\n\n\n  const onChangeCreateAgents = e => {\n    var val = e.target.value;\n\n    if (e.target.name === \"role\") {\n      val = parseInt(e.target.value);\n    }\n\n    setNewuser(_objectSpread(_objectSpread({}, newuser), {}, {\n      [e.target.name]: val\n    }));\n  }; //handle before upload\n\n\n  const beforeUploadProfileImage = file => {\n    const isJpgOrPng = file.type === \"image/jpeg\" || file.type === \"image/png\" || file.type === \"image/jpg\";\n\n    if (!isJpgOrPng) {\n      message.error(\"You can only upload JPG/PNG file!\");\n    }\n\n    const isLt2M = file.size / 1024 / 1024 < 2;\n\n    if (!isLt2M) {\n      message.error(\"Image must smaller than 2MB!\");\n    }\n\n    return isJpgOrPng && isLt2M;\n  };\n\n  const onChangeProfileImage = async info => {\n    if (info.file.status === \"uploading\") {\n      setLoadingupload(true);\n      return;\n    }\n\n    if (info.file.status === \"done\") {\n      console.log(\"isi upload: \" + info.file.originFileObj.name);\n      const formData = new FormData();\n      formData.append(\"file\", info.file.originFileObj);\n      formData.append(\"upload_preset\", \"migsys\");\n      return fetch(`https://api.Cloudinary.com/v1_1/aqlpeduli/image/upload`, {\n        method: \"POST\",\n        body: formData\n      }).then(res => res.json()).then(res2 => {\n        setNewuser(_objectSpread(_objectSpread({}, newuser), {}, {\n          profile_image: res2.secure_url\n        }));\n      });\n    }\n  };\n\n  const uploadButton = /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [loadingupload ? /*#__PURE__*/_jsxDEV(LoadingOutlined, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 24\n    }, this) : /*#__PURE__*/_jsxDEV(PlusOutlined, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 46\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        marginTop: 8\n      },\n      children: \"Unggah\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 136,\n    columnNumber: 5\n  }, this); //useEffect\n  //get Asal Lokasi\n\n\n  useEffect(() => {\n    fetch(`${process.env.NEXT_PUBLIC_BACKEND_URL}/getBranchCompanyList`, {\n      method: `GET`,\n      headers: {\n        Authorization: JSON.parse(initProps)\n      }\n    }).then(res => res.json()).then(res2 => {\n      setdatacompanylist([res2.data]);\n      setpraloading(false);\n    });\n  }, []); //data Roles\n\n  useEffect(() => {\n    fetch(`${process.env.NEXT_PUBLIC_BACKEND_URL}/getRoles`, {\n      method: `GET`,\n      headers: {\n        Authorization: JSON.parse(initProps)\n      }\n    }).then(res => res.json()).then(res2 => {\n      setdataroles(res2.data);\n    });\n  }, []);\n  return /*#__PURE__*/_jsxDEV(Layout, {\n    tok: tok,\n    dataProfile: dataProfile,\n    pathArr: pathArr,\n    sidemenu: sidemenu,\n    originPath: originPath,\n    st: st,\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"w-full h-auto grid grid-cols-1 md:grid-cols-4\",\n      id: \"createAgentsWrapper\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \" col-span-1 md:col-span-4\",\n        children: /*#__PURE__*/_jsxDEV(Sticky, {\n          containerSelectorFocus: \"#createAgentsWrapper\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \" col-span-4 flex justify-between p-2 pt-4 border-t-2 border-b-2 bg-white mb-8\",\n            children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n              className: \"font-semibold py-2\",\n              children: \"Buat Akun Agent\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 187,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex space-x-2\",\n              children: [/*#__PURE__*/_jsxDEV(Link, {\n                href: \"/admin/agents\",\n                children: /*#__PURE__*/_jsxDEV(_Button, {\n                  type: \"default\",\n                  children: \"Batal\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 190,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 189,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(_Button, {\n                disabled: praloading,\n                type: \"primary\",\n                loading: loadingsave,\n                onClick: instanceForm.submit,\n                children: \"Simpan\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 192,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 188,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 186,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 185,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 184,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"col-span-1 md:col-span-3 flex flex-col\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"shadow-lg flex flex-col rounded-md w-full h-auto p-4 mb-14\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"border-b border-black p-4 font-semibold mb-5\",\n            children: [\"Akun Agent - \", newuser.fullname]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 206,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"grid grid-cols-1 md:grid-cols-4\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"p-3 col-span-1 md:col-span-1\",\n              children: /*#__PURE__*/_jsxDEV(_Upload, {\n                name: \"profile_image\",\n                listType: \"picture-card\",\n                className: \"profileImage\",\n                showUploadList: false,\n                beforeUpload: beforeUploadProfileImage,\n                onChange: onChangeProfileImage,\n                children: newuser.profile_image ? /*#__PURE__*/_jsxDEV(\"img\", {\n                  src: newuser.profile_image,\n                  alt: \"avatar\",\n                  style: {\n                    width: \"100%\"\n                  }\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 220,\n                  columnNumber: 21\n                }, this) : uploadButton\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 211,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 210,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"p-3 col-span-1 md:col-span-3\",\n              children: /*#__PURE__*/_jsxDEV(_Form, {\n                layout: \"vertical\",\n                form: instanceForm,\n                className: \"createAgentsForm\",\n                onFinish: handleCreateAgents,\n                children: [/*#__PURE__*/_jsxDEV(_Form.Item, {\n                  label: \"Asal Lokasi\",\n                  name: \"company_id\",\n                  rules: [{\n                    required: true,\n                    message: \"Asal Lokasi wajib diisi\"\n                  }],\n                  children: /*#__PURE__*/_jsxDEV(_TreeSelect, {\n                    allowClear: true,\n                    dropdownStyle: {\n                      maxHeight: 400,\n                      overflow: \"auto\"\n                    },\n                    treeData: datacompanylist,\n                    placeholder: \"Pilih Asal Lokasi\",\n                    treeDefaultExpandAll: true,\n                    onChange: value => {\n                      setNewuser(_objectSpread(_objectSpread({}, newuser), {}, {\n                        company_id: value\n                      }));\n                    }\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 247,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 237,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(_Form.Item, {\n                  label: \"Nama Lengkap\",\n                  required: true,\n                  name: \"fullname\",\n                  rules: [{\n                    required: true,\n                    message: \"Nama Lengkap wajib diisi\"\n                  }],\n                  children: /*#__PURE__*/_jsxDEV(_Input, {\n                    value: newuser.fullname,\n                    name: `fullname`,\n                    onChange: onChangeCreateAgents\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 269,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 258,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(_Form.Item, {\n                  label: \"Email\",\n                  required: true,\n                  name: \"email\",\n                  rules: [{\n                    required: true,\n                    message: \"Email wajib diisi\"\n                  }, {\n                    pattern: /(\\-)|(^(([^<>()[\\]\\\\.,;:\\s@\\\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\\\"]+)*)|(\\\".+\\\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$)/,\n                    message: \"Email belum diisi dengan benar\"\n                  }],\n                  children: /*#__PURE__*/_jsxDEV(_Input, {\n                    value: newuser.email,\n                    name: `email`,\n                    onChange: onChangeCreateAgents\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 291,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 275,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(_Form.Item, {\n                  label: \"Posisi\",\n                  required: true,\n                  name: \"position\",\n                  rules: [{\n                    required: true,\n                    message: \"Posisi wajib diisi\"\n                  }],\n                  children: /*#__PURE__*/_jsxDEV(_Input, {\n                    value: newuser.position,\n                    name: `position`,\n                    onChange: onChangeCreateAgents\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 308,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 297,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(_Form.Item, {\n                  label: \"No. Handphone\",\n                  name: \"phone_number\",\n                  rules: [{\n                    required: true,\n                    message: \"No.Handphone wajib diisi\"\n                  }, {\n                    pattern: /(\\-)|(^\\d*$)/,\n                    message: \"No. Handphone harus berisi angka\"\n                  }],\n                  children: /*#__PURE__*/_jsxDEV(_Input, {\n                    value: newuser.phone_number,\n                    name: `phone_number`,\n                    onChange: onChangeCreateAgents\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 328,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 314,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(_Form.Item, {\n                  label: \"Password\",\n                  name: \"password\",\n                  rules: [{\n                    required: true,\n                    message: \"Password wajib diisi\"\n                  }, {\n                    pattern: /([A-z0-9]{8})/,\n                    message: \"Password minimal 8 karakter\"\n                  }],\n                  children: /*#__PURE__*/_jsxDEV(_Input.Password, {\n                    value: newuser.password,\n                    name: `password`,\n                    onChange: onChangeCreateAgents\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 348,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 334,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(_Form.Item, {\n                  label: \"Konfirmasi Password\",\n                  name: \"password\",\n                  rules: [{\n                    required: true,\n                    message: \"Confirm Password wajib diisi\"\n                  }, {\n                    pattern: /([A-z0-9]{8})/,\n                    message: \"Confirm Password minimal 8 karakter\"\n                  }],\n                  children: /*#__PURE__*/_jsxDEV(_Fragment, {\n                    children: [/*#__PURE__*/_jsxDEV(_Input.Password, {\n                      value: newuser.confirm_password,\n                      name: `confirm_password`,\n                      onChange: onChangeCreateAgents\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 369,\n                      columnNumber: 23\n                    }, this), newuser.password !== newuser.confirm_password && /*#__PURE__*/_jsxDEV(\"p\", {\n                      className: \" text-red-500 mb-0\",\n                      children: \"Confirm Password harus sesuai dengan password\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 375,\n                      columnNumber: 25\n                    }, this)]\n                  }, void 0, true)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 354,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(_Form.Item, {\n                  label: \"Role\",\n                  name: \"role\",\n                  children: /*#__PURE__*/_jsxDEV(_Select, {\n                    mode: \"multiple\",\n                    onChange: value => {\n                      setNewuser(_objectSpread(_objectSpread({}, newuser), {}, {\n                        role_ids: value\n                      }));\n                    }\n                    /*defaultValue={idrole}*/\n                    ,\n                    style: {\n                      width: `100%`\n                    },\n                    children: dataroles.map((doc, idx) => {\n                      return /*#__PURE__*/_jsxDEV(_Select.Option, {\n                        value: doc.id,\n                        children: doc.name\n                      }, doc.id, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 391,\n                        columnNumber: 27\n                      }, this);\n                    })\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 382,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 381,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 231,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 230,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 209,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 205,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 204,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 180,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 172,\n    columnNumber: 5\n  }, this);\n}\n\nexport async function getServerSideProps({\n  req,\n  res\n}) {\n  var initProps = {};\n  const reqBody = {\n    page: 1,\n    rows: 50,\n    order_by: \"asc\"\n  };\n\n  if (req && req.headers) {\n    const cookies = req.headers.cookie;\n\n    if (!cookies) {\n      res.writeHead(302, {\n        Location: \"/login\"\n      });\n      res.end();\n    }\n\n    if (typeof cookies === \"string\") {\n      const cookiesJSON = httpcookie.parse(cookies);\n      initProps = cookiesJSON.token;\n    }\n  }\n\n  const resources = await fetch(`${process.env.NEXT_PUBLIC_BACKEND_URL}/detailProfile`, {\n    method: `GET`,\n    headers: {\n      Authorization: JSON.parse(initProps)\n    }\n  });\n  const resjson = await resources.json();\n  const dataProfile = resjson; // if (![109].every((curr) => dataProfile.data.registered_feature.includes(curr))) {\n  //     res.writeHead(302, { Location: '/dashboard/admin' })\n  //     res.end()\n  // }\n\n  return {\n    props: {\n      initProps,\n      dataProfile,\n      sidemenu: \"61\"\n    }\n  };\n}\nexport default AgentsCreate;","map":{"version":3,"sources":["/home/kjokken/mig/code/frontend/ims-fe-ssh-dev/src/pages/admin/agents/create/index.js"],"names":["LoadingOutlined","PlusOutlined","Link","useRouter","useEffect","useState","Sticky","Layout","st","httpcookie","AgentsCreate","initProps","dataProfile","sidemenu","rt","originPath","query","tok","pathArr","pathname","split","slice","length","instanceForm","useForm","newuser","setNewuser","fullname","email","role_ids","phone_number","profile_image","company_id","password","confirm_password","position","loadingupload","setLoadingupload","loadingsave","setLoadingsave","datacompanylist","setdatacompanylist","dataroles","setdataroles","praloading","setpraloading","handleCreateAgents","fetch","process","env","NEXT_PUBLIC_BACKEND_URL","method","headers","Authorization","JSON","parse","body","stringify","then","res","json","res2","success","message","duration","setTimeout","push","id","console","log","onChangeCreateAgents","e","val","target","value","name","parseInt","beforeUploadProfileImage","file","isJpgOrPng","type","error","isLt2M","size","onChangeProfileImage","info","status","originFileObj","formData","FormData","append","secure_url","uploadButton","marginTop","data","submit","width","required","maxHeight","overflow","pattern","map","doc","idx","getServerSideProps","req","reqBody","page","rows","order_by","cookies","cookie","writeHead","Location","end","cookiesJSON","token","resources","resjson","props"],"mappings":"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","sourcesContent":["import { LoadingOutlined } from \"@ant-design/icons\";\nimport { PlusOutlined } from \"@ant-design/icons\";\nimport {\n  Button,\n  Form,\n  Input,\n  Select,\n  TreeSelect,\n  Upload,\n  notification,\n} from \"antd\";\nimport Link from \"next/link\";\nimport { useRouter } from \"next/router\";\nimport { useEffect, useState } from \"react\";\nimport Sticky from \"wil-react-sticky\";\n\nimport Layout from \"../../../../components/layout-dashboard\";\nimport st from \"../../../../components/layout-dashboard.module.css\";\nimport httpcookie from \"cookie\";\n\nfunction AgentsCreate({ initProps, dataProfile, sidemenu }) {\n  const rt = useRouter();\n  const { originPath } = rt.query;\n  const tok = initProps;\n  //Breadcrumb\n  var pathArr = rt.pathname.split(\"/\").slice(1);\n  pathArr[pathArr.length - 1] = \"Create\";\n  //init Form instance\n  const [instanceForm] = Form.useForm();\n\n  //useState\n  //data payload\n  const [newuser, setNewuser] = useState({\n    fullname: \"\",\n    email: \"\",\n    role_ids: [],\n    phone_number: \"\",\n    profile_image: \"\",\n    company_id: 1,\n    password: \"\",\n    confirm_password: \"\",\n    position: \"\",\n  });\n  //is loading upload image\n  const [loadingupload, setLoadingupload] = useState(false);\n  //is loading upddate\n  const [loadingsave, setLoadingsave] = useState(false);\n  //data companies\n  const [datacompanylist, setdatacompanylist] = useState([]);\n  //data roles\n  const [dataroles, setdataroles] = useState([]);\n  //is pra rendered loading\n  const [praloading, setpraloading] = useState(true);\n\n  //handle CreateAgent\n  const handleCreateAgents = () => {\n    setLoadingsave(true);\n    fetch(`${process.env.NEXT_PUBLIC_BACKEND_URL}/addAgentMember`, {\n      method: \"POST\",\n      headers: {\n        Authorization: JSON.parse(tok),\n        \"Content-Type\": \"application/json\",\n      },\n      body: JSON.stringify(newuser),\n    })\n      .then((res) => res.json())\n      .then((res2) => {\n        setLoadingsave(false);\n        if (res2.success) {\n          notification[\"success\"]({\n            message: res2.message,\n            duration: 3,\n          });\n          setTimeout(() => {\n            rt.push(`/admin/agents/detail/${res2.id}`);\n          }, 1000);\n        } else if (!res2.success) {\n          notification[\"error\"]({\n            message: res2.message,\n            duration: 3,\n          });\n        }\n      });\n    console.log(\"isi new user: \" + newuser.profile_image);\n  };\n  //on change create agent\n  const onChangeCreateAgents = (e) => {\n    var val = e.target.value;\n    if (e.target.name === \"role\") {\n      val = parseInt(e.target.value);\n    }\n    setNewuser({\n      ...newuser,\n      [e.target.name]: val,\n    });\n  };\n  //handle before upload\n  const beforeUploadProfileImage = (file) => {\n    const isJpgOrPng =\n      file.type === \"image/jpeg\" ||\n      file.type === \"image/png\" ||\n      file.type === \"image/jpg\";\n    if (!isJpgOrPng) {\n      message.error(\"You can only upload JPG/PNG file!\");\n    }\n    const isLt2M = file.size / 1024 / 1024 < 2;\n    if (!isLt2M) {\n      message.error(\"Image must smaller than 2MB!\");\n    }\n    return isJpgOrPng && isLt2M;\n  };\n  const onChangeProfileImage = async (info) => {\n    if (info.file.status === \"uploading\") {\n      setLoadingupload(true);\n      return;\n    }\n    if (info.file.status === \"done\") {\n      console.log(\"isi upload: \" + info.file.originFileObj.name);\n      const formData = new FormData();\n      formData.append(\"file\", info.file.originFileObj);\n      formData.append(\"upload_preset\", \"migsys\");\n      return fetch(`https://api.Cloudinary.com/v1_1/aqlpeduli/image/upload`, {\n        method: \"POST\",\n        body: formData,\n      })\n        .then((res) => res.json())\n        .then((res2) => {\n          setNewuser({\n            ...newuser,\n            profile_image: res2.secure_url,\n          });\n        });\n    }\n  };\n  const uploadButton = (\n    <div>\n      {loadingupload ? <LoadingOutlined /> : <PlusOutlined />}\n      <div style={{ marginTop: 8 }}>Unggah</div>\n    </div>\n  );\n\n  //useEffect\n  //get Asal Lokasi\n  useEffect(() => {\n    fetch(`${process.env.NEXT_PUBLIC_BACKEND_URL}/getBranchCompanyList`, {\n      method: `GET`,\n      headers: {\n        Authorization: JSON.parse(initProps),\n      },\n    })\n      .then((res) => res.json())\n      .then((res2) => {\n        setdatacompanylist([res2.data]);\n        setpraloading(false);\n      });\n  }, []);\n  //data Roles\n  useEffect(() => {\n    fetch(`${process.env.NEXT_PUBLIC_BACKEND_URL}/getRoles`, {\n      method: `GET`,\n      headers: {\n        Authorization: JSON.parse(initProps),\n      },\n    })\n      .then((res) => res.json())\n      .then((res2) => {\n        setdataroles(res2.data);\n      });\n  }, []);\n\n  return (\n    <Layout\n      tok={tok}\n      dataProfile={dataProfile}\n      pathArr={pathArr}\n      sidemenu={sidemenu}\n      originPath={originPath}\n      st={st}\n    >\n      <div\n        className=\"w-full h-auto grid grid-cols-1 md:grid-cols-4\"\n        id=\"createAgentsWrapper\"\n      >\n        <div className=\" col-span-1 md:col-span-4\">\n          <Sticky containerSelectorFocus=\"#createAgentsWrapper\">\n            <div className=\" col-span-4 flex justify-between p-2 pt-4 border-t-2 border-b-2 bg-white mb-8\">\n              <h1 className=\"font-semibold py-2\">Buat Akun Agent</h1>\n              <div className=\"flex space-x-2\">\n                <Link href=\"/admin/agents\">\n                  <Button type=\"default\">Batal</Button>\n                </Link>\n                <Button\n                  disabled={praloading}\n                  type=\"primary\"\n                  loading={loadingsave}\n                  onClick={instanceForm.submit}\n                >\n                  Simpan\n                </Button>\n              </div>\n            </div>\n          </Sticky>\n        </div>\n        <div className=\"col-span-1 md:col-span-3 flex flex-col\">\n          <div className=\"shadow-lg flex flex-col rounded-md w-full h-auto p-4 mb-14\">\n            <div className=\"border-b border-black p-4 font-semibold mb-5\">\n              Akun Agent - {newuser.fullname}\n            </div>\n            <div className=\"grid grid-cols-1 md:grid-cols-4\">\n              <div className=\"p-3 col-span-1 md:col-span-1\">\n                <Upload\n                  name=\"profile_image\"\n                  listType=\"picture-card\"\n                  className=\"profileImage\"\n                  showUploadList={false}\n                  beforeUpload={beforeUploadProfileImage}\n                  onChange={onChangeProfileImage}\n                >\n                  {newuser.profile_image ? (\n                    <img\n                      src={newuser.profile_image}\n                      alt=\"avatar\"\n                      style={{ width: \"100%\" }}\n                    />\n                  ) : (\n                    uploadButton\n                  )}\n                </Upload>\n              </div>\n              <div className=\"p-3 col-span-1 md:col-span-3\">\n                <Form\n                  layout=\"vertical\"\n                  form={instanceForm}\n                  className=\"createAgentsForm\"\n                  onFinish={handleCreateAgents}\n                >\n                  <Form.Item\n                    label=\"Asal Lokasi\"\n                    name=\"company_id\"\n                    rules={[\n                      {\n                        required: true,\n                        message: \"Asal Lokasi wajib diisi\",\n                      },\n                    ]}\n                  >\n                    <TreeSelect\n                      allowClear\n                      dropdownStyle={{ maxHeight: 400, overflow: \"auto\" }}\n                      treeData={datacompanylist}\n                      placeholder=\"Pilih Asal Lokasi\"\n                      treeDefaultExpandAll\n                      onChange={(value) => {\n                        setNewuser({ ...newuser, company_id: value });\n                      }}\n                    />\n                  </Form.Item>\n                  <Form.Item\n                    label=\"Nama Lengkap\"\n                    required\n                    name=\"fullname\"\n                    rules={[\n                      {\n                        required: true,\n                        message: \"Nama Lengkap wajib diisi\",\n                      },\n                    ]}\n                  >\n                    <Input\n                      value={newuser.fullname}\n                      name={`fullname`}\n                      onChange={onChangeCreateAgents}\n                    />\n                  </Form.Item>\n                  <Form.Item\n                    label=\"Email\"\n                    required\n                    name=\"email\"\n                    rules={[\n                      {\n                        required: true,\n                        message: \"Email wajib diisi\",\n                      },\n                      {\n                        pattern:\n                          /(\\-)|(^(([^<>()[\\]\\\\.,;:\\s@\\\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\\\"]+)*)|(\\\".+\\\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$)/,\n                        message: \"Email belum diisi dengan benar\",\n                      },\n                    ]}\n                  >\n                    <Input\n                      value={newuser.email}\n                      name={`email`}\n                      onChange={onChangeCreateAgents}\n                    />\n                  </Form.Item>\n                  <Form.Item\n                    label=\"Posisi\"\n                    required\n                    name=\"position\"\n                    rules={[\n                      {\n                        required: true,\n                        message: \"Posisi wajib diisi\",\n                      },\n                    ]}\n                  >\n                    <Input\n                      value={newuser.position}\n                      name={`position`}\n                      onChange={onChangeCreateAgents}\n                    />\n                  </Form.Item>\n                  <Form.Item\n                    label=\"No. Handphone\"\n                    name=\"phone_number\"\n                    rules={[\n                      {\n                        required: true,\n                        message: \"No.Handphone wajib diisi\",\n                      },\n                      {\n                        pattern: /(\\-)|(^\\d*$)/,\n                        message: \"No. Handphone harus berisi angka\",\n                      },\n                    ]}\n                  >\n                    <Input\n                      value={newuser.phone_number}\n                      name={`phone_number`}\n                      onChange={onChangeCreateAgents}\n                    />\n                  </Form.Item>\n                  <Form.Item\n                    label=\"Password\"\n                    name=\"password\"\n                    rules={[\n                      {\n                        required: true,\n                        message: \"Password wajib diisi\",\n                      },\n                      {\n                        pattern: /([A-z0-9]{8})/,\n                        message: \"Password minimal 8 karakter\",\n                      },\n                    ]}\n                  >\n                    <Input.Password\n                      value={newuser.password}\n                      name={`password`}\n                      onChange={onChangeCreateAgents}\n                    />\n                  </Form.Item>\n                  <Form.Item\n                    label=\"Konfirmasi Password\"\n                    name=\"password\"\n                    rules={[\n                      {\n                        required: true,\n                        message: \"Confirm Password wajib diisi\",\n                      },\n                      {\n                        pattern: /([A-z0-9]{8})/,\n                        message: \"Confirm Password minimal 8 karakter\",\n                      },\n                    ]}\n                  >\n                    <>\n                      <Input.Password\n                        value={newuser.confirm_password}\n                        name={`confirm_password`}\n                        onChange={onChangeCreateAgents}\n                      />\n                      {newuser.password !== newuser.confirm_password && (\n                        <p className=\" text-red-500 mb-0\">\n                          Confirm Password harus sesuai dengan password\n                        </p>\n                      )}\n                    </>\n                  </Form.Item>\n                  <Form.Item label=\"Role\" name=\"role\">\n                    <Select\n                      mode=\"multiple\"\n                      onChange={(value) => {\n                        setNewuser({ ...newuser, role_ids: value });\n                      }}\n                      /*defaultValue={idrole}*/ style={{ width: `100%` }}\n                    >\n                      {dataroles.map((doc, idx) => {\n                        return (\n                          <Select.Option key={doc.id} value={doc.id}>\n                            {doc.name}\n                          </Select.Option>\n                        );\n                      })}\n                    </Select>\n                  </Form.Item>\n                </Form>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </Layout>\n  );\n}\n\nexport async function getServerSideProps({ req, res }) {\n  var initProps = {};\n  const reqBody = {\n    page: 1,\n    rows: 50,\n    order_by: \"asc\",\n  };\n  if (req && req.headers) {\n    const cookies = req.headers.cookie;\n    if (!cookies) {\n      res.writeHead(302, { Location: \"/login\" });\n      res.end();\n    }\n    if (typeof cookies === \"string\") {\n      const cookiesJSON = httpcookie.parse(cookies);\n      initProps = cookiesJSON.token;\n    }\n  }\n\n  const resources = await fetch(\n    `${process.env.NEXT_PUBLIC_BACKEND_URL}/detailProfile`,\n    {\n      method: `GET`,\n      headers: {\n        Authorization: JSON.parse(initProps),\n      },\n    }\n  );\n  const resjson = await resources.json();\n  const dataProfile = resjson;\n\n  // if (![109].every((curr) => dataProfile.data.registered_feature.includes(curr))) {\n  //     res.writeHead(302, { Location: '/dashboard/admin' })\n  //     res.end()\n  // }\n\n  return {\n    props: {\n      initProps,\n      dataProfile,\n      sidemenu: \"61\",\n    },\n  };\n}\n\nexport default AgentsCreate;\n"]},"metadata":{},"sourceType":"module"}