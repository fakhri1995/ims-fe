{"ast":null,"code":"import _Spin from \"antd/lib/spin\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport _notification from \"antd/lib/notification\";\nimport _regeneratorRuntime from \"/home/kjokken/mig/code/frontend/ims-fe-ssh-dev/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/home/kjokken/mig/code/frontend/ims-fe-ssh-dev/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _defineProperty from \"/home/kjokken/mig/code/frontend/ims-fe-ssh-dev/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { LoadingOutlined } from \"@ant-design/icons\";\nimport moment from \"moment\";\nimport { useRouter } from \"next/router\";\nimport React, { useEffect, useState } from \"react\";\nimport ButtonSys from \"../../../button\";\nimport { CameraIconSvg, EmailIconSvg, FaxIconSvg, NotesIconSvg, PkpIconSvg, RefreshIconSvg, SquarePlusIconSvg, WebIconSvg } from \"../../../icon\";\nimport { DateNotRequired, DateRequired, InputNotRequired, InputRequired, RadioRequired, TreeSelectRequired } from \"../../../input\";\nimport { H2, Label, Text } from \"../../../typography\";\nimport DrawerCore from \"../../drawerCore\";\n\nvar DrawerLokasiClient = function DrawerLokasiClient(_ref) {\n  var title = _ref.title,\n      visible = _ref.visible,\n      onClose = _ref.onClose,\n      children = _ref.children,\n      buttonOkText = _ref.buttonOkText,\n      initProps = _ref.initProps,\n      onvisible = _ref.onvisible,\n      displaydata = _ref.displaydata;\n  var rt = useRouter();\n\n  var _useState = useState({\n    name: \"\",\n    address: \"\",\n    phone_number: \"\",\n    image_logo: \"\",\n    parent_id: null,\n    singkatan: \"\",\n    tanggal_pkp: null,\n    penanggung_jawab: \"\",\n    npwp: \"\",\n    fax: \"\",\n    email: \"\",\n    website: \"\"\n  }),\n      createdata = _useState[0],\n      setcreatedata = _useState[1];\n\n  var _useState2 = useState([]),\n      treedata = _useState2[0],\n      settreedata = _useState2[1];\n\n  var _useState3 = useState(false),\n      lokasiloading = _useState3[0],\n      setlokasiloading = _useState3[1];\n\n  var _useState4 = useState(false),\n      loadingfoto = _useState4[0],\n      setloadingfoto = _useState4[1];\n\n  var _useState5 = useState({\n    email: false,\n    website: false,\n    npwp: false,\n    fax: false,\n    tanggal_pkp: false\n  }),\n      dynamicattr = _useState5[0],\n      setdynamicattr = _useState5[1];\n\n  var _useState6 = useState(true),\n      disabledsave = _useState6[0],\n      setdisabledsave = _useState6[1];\n\n  var _useState7 = useState(-1),\n      disabledtrigger = _useState7[0],\n      setdisabledtrigger = _useState7[1];\n\n  var _useState8 = useState(false),\n      warningphonenumber = _useState8[0],\n      setwarningphonenumber = _useState8[1];\n\n  var _useState9 = useState(false),\n      warningemail = _useState9[0],\n      setwarningemail = _useState9[1];\n\n  var onChangeInput = function onChangeInput(e) {\n    setcreatedata(_objectSpread(_objectSpread({}, createdata), {}, _defineProperty({}, e.target.name, e.target.value)));\n    setdisabledtrigger(function (prev) {\n      return prev + 1;\n    });\n  };\n\n  var onChangeInputNotRequired = function onChangeInputNotRequired(e) {\n    setcreatedata(_objectSpread(_objectSpread({}, createdata), {}, _defineProperty({}, e.target.name, e.target.value)));\n  };\n\n  var onChangeTreeselect = function onChangeTreeselect(value, label, extra) {\n    setcreatedata(_objectSpread(_objectSpread({}, createdata), {}, {\n      parent_id: value\n    }));\n  };\n\n  var onchangeDate = function onchangeDate(date, datestring) {\n    setcreatedata(_objectSpread(_objectSpread({}, createdata), {}, {\n      tanggal_pkp: datestring\n    }));\n  };\n\n  var onChangeGambar = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(e) {\n      var foto, formdata, fetching, datajson;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              setloadingfoto(true);\n              foto = e.target.files;\n              formdata = new FormData();\n              formdata.append(\"file\", foto[0]);\n              formdata.append(\"upload_preset\", \"migsys\");\n              _context.next = 7;\n              return fetch(\"https://api.Cloudinary.com/v1_1/aqlpeduli/image/upload\", {\n                method: \"POST\",\n                body: formdata\n              });\n\n            case 7:\n              fetching = _context.sent;\n              _context.next = 10;\n              return fetching.json();\n\n            case 10:\n              datajson = _context.sent;\n              setcreatedata(_objectSpread(_objectSpread({}, createdata), {}, {\n                image_logo: datajson.secure_url\n              }));\n              setloadingfoto(false);\n\n            case 13:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function onChangeGambar(_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var handleCreateLokasi = function handleCreateLokasi() {\n    if (/(^\\d+$)/.test(createdata.phone_number) === false || /(\\-)|(^(([^<>()[\\]\\\\.,;:\\s@\\\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\\\"]+)*)|(\\\".+\\\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$)/.test(createdata.email) === false) {\n      // console.log(new RegExp(/(^\\d+$)/).test(createdata.phone_number))\n      if (createdata.email === \"\") {\n        setlokasiloading(true);\n        fetch(\"\".concat(process.env.NEXT_PUBLIC_BACKEND_URL, \"/addCompanyClient\"), {\n          method: \"POST\",\n          headers: {\n            Authorization: JSON.parse(initProps),\n            \"Content-Type\": \"application/json\"\n          },\n          body: JSON.stringify(createdata)\n        }).then(function (res) {\n          return res.json();\n        }).then(function (res2) {\n          setlokasiloading(false);\n\n          if (res2.success) {\n            _notification[\"success\"]({\n              message: res2.message,\n              duration: 3\n            });\n\n            setcreatedata({\n              name: \"\",\n              address: \"\",\n              phone_number: \"\",\n              image_logo: \"\",\n              parent_id: null,\n              singkatan: \"\",\n              tanggal_pkp: null,\n              penanggung_jawab: \"\",\n              npwp: \"\",\n              fax: \"\",\n              email: \"\",\n              website: \"\"\n            });\n            setdynamicattr({\n              email: false,\n              website: false,\n              npwp: false,\n              fax: false,\n              tanggal_pkp: false\n            });\n            setwarningphonenumber(false);\n            setwarningemail(false);\n            onvisible(false);\n            rt.push(\"/company/clients/locations?id=\".concat(displaydata.id, \"&company_name=\").concat(displaydata.name));\n          } else {\n            _notification[\"error\"]({\n              message: res2.message,\n              duration: 3\n            });\n          }\n        });\n      } else {\n        new RegExp(/(^\\d+$)/).test(createdata.phone_number) === false ? setwarningphonenumber(true) : setwarningphonenumber(false);\n        new RegExp(/(\\-)|(^(([^<>()[\\]\\\\.,;:\\s@\\\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\\\"]+)*)|(\\\".+\\\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$)/).test(createdata.email) === false ? setwarningemail(true) : setwarningemail(false);\n        setdisabledsave(true);\n      }\n    } else {\n      setlokasiloading(true);\n      fetch(\"\".concat(process.env.NEXT_PUBLIC_BACKEND_URL, \"/addCompanyClient\"), {\n        method: \"POST\",\n        headers: {\n          Authorization: JSON.parse(initProps),\n          \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify(createdata)\n      }).then(function (res) {\n        return res.json();\n      }).then(function (res2) {\n        setlokasiloading(false);\n\n        if (res2.success) {\n          _notification[\"success\"]({\n            message: res2.message,\n            duration: 3\n          });\n\n          setcreatedata({\n            name: \"\",\n            address: \"\",\n            phone_number: \"\",\n            image_logo: \"\",\n            parent_id: null,\n            singkatan: \"\",\n            tanggal_pkp: null,\n            penanggung_jawab: \"\",\n            npwp: \"\",\n            fax: \"\",\n            email: \"\",\n            website: \"\"\n          });\n          setdynamicattr({\n            email: false,\n            website: false,\n            npwp: false,\n            fax: false,\n            tanggal_pkp: false\n          });\n          setwarningphonenumber(false);\n          setwarningemail(false);\n          onvisible(false);\n          rt.push(\"/company/clients/locations?id=\".concat(displaydata.id, \"&company_name=\").concat(displaydata.name));\n        } else {\n          _notification[\"error\"]({\n            message: res2.message,\n            duration: 3\n          });\n        }\n      });\n    }\n  };\n\n  useEffect(function () {\n    fetch(\"\".concat(process.env.NEXT_PUBLIC_BACKEND_URL, \"/getClientCompanyList\"), {\n      method: \"GET\",\n      headers: {\n        Authorization: JSON.parse(initProps)\n      }\n    }).then(function (res) {\n      return res.json();\n    }).then(function (res2) {\n      settreedata([res2.data]);\n    });\n  }, [lokasiloading]);\n  useEffect(function () {\n    if (disabledtrigger !== -1) {\n      if (createdata.parent_id !== null && createdata.name !== \"\" && createdata.address !== \"\" && createdata.phone_number !== \"\" && createdata.penanggung_jawab !== \"\") {\n        setdisabledsave(false);\n      } else {\n        setdisabledsave(true);\n      }\n    }\n  }, [disabledtrigger]);\n  return /*#__PURE__*/_jsx(DrawerCore, {\n    title: title,\n    visible: visible,\n    onClose: function onClose() {\n      setcreatedata({\n        name: \"\",\n        address: \"\",\n        phone_number: \"\",\n        image_logo: \"\",\n        parent_id: null,\n        singkatan: \"\",\n        tanggal_pkp: null,\n        penanggung_jawab: \"\",\n        npwp: \"\",\n        fax: \"\",\n        email: \"\",\n        website: \"\"\n      });\n      setdynamicattr({\n        email: false,\n        website: false,\n        npwp: false,\n        fax: false,\n        tanggal_pkp: false\n      });\n      setwarningphonenumber(false);\n      setwarningemail(false);\n      setdisabledsave(true);\n      onvisible(false);\n    },\n    buttonOkText: buttonOkText,\n    onClick: handleCreateLokasi,\n    disabled: disabledsave,\n    children: /*#__PURE__*/_jsx(_Spin, {\n      spinning: lokasiloading,\n      children: /*#__PURE__*/_jsxs(\"div\", {\n        className: \"flex flex-col\",\n        children: [/*#__PURE__*/_jsx(\"div\", {\n          className: \"mb-8\",\n          children: /*#__PURE__*/_jsx(\"p\", {\n            className: \"mb-0 text-red-500 text-xs italic\",\n            children: \"*Informasi ini harus diisi\"\n          })\n        }), /*#__PURE__*/_jsxs(\"div\", {\n          className: \"mb-5 flex\",\n          children: [/*#__PURE__*/_jsx(\"div\", {\n            className: \"mr-2\",\n            children: createdata.image_logo === \"\" ? /*#__PURE__*/_jsx(\"div\", {\n              className: \"w-20 h-20 rounded-full bg-gray-400 flex justify-center items-center\",\n              children: /*#__PURE__*/_jsx(CameraIconSvg, {\n                size: 20,\n                color: \"#ffffff\"\n              })\n            }) : /*#__PURE__*/_jsx(\"img\", {\n              src: createdata.image_logo,\n              className: \"object-contain w-20 h-20 rounded-full\",\n              alt: \"\"\n            })\n          }), /*#__PURE__*/_jsxs(\"div\", {\n            className: \"flex flex-col w-9/12 px-3\",\n            children: [/*#__PURE__*/_jsx(\"div\", {\n              className: \"mb-5\",\n              children: /*#__PURE__*/_jsx(Text, {\n                children: \"Unggah gambar JPG/PNG dari komputer Anda (Max. 5 MB)\"\n              })\n            }), /*#__PURE__*/_jsx(\"div\", {\n              className: \"flex justify-end items-end\",\n              children: /*#__PURE__*/_jsxs(ButtonSys, {\n                type: \"primaryInput\",\n                onChangeGambar: onChangeGambar,\n                children: [loadingfoto ? /*#__PURE__*/_jsx(LoadingOutlined, {\n                  style: {\n                    marginRight: \"0.5rem\"\n                  }\n                }) : /*#__PURE__*/_jsx(RefreshIconSvg, {\n                  size: 15,\n                  color: \"#ffffff\"\n                }), \"Atur Ulang\"]\n              })\n            })]\n          })]\n        }), /*#__PURE__*/_jsxs(\"div\", {\n          className: \"flex flex-col mb-5\",\n          children: [/*#__PURE__*/_jsx(TreeSelectRequired, {\n            name: \"parent_id\",\n            onChangeTreeselect: onChangeTreeselect,\n            label: \"Induk Lokasi\",\n            treeData: treedata\n          }), /*#__PURE__*/_jsx(InputRequired, {\n            name: \"name\",\n            onChangeInput: onChangeInput,\n            label: \"Nama Lokasi\"\n          }), /*#__PURE__*/_jsx(InputRequired, {\n            name: \"address\",\n            onChangeInput: onChangeInput,\n            label: \"Alamat Lokasi\"\n          }), /*#__PURE__*/_jsx(InputRequired, {\n            name: \"phone_number\",\n            onChangeInput: onChangeInput,\n            label: \"Nomor Telepon\"\n          }), warningphonenumber && /*#__PURE__*/_jsx(\"p\", {\n            className: \" text-red-500 text-sm mb-3 -mt-3 mx-3\",\n            children: \"Nomor Telepon harus angka\"\n          }), /*#__PURE__*/_jsx(InputRequired, {\n            name: \"penanggung_jawab\",\n            onChangeInput: onChangeInput,\n            label: \"Penanggung Jawab (PIC)\"\n          }), dynamicattr.email && /*#__PURE__*/_jsxs(_Fragment, {\n            children: [/*#__PURE__*/_jsx(InputNotRequired, {\n              name: \"email\",\n              onChangeInput: onChangeInputNotRequired,\n              label: \"Email\"\n            }), warningemail && /*#__PURE__*/_jsx(\"p\", {\n              className: \" text-red-500 text-sm mb-3 -mt-3 mx-3\",\n              children: \"Email belum diisi dengan benar\"\n            })]\n          }), dynamicattr.website && /*#__PURE__*/_jsx(InputNotRequired, {\n            name: \"website\",\n            onChangeInput: onChangeInputNotRequired,\n            label: \"Website\"\n          }), dynamicattr.npwp && /*#__PURE__*/_jsx(InputNotRequired, {\n            name: \"npwp\",\n            onChangeInput: onChangeInputNotRequired,\n            label: \"NPWP\"\n          }), dynamicattr.fax && /*#__PURE__*/_jsx(InputNotRequired, {\n            name: \"fax\",\n            onChangeInput: onChangeInputNotRequired,\n            label: \"Fax\"\n          }), dynamicattr.tanggal_pkp && /*#__PURE__*/_jsx(DateNotRequired, {\n            name: \"tanggal_pkp\",\n            onChangeDate: onchangeDate,\n            label: \"Tanggal PKP\",\n            defaultValue: createdata.tanggal_pkp === null ? null : moment(createdata.tanggal_pkp)\n          })]\n        }), /*#__PURE__*/_jsxs(\"div\", {\n          className: \"mb-5 flex flex-col\",\n          children: [/*#__PURE__*/_jsx(\"div\", {\n            className: \"mb-3\",\n            children: /*#__PURE__*/_jsx(Label, {\n              children: \"Informasi Tambahan\"\n            })\n          }), !dynamicattr.email && /*#__PURE__*/_jsxs(\"div\", {\n            className: \"flex justify-between mb-3\",\n            children: [/*#__PURE__*/_jsxs(\"div\", {\n              className: \"flex items-center\",\n              children: [/*#__PURE__*/_jsx(\"div\", {\n                className: \"mr-2\",\n                children: /*#__PURE__*/_jsx(EmailIconSvg, {\n                  size: 18,\n                  color: \"#808080\"\n                })\n              }), \"Email\"]\n            }), /*#__PURE__*/_jsx(\"div\", {\n              className: \"cursor-pointer\",\n              onClick: function onClick() {\n                setdynamicattr(_objectSpread(_objectSpread({}, dynamicattr), {}, {\n                  email: true\n                }));\n              },\n              children: /*#__PURE__*/_jsx(SquarePlusIconSvg, {\n                size: 18,\n                color: \"#808080\"\n              })\n            })]\n          }), !dynamicattr.website && /*#__PURE__*/_jsxs(\"div\", {\n            className: \"flex justify-between mb-3\",\n            children: [/*#__PURE__*/_jsxs(\"div\", {\n              className: \"flex items-center\",\n              children: [/*#__PURE__*/_jsx(\"div\", {\n                className: \"mr-2\",\n                children: /*#__PURE__*/_jsx(WebIconSvg, {\n                  size: 18,\n                  color: \"#808080\"\n                })\n              }), \"Website\"]\n            }), /*#__PURE__*/_jsx(\"div\", {\n              className: \"cursor-pointer\",\n              onClick: function onClick() {\n                setdynamicattr(_objectSpread(_objectSpread({}, dynamicattr), {}, {\n                  website: true\n                }));\n              },\n              children: /*#__PURE__*/_jsx(SquarePlusIconSvg, {\n                size: 18,\n                color: \"#808080\"\n              })\n            })]\n          }), !dynamicattr.npwp && /*#__PURE__*/_jsxs(\"div\", {\n            className: \"flex justify-between mb-3\",\n            children: [/*#__PURE__*/_jsxs(\"div\", {\n              className: \"flex items-center\",\n              children: [/*#__PURE__*/_jsx(\"div\", {\n                className: \"mr-2\",\n                children: /*#__PURE__*/_jsx(NotesIconSvg, {\n                  size: 18,\n                  color: \"#808080\"\n                })\n              }), \"NPWP\"]\n            }), /*#__PURE__*/_jsx(\"div\", {\n              className: \"cursor-pointer\",\n              onClick: function onClick() {\n                setdynamicattr(_objectSpread(_objectSpread({}, dynamicattr), {}, {\n                  npwp: true\n                }));\n              },\n              children: /*#__PURE__*/_jsx(SquarePlusIconSvg, {\n                size: 18,\n                color: \"#808080\"\n              })\n            })]\n          }), !dynamicattr.fax && /*#__PURE__*/_jsxs(\"div\", {\n            className: \"flex justify-between mb-3\",\n            children: [/*#__PURE__*/_jsxs(\"div\", {\n              className: \"flex items-center\",\n              children: [/*#__PURE__*/_jsx(\"div\", {\n                className: \"mr-2\",\n                children: /*#__PURE__*/_jsx(FaxIconSvg, {\n                  size: 18,\n                  color: \"#808080\"\n                })\n              }), \"Fax\"]\n            }), /*#__PURE__*/_jsx(\"div\", {\n              className: \"cursor-pointer\",\n              onClick: function onClick() {\n                setdynamicattr(_objectSpread(_objectSpread({}, dynamicattr), {}, {\n                  fax: true\n                }));\n              },\n              children: /*#__PURE__*/_jsx(SquarePlusIconSvg, {\n                size: 18,\n                color: \"#808080\"\n              })\n            })]\n          }), !dynamicattr.tanggal_pkp && /*#__PURE__*/_jsxs(\"div\", {\n            className: \"flex justify-between mb-3\",\n            children: [/*#__PURE__*/_jsxs(\"div\", {\n              className: \"flex items-center\",\n              children: [/*#__PURE__*/_jsx(\"div\", {\n                className: \"mr-2\",\n                children: /*#__PURE__*/_jsx(PkpIconSvg, {\n                  size: 18,\n                  color: \"#808080\"\n                })\n              }), \"Tanggal PKP\"]\n            }), /*#__PURE__*/_jsx(\"div\", {\n              className: \"cursor-pointer\",\n              onClick: function onClick() {\n                setdynamicattr(_objectSpread(_objectSpread({}, dynamicattr), {}, {\n                  tanggal_pkp: true\n                }));\n              },\n              children: /*#__PURE__*/_jsx(SquarePlusIconSvg, {\n                size: 18,\n                color: \"#808080\"\n              })\n            })]\n          })]\n        })]\n      })\n    })\n  });\n};\n\nexport default DrawerLokasiClient;","map":null,"metadata":{},"sourceType":"module"}