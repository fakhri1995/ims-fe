{"ast":null,"code":"import _Input from \"antd/lib/input\";\nimport _Popover from \"antd/lib/popover\";\nimport _notification from \"antd/lib/notification\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { ExclamationCircleOutlined, SearchOutlined } from \"@ant-design/icons\";\nimport Link from \"next/link\";\nimport { useRouter } from \"next/router\";\nimport { useEffect, useRef, useState } from \"react\";\nimport { Bar, Doughnut, Line } from \"react-chartjs-2\";\nimport ButtonSys from \"../../../components/button\";\nimport DrawerTicketTypeCreate from \"../../../components/drawer/tickets/drawerTicketTypeCreate\";\nimport DrawerTicketTypeUpdate from \"../../../components/drawer/tickets/drawerTicketTypeUpdate\";\nimport { AlerttriangleIconSvg, EditIconSvg, MappinIconSvg } from \"../../../components/icon\";\nimport { BackIconSvg, FilePlusIconSvg, TrashIconSvg } from \"../../../components/icon\";\nimport st from \"../../../components/layout-dashboard.module.css\";\nimport Layout from \"../../../components/layout-dashboardNew\";\nimport { ModalHapusTipeTiket } from \"../../../components/modal/modalCustom\";\nimport { TableCustomTicketTypes } from \"../../../components/table/tableCustom\";\nimport { H1, H2, Label, Text } from \"../../../components/typography\";\nimport { ArcElement, BarElement, CategoryScale, Chart, LineElement, LinearScale, PointElement, Tooltip } from \"chart.js\";\nimport httpcookie from \"cookie\";\nChart.register(ArcElement, Tooltip, CategoryScale, LinearScale, LineElement, BarElement, PointElement);\n\nconst TicketTypes = ({\n  dataProfile,\n  sidemenu,\n  initProps\n}) => {\n  //1.Init\n  const rt = useRouter();\n  const pathArr = rt.pathname.split(\"/\").slice(1);\n  pathArr.splice(1, 2);\n  pathArr.push(`Tipe Task Tiket`); //2.Use State\n  //TICKET TYPES\n\n  const {\n    0: datarawtickettypes,\n    1: setdatarawtickettypes\n  } = useState({\n    current_page: \"\",\n    data: [],\n    first_page_url: \"\",\n    from: null,\n    last_page: null,\n    last_page_url: \"\",\n    next_page_url: \"\",\n    path: \"\",\n    per_page: null,\n    prev_page_url: null,\n    to: null,\n    total: null\n  });\n  const {\n    0: datatickettypes,\n    1: setdatatickettypes\n  } = useState([]);\n  const {\n    0: loadingtickettypes,\n    1: setloadingtickettypes\n  } = useState(false);\n  const {\n    0: pagetickettypes,\n    1: setpagetickettypes\n  } = useState(1);\n  const {\n    0: rowstickettypes,\n    1: setrowstickettypes\n  } = useState(10);\n  const {\n    0: sortingtickettypes,\n    1: setsortingtickettypes\n  } = useState({\n    sort_by: \"\",\n    sort_type: \"\"\n  });\n  const {\n    0: searcingtickettypes,\n    1: setsearcingtickettypes\n  } = useState(\"\");\n  const {\n    0: datafiltertiickettypes,\n    1: setdatafiltertiickettypes\n  } = useState([]); //create - ticket types\n\n  const {\n    0: drawertickettypescreate,\n    1: setdrawertickettypescreate\n  } = useState(false);\n  const {\n    0: loadingtickettypescreate,\n    1: setloadingtickettypescreate\n  } = useState(false);\n  const {\n    0: refreshtickettypescreate,\n    1: setrefreshtickettypescreate\n  } = useState(-1); //update - ticket types\n\n  const {\n    0: drawertickettypesupdate,\n    1: setdrawertickettypesupdate\n  } = useState(false);\n  const {\n    0: loadingtickettypesupdate,\n    1: setloadingtickettypesupdate\n  } = useState(false);\n  const {\n    0: refreshtickettypesupdate,\n    1: setrefreshtickettypesupdate\n  } = useState(-1);\n  const {\n    0: disabledupdate,\n    1: setdisabledupdate\n  } = useState(false);\n  const {\n    0: datapayloadtickettype,\n    1: setdatapayloadtickettype\n  } = useState({\n    id: null,\n    name: \"\",\n    description: \"\",\n    ticket_type_id: 1,\n    task_type_id: null\n  }); //delete - ticket types\n\n  const {\n    0: datatickettypesdelete,\n    1: setdatatickettypesdelete\n  } = useState({\n    id: null,\n    name: \"\"\n  });\n  const {\n    0: modaltickettypesdelete,\n    1: setmodaltickettypesdelete\n  } = useState(false);\n  const {\n    0: loadingtickettypesdelete,\n    1: setloadingtickettypesdelete\n  } = useState(false);\n  const {\n    0: refreshcreatetickettypesdelete,\n    1: setrefreshcreatetickettypesdelete\n  } = useState(-1);\n  const {\n    0: coloricondeletehover,\n    1: setcoloricondeletehover\n  } = useState(0); //2. Column Table\n\n  const columnsTicketTypes = [{\n    title: \"No\",\n    dataIndex: \"num\",\n    render: (text, record, index) => {\n      return {\n        children: /*#__PURE__*/_jsx(_Fragment, {\n          children: datarawtickettypes.from + index\n        })\n      };\n    }\n  }, {\n    title: \"Tipe Tiket\",\n    dataIndex: \"ticket_type_name\",\n    render: (text, record, index) => {\n      return {\n        children: /*#__PURE__*/_jsx(_Fragment, {\n          children: record.ticket_type_name\n        })\n      };\n    },\n    sorter: (a, b) => a.name.localeCompare(b.name)\n  }, {\n    title: \"Nama\",\n    dataIndex: \"name\",\n    render: (text, record, index) => {\n      return {\n        children: /*#__PURE__*/_jsx(_Fragment, {\n          children: record.name\n        })\n      };\n    },\n    sorter: (a, b) => a.name.localeCompare(b.name)\n  }, {\n    title: \"Tipe Task\",\n    dataIndex: \"task_type_name\",\n    render: (text, record, index) => {\n      return {\n        children: /*#__PURE__*/_jsx(_Fragment, {\n          children: record.task_type_name\n        })\n      };\n    },\n    sorter: (a, b) => a.name.localeCompare(b.name)\n  }, {\n    title: \"Deskripsi\",\n    dataIndex: \"description\",\n    render: (text, record, index) => {\n      return {\n        children: /*#__PURE__*/_jsx(\"p\", {\n          className: \" line-clamp-3\",\n          children: record.description === \"\" || record.description === \"-\" ? `-` : record.description\n        })\n      };\n    }\n  }, {\n    title: \"\\xa0\\xa0\\xa0\\xa0\\xa0\\xa0\\xa0\\xa0\\xa0\\xa0\\xa0\\xa0\\xa0\\xa0\\xa0\\xa0\\xa0\\xa0\\xa0\\xa0\\xa0\\xa0\\xa0\\xa0\\xa0\\xa0\",\n    dataIndex: \"actions\",\n    align: `center`,\n    render: (text, record, index) => {\n      return {\n        children: /*#__PURE__*/_jsxs(\"div\", {\n          className: \" flex justify-center\",\n          children: [/*#__PURE__*/_jsx(\"div\", {\n            className: \"mx-1\",\n            children: /*#__PURE__*/_jsx(ButtonSys, {\n              type: \"default\",\n              onClick: () => {\n                setdatapayloadtickettype({\n                  id: Number(record.id),\n                  name: record.name,\n                  description: record.description,\n                  ticket_type_id: record.ticket_type_id,\n                  task_type_id: record.task_type_id\n                });\n                setdrawertickettypesupdate(true);\n              },\n              children: /*#__PURE__*/_jsx(EditIconSvg, {\n                size: 15,\n                color: `#35763B`\n              })\n            })\n          }), /*#__PURE__*/_jsx(\"div\", {\n            className: \"mx-1\",\n            children: /*#__PURE__*/_jsx(ButtonSys, {\n              type: \"default\",\n              color: \"danger\",\n              onClick: () => {\n                setdatatickettypesdelete({\n                  id: record.id,\n                  name: record.name\n                });\n                setmodaltickettypesdelete(true);\n              },\n              children: /*#__PURE__*/_jsx(TrashIconSvg, {\n                size: 15,\n                color: `#BF4A40`\n              })\n            })\n          })]\n        })\n      };\n    }\n  }]; //3. Handler\n\n  const handleDeleteTipeTiket = () => {\n    setloadingtickettypesdelete(true);\n    fetch(`${process.env.NEXT_PUBLIC_BACKEND_URL}/deleteTicketTaskType`, {\n      method: \"DELETE\",\n      headers: {\n        Authorization: JSON.parse(initProps),\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify({\n        id: datatickettypesdelete.id\n      })\n    }).then(res => res.json()).then(res2 => {\n      setloadingtickettypesdelete(false);\n\n      if (res2.success) {\n        setrefreshcreatetickettypesdelete(prev => prev + 1);\n        setmodaltickettypesdelete(false);\n\n        _notification[\"success\"]({\n          message: res2.message,\n          duration: 3\n        });\n      } else {\n        _notification[\"error\"]({\n          message: res2.message,\n          duration: 3\n        });\n      }\n    });\n  }; //4.Use Effect\n\n\n  useEffect(() => {\n    setloadingtickettypes(true);\n    fetch(`${process.env.NEXT_PUBLIC_BACKEND_URL}/getTicketTaskTypes?page=${pagetickettypes}&rows=${rowstickettypes}&keyword=${searcingtickettypes}&sort_by=${sortingtickettypes.sort_by}&sort_type=${sortingtickettypes.sort_type}`, {\n      method: `GET`,\n      headers: {\n        Authorization: JSON.parse(initProps)\n      }\n    }).then(res => res.json()).then(res2 => {\n      setdatarawtickettypes(res2.data);\n      setdatatickettypes(res2.data.data);\n      setdatafiltertiickettypes(res2.data.data);\n      setdisabledupdate(false);\n      setloadingtickettypes(false);\n    });\n  }, [refreshtickettypescreate, refreshcreatetickettypesdelete]);\n  return /*#__PURE__*/_jsxs(Layout, {\n    dataProfile: dataProfile,\n    sidemenu: sidemenu,\n    tok: initProps,\n    st: st,\n    pathArr: pathArr,\n    children: [/*#__PURE__*/_jsx(\"div\", {\n      className: \" flex flex-col px-5\",\n      children: /*#__PURE__*/_jsxs(\"div\", {\n        className: \"flex flex-col shadow-md rounded-lg bg-white p-5 mb-6 mx-3\",\n        children: [/*#__PURE__*/_jsxs(\"div\", {\n          className: \"flex justify-between items-center mb-5\",\n          children: [/*#__PURE__*/_jsxs(\"div\", {\n            className: \"flex items-center\",\n            children: [/*#__PURE__*/_jsx(\"div\", {\n              className: \"mr-2 cursor-pointer flex items-center\",\n              onClick: () => {\n                rt.push(`/tickets`);\n              },\n              children: /*#__PURE__*/_jsx(BackIconSvg, {\n                size: 15,\n                color: `#000000`\n              })\n            }), /*#__PURE__*/_jsx(\"div\", {\n              className: \" mr-2 flex items-center\",\n              children: /*#__PURE__*/_jsx(H1, {\n                children: \"Atur Tiket\"\n              })\n            }), /*#__PURE__*/_jsx(\"div\", {\n              className: \" flex items-center\",\n              children: /*#__PURE__*/_jsx(_Popover, {\n                placement: \"right\",\n                content: /*#__PURE__*/_jsxs(\"div\", {\n                  className: \" flex\",\n                  children: [/*#__PURE__*/_jsx(\"div\", {\n                    className: \" mr-2 h-full flex items-center\",\n                    children: /*#__PURE__*/_jsx(ExclamationCircleOutlined, {\n                      style: {\n                        color: `red`\n                      }\n                    })\n                  }), /*#__PURE__*/_jsxs(\"div\", {\n                    className: \" flex flex-col\",\n                    children: [/*#__PURE__*/_jsx(\"div\", {\n                      className: \" mb-2\",\n                      children: /*#__PURE__*/_jsx(Label, {\n                        children: \"Halaman ini berisi daftar tiket dan task yang akan dijalankan berdasarkan tiket tersebut.\"\n                      })\n                    }), /*#__PURE__*/_jsx(\"div\", {\n                      children: /*#__PURE__*/_jsxs(Label, {\n                        children: [/*#__PURE__*/_jsx(\"strong\", {\n                          children: \"PENTING:\"\n                        }), \" Perubahan yang dilakukan akan mengubah seluruh alur task yang sedang berjalan\"]\n                      })\n                    })]\n                  })]\n                }),\n                children: /*#__PURE__*/_jsx(ExclamationCircleOutlined, {\n                  style: {\n                    color: `gray`\n                  }\n                })\n              })\n            })]\n          }), /*#__PURE__*/_jsxs(\"div\", {\n            className: \"w-8/12 flex justify-end\",\n            children: [/*#__PURE__*/_jsx(\"div\", {\n              className: \" mx-2\",\n              children: /*#__PURE__*/_jsxs(ButtonSys, {\n                type: \"primary\",\n                onClick: () => {\n                  setdrawertickettypescreate(true);\n                },\n                children: [/*#__PURE__*/_jsx(\"div\", {\n                  className: \" mr-1\",\n                  children: /*#__PURE__*/_jsx(FilePlusIconSvg, {\n                    size: 15,\n                    color: `#ffffff`\n                  })\n                }), \"Tambah Pengaturan\"]\n              })\n            }), /*#__PURE__*/_jsx(\"div\", {\n              className: \"mx-2\",\n              children: /*#__PURE__*/_jsx(_Input, {\n                style: {\n                  width: `20rem`\n                },\n                placeholder: \"Nama tipe task..\",\n                allowClear: true,\n                onChange: e => {\n                  setsearcingtickettypes(e.target.value);\n                  setloadingtickettypes(true);\n                  fetch(`${process.env.NEXT_PUBLIC_BACKEND_URL}/getTicketTaskTypes?page=${pagetickettypes}&rows=${rowstickettypes}&keyword=${e.target.value}&sort_by=${sortingtickettypes.sort_by}&sort_type=${sortingtickettypes.sort_type}`, {\n                    method: `GET`,\n                    headers: {\n                      Authorization: JSON.parse(initProps)\n                    }\n                  }).then(res => res.json()).then(res2 => {\n                    setdatarawtickettypes(res2.data);\n                    setdatatickettypes(res2.data.data);\n                    setloadingtickettypes(false);\n                  });\n                }\n              })\n            })]\n          })]\n        }), /*#__PURE__*/_jsx(\"div\", {\n          children: /*#__PURE__*/_jsx(TableCustomTicketTypes, {\n            dataSource: datatickettypes,\n            setDataSource: setdatatickettypes,\n            columns: columnsTicketTypes,\n            loading: loadingtickettypes,\n            setpraloading: setloadingtickettypes,\n            pageSize: rowstickettypes,\n            total: datarawtickettypes.total,\n            initProps: initProps,\n            setpage: setpagetickettypes,\n            pagefromsearch: pagetickettypes,\n            setdataraw: setdatarawtickettypes,\n            setsorting: setsortingtickettypes,\n            sorting: sortingtickettypes,\n            searching: searcingtickettypes\n          })\n        })]\n      })\n    }), /*#__PURE__*/_jsx(DrawerTicketTypeCreate, {\n      title: \"Pengaturan Baru\",\n      visible: drawertickettypescreate,\n      onClose: () => {\n        setdrawertickettypescreate(false);\n      },\n      buttonOkText: \"Simpan Pengaturan\",\n      initProps: initProps,\n      onvisible: setdrawertickettypescreate,\n      refreshtickettypescreate: refreshtickettypescreate,\n      setrefreshtickettypescreate: setrefreshtickettypescreate\n    }), /*#__PURE__*/_jsx(DrawerTicketTypeUpdate, {\n      title: \"Ubah Pengaturan\",\n      visible: drawertickettypesupdate,\n      onClose: () => {\n        setdrawertickettypesupdate(false);\n      },\n      buttonOkText: \"Simpan Pengaturan\",\n      initProps: initProps,\n      onvisible: setdrawertickettypesupdate,\n      refresh: refreshtickettypesupdate,\n      setrefresh: setrefreshtickettypesupdate,\n      datapayload: datapayloadtickettype,\n      setdatapayload: setdatapayloadtickettype,\n      disabledsubmit: disabledupdate,\n      setdisabledsubmit: setdisabledupdate\n    }), /*#__PURE__*/_jsx(ModalHapusTipeTiket, {\n      title: \"Konfirmasi Hapus Pengaturan\",\n      visible: modaltickettypesdelete,\n      onvisible: setmodaltickettypesdelete,\n      onCancel: () => {\n        setmodaltickettypesdelete(false);\n      },\n      loading: loadingtickettypesdelete,\n      datadelete: datatickettypesdelete,\n      onOk: handleDeleteTipeTiket\n    })]\n  });\n};\n\nexport async function getServerSideProps({\n  req,\n  res\n}) {\n  var initProps = {};\n\n  if (!req.headers.cookie) {\n    return {\n      redirect: {\n        permanent: false,\n        destination: \"/login\"\n      }\n    };\n  }\n\n  const cookiesJSON1 = httpcookie.parse(req.headers.cookie);\n\n  if (!cookiesJSON1.token) {\n    return {\n      redirect: {\n        permanent: false,\n        destination: \"/login\"\n      }\n    };\n  }\n\n  initProps = cookiesJSON1.token;\n  const resourcesGP = await fetch(`${process.env.NEXT_PUBLIC_BACKEND_URL}/detailProfile`, {\n    method: `GET`,\n    headers: {\n      Authorization: JSON.parse(initProps)\n    }\n  });\n  const resjsonGP = await resourcesGP.json();\n  const dataProfile = resjsonGP; // if (![107, 108, 109, 110, 111, 112, 132].every((curr) => dataProfile.data.registered_feature.includes(curr))) {\n  //     res.writeHead(302, { Location: '/dashboard/admin' })\n  //     res.end()\n  // }\n\n  return {\n    props: {\n      initProps,\n      dataProfile,\n      sidemenu: \"2\"\n    }\n  };\n}\nexport default TicketTypes;","map":null,"metadata":{},"sourceType":"module"}