{"ast":null,"code":"import _Modal from \"antd/lib/modal\";\nimport _Table from \"antd/lib/table\";\nimport _Form from \"antd/lib/form\";\nimport _Input from \"antd/lib/input\";\nimport _notification from \"antd/lib/notification\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport _Button from \"antd/lib/button\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport _Select from \"antd/lib/select\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport { useRouter } from 'next/router';\nimport { useState } from 'react';\nimport httpcookie from 'cookie';\nimport { PlusCircleTwoTone, EditOutlined, DeleteOutlined } from '@ant-design/icons';\nimport Link from 'next/link';\nimport Layout from '../../../components/layout-dashboard';\nimport st from '../../../components/layout-dashboard.module.css';\n\nfunction Financial({\n  initProps,\n  dataProfile,\n  dataGetDepreciations,\n  sidemenu\n}) {\n  const rt = useRouter();\n  const pathArr = rt.pathname.split(\"/\").slice(1);\n  const {\n    Option\n  } = _Select; //data Table\n\n  const columns = [{\n    title: 'Nama',\n    dataIndex: 'nama',\n    key: 'nama',\n    render: (text, record, index) => {\n      return {\n        props: {\n          style: {\n            backgroundColor: index % 2 == 1 ? '#f2f2f2' : '#fff'\n          }\n        },\n        children: /*#__PURE__*/_jsx(_Fragment, {\n          children: record.nama\n        })\n      };\n    }\n  }, {\n    title: 'Tipe',\n    dataIndex: 'jenis',\n    key: 'jenis',\n    render: (text, record, index) => {\n      return {\n        props: {\n          style: {\n            backgroundColor: index % 2 == 1 ? '#f2f2f2' : '#fff'\n          }\n        },\n        children: /*#__PURE__*/_jsx(_Fragment, {\n          children: record.jenis\n        })\n      };\n    }\n  }, {\n    title: 'Tahun Penggunaan',\n    dataIndex: 'tahun_penggunaan',\n    key: 'tahun_penggunaan',\n    align: 'center',\n    render: (text, record, index) => {\n      return {\n        props: {\n          style: {\n            backgroundColor: index % 2 == 1 ? '#f2f2f2' : '#fff'\n          }\n        },\n        children: /*#__PURE__*/_jsx(\"div\", {\n          className: \"flex justify-center\",\n          children: text\n        })\n      };\n    }\n  }, {\n    title: 'Deskripsi',\n    dataIndex: 'deskripsi',\n    key: 'deskripsi',\n    render: (text, record, index) => {\n      return {\n        props: {\n          style: {\n            backgroundColor: index % 2 == 1 ? '#f2f2f2' : '#fff'\n          }\n        },\n        children: /*#__PURE__*/_jsx(_Fragment, {\n          children: record.deskripsi\n        })\n      };\n    }\n  }, {\n    dataIndex: 'status',\n    key: 'status',\n    render: (text, record, index) => {\n      return {\n        props: {\n          style: {\n            backgroundColor: index % 2 == 1 ? '#f2f2f2' : '#fff'\n          }\n        },\n        children: /*#__PURE__*/_jsxs(\"div\", {\n          className: \" flex\",\n          children: [[171].every(curr => dataProfile.data.registered_feature.includes(curr)) && /*#__PURE__*/_jsx(_Button, {\n            onClick: () => {\n              setdataedit({\n                id: record.id,\n                nama: record.nama,\n                jenis: record.jenis,\n                tahun_penggunaan: record.tahun_penggunaan,\n                deskripsi: record.deskripsi\n              });\n              setmodaledit(true);\n            },\n            style: {\n              paddingTop: `0`,\n              paddingBottom: `0.3rem`,\n              marginRight: `1rem`\n            },\n            children: /*#__PURE__*/_jsx(EditOutlined, {})\n          }), [172].every(curr => dataProfile.data.registered_feature.includes(curr)) && /*#__PURE__*/_jsx(_Button, {\n            danger: true,\n            onClick: () => {\n              setmodaldelete(true);\n              setiddelete(record.id);\n            },\n            loading: loadingdelete,\n            style: {\n              paddingTop: `0`,\n              paddingBottom: `0.3rem`\n            },\n            children: /*#__PURE__*/_jsx(DeleteOutlined, {})\n          })]\n        })\n      };\n    }\n  }];\n  const dataListDepreciationsMap = dataGetDepreciations.data.map((doc, idx) => {\n    return {\n      id: doc.id,\n      nama: doc.nama,\n      jenis: doc.jenis,\n      tahun_penggunaan: doc.tahun_penggunaan,\n      deskripsi: doc.deskripsi\n    };\n  }); //useState\n\n  const {\n    0: recordrow,\n    1: setrecordrow\n  } = useState({});\n  const {\n    0: datacreate,\n    1: setdatacreate\n  } = useState({\n    nama: '',\n    jenis: '',\n    tahun_penggunaan: 0,\n    deskripsi: ''\n  });\n  const {\n    0: dataedit,\n    1: setdataedit\n  } = useState({\n    id: recordrow.id,\n    nama: recordrow.nama,\n    jenis: recordrow.jenis,\n    tahun_penggunaan: recordrow.tahun_penggunaan,\n    deskripsi: recordrow.deskripsi\n  });\n  var datacell = [];\n\n  for (var i = 0; i < dataGetDepreciations.data.length; i++) {\n    datacell.push(false);\n  }\n\n  const {\n    0: tambahbtn,\n    1: settambahbtn\n  } = useState(true);\n  const {\n    0: hoverbtn,\n    1: sethoverbtn\n  } = useState(datacell);\n  const {\n    0: editarea,\n    1: seteditarea\n  } = useState(datacell);\n  const {\n    0: iddelete,\n    1: setiddelete\n  } = useState(0);\n  const {\n    0: loadingcreate,\n    1: setloadingcreate\n  } = useState(false);\n  const {\n    0: loadingdelete,\n    1: setloadingdelete\n  } = useState(false);\n  const {\n    0: loadingedit,\n    1: setloadingedit\n  } = useState(false);\n  const {\n    0: modaldelete,\n    1: setmodaldelete\n  } = useState(false);\n  const {\n    0: modaledit,\n    1: setmodaledit\n  } = useState(false); //events\n\n  const onHoverCell = (e, idx) => {\n    console.log(\"over:\" + idx + hoverbtn[idx]);\n    const temp = hoverbtn;\n    temp[idx] = true;\n    sethoverbtn(temp);\n  };\n\n  const onLeaveCell = (e, idx) => {\n    console.log(\"leave:\" + idx + hoverbtn[idx]);\n    const temp = hoverbtn;\n    temp[idx] = false;\n    sethoverbtn(temp);\n  };\n\n  const onChangeCreate = e => {\n    setdatacreate(_objectSpread(_objectSpread({}, datacreate), {}, {\n      [e.target.name]: e.target.value\n    }));\n  };\n\n  const onChangeEdit = e => {\n    setdataedit(_objectSpread(_objectSpread({}, dataedit), {}, {\n      [e.target.name]: e.target.value\n    }));\n  }; //handler\n\n\n  const handleCancelUpdate = index => {\n    var temp = editarea;\n    temp[index] = false;\n    seteditarea(temp);\n    console.log(\"cancel \" + editarea[index]);\n  };\n\n  const handleCreate = () => {\n    setloadingcreate(true);\n    fetch(`https://boiling-thicket-46501.herokuapp.com/addDepreciation`, {\n      method: 'POST',\n      headers: {\n        'Authorization': JSON.parse(initProps),\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify(datacreate)\n    }).then(res => res.json()).then(res2 => {\n      setloadingcreate(false);\n      settambahbtn(true);\n      setdatacreate({\n        nama: '',\n        jenis: '',\n        tahun_penggunaan: 0,\n        deskripsi: ''\n      });\n\n      if (res2.success) {\n        _notification['success']({\n          message: res2.message,\n          duration: 3\n        });\n\n        setTimeout(() => {\n          rt.push(`/admin/financial`);\n        }, 500);\n      } else if (!res2.success) {\n        _notification['error']({\n          message: res2.message.errorInfo.status_detail,\n          duration: 3\n        });\n      }\n    });\n  };\n\n  const handleDelete = () => {\n    setloadingdelete(true);\n    fetch(`https://boiling-thicket-46501.herokuapp.com/deleteDepreciation`, {\n      method: 'DELETE',\n      headers: {\n        'Authorization': JSON.parse(initProps),\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        id: iddelete\n      })\n    }).then(res => res.json()).then(res2 => {\n      setloadingdelete(false);\n      setmodaldelete(false);\n\n      if (res2.success) {\n        _notification['success']({\n          message: res2.message,\n          duration: 3\n        });\n\n        setTimeout(() => {\n          rt.push(`/admin/financial`);\n        }, 500);\n      } else if (!res2.success) {\n        _notification['error']({\n          message: res2.message.errorInfo.status_detail,\n          duration: 3\n        });\n      }\n    });\n  };\n\n  const handleEdit = () => {\n    setloadingedit(true);\n    fetch(`https://boiling-thicket-46501.herokuapp.com/updateDepreciation`, {\n      method: 'PUT',\n      headers: {\n        'Authorization': JSON.parse(initProps),\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify(dataedit)\n    }).then(res => res.json()).then(res2 => {\n      setloadingedit(false);\n      setmodaledit(false);\n\n      if (res2.success) {\n        _notification['success']({\n          message: res2.message,\n          duration: 3\n        });\n\n        setTimeout(() => {\n          rt.push(`/admin/financial`);\n        }, 500);\n      } else if (!res2.success) {\n        _notification['error']({\n          message: res2.message.errorInfo.status_detail,\n          duration: 3\n        });\n      }\n    });\n  };\n\n  return /*#__PURE__*/_jsx(Layout, {\n    tok: initProps,\n    dataProfile: dataProfile,\n    sidemenu: sidemenu,\n    pathArr: pathArr,\n    st: st,\n    children: /*#__PURE__*/_jsx(\"div\", {\n      className: \"w-full grid grid-cols-5 border-t border-opacity-30 border-gray-500 bg-white\",\n      children: /*#__PURE__*/_jsxs(\"div\", {\n        className: \"col-span-5 lg:col-span-5 flex flex-col\",\n        children: [/*#__PURE__*/_jsx(\"div\", {\n          className: \"border-b border-opacity-30 border-gray-400 flex items-center p-4 mb-5\",\n          children: /*#__PURE__*/_jsx(\"h1\", {\n            className: \"font-semibold\",\n            children: \"Financial\"\n          })\n        }), /*#__PURE__*/_jsxs(\"div\", {\n          className: \"flex flex-col\",\n          children: [/*#__PURE__*/_jsx(\"div\", {\n            className: \"border-b w-full mb-3\",\n            children: /*#__PURE__*/_jsx(\"div\", {\n              className: \" border-b-4 border-gray-400 p-1 w-24\",\n              children: \"Depreciation\"\n            })\n          }), !tambahbtn ? /*#__PURE__*/_jsxs(\"div\", {\n            className: \"flex flex-col mb-4\",\n            children: [/*#__PURE__*/_jsx(\"div\", {\n              className: \"flex items-center font-bold mb-6\",\n              children: \"Tambah Depresiasi Baru\"\n            }), /*#__PURE__*/_jsx(\"div\", {\n              className: \" flex flex-col\",\n              children: /*#__PURE__*/_jsx(\"div\", {\n                className: \"w-full\",\n                children: /*#__PURE__*/_jsxs(_Form, {\n                  layout: \"vertical\",\n                  onFinish: handleCreate,\n                  initialValues: datacreate,\n                  style: {\n                    width: `100%`\n                  },\n                  children: [/*#__PURE__*/_jsxs(\"div\", {\n                    className: \"w-full md:grid md:grid-cols-3\",\n                    children: [/*#__PURE__*/_jsx(_Form.Item, {\n                      label: \"Nama\",\n                      name: \"nama\",\n                      rules: [{\n                        required: true,\n                        message: 'Nama wajib diisi'\n                      }],\n                      style: {\n                        marginRight: `1rem`\n                      },\n                      children: /*#__PURE__*/_jsx(_Input, {\n                        name: \"nama\",\n                        onChange: onChangeCreate,\n                        defaultValue: datacreate.nama\n                      })\n                    }), /*#__PURE__*/_jsx(_Form.Item, {\n                      label: \"Tipe\",\n                      name: \"jenis\",\n                      rules: [{\n                        required: true,\n                        message: 'Wajib diisi'\n                      }],\n                      style: {\n                        marginRight: `1rem`\n                      },\n                      children: /*#__PURE__*/_jsxs(_Select, {\n                        defaultValue: datacreate.jenis,\n                        onChange: value => {\n                          setdatacreate(_objectSpread(_objectSpread({}, datacreate), {}, {\n                            jenis: value\n                          }));\n                        },\n                        children: [/*#__PURE__*/_jsx(Option, {\n                          value: \"Declining Balance\",\n                          children: \"Declining Balance\"\n                        }), /*#__PURE__*/_jsx(Option, {\n                          value: 'Staright Line',\n                          children: \"Staright Line\"\n                        }), /*#__PURE__*/_jsx(Option, {\n                          value: 'Sum of Years Digit',\n                          children: \"Sum of Years Digit\"\n                        })]\n                      })\n                    }), /*#__PURE__*/_jsx(_Form.Item, {\n                      label: \"Daya Tahan (tahun)\",\n                      name: \"tahun_penggunaan\",\n                      rules: [{\n                        required: true,\n                        message: 'Wajib diisi'\n                      }],\n                      style: {\n                        marginRight: `1rem`\n                      },\n                      children: /*#__PURE__*/_jsx(_Input, {\n                        name: \"tahun_penggunaan\",\n                        onChange: onChangeCreate,\n                        defaultValue: datacreate.tahun_penggunaan\n                      })\n                    })]\n                  }), /*#__PURE__*/_jsx(\"div\", {\n                    className: \"mb-2\",\n                    children: /*#__PURE__*/_jsx(_Form.Item, {\n                      label: \"Deskripsi\",\n                      name: \"deskripsi\",\n                      children: /*#__PURE__*/_jsx(_Input.TextArea, {\n                        name: \"deskripsi\",\n                        onChange: onChangeCreate,\n                        defaultValue: datacreate.deskripsi,\n                        style: {\n                          width: `100%`\n                        }\n                      })\n                    })\n                  }), /*#__PURE__*/_jsxs(\"div\", {\n                    className: \"flex justify-end items-center\",\n                    children: [/*#__PURE__*/_jsx(_Button, {\n                      type: \"default\",\n                      onClick: () => {\n                        settambahbtn(true);\n                      },\n                      size: \"middle\",\n                      style: {\n                        marginRight: `1rem`\n                      },\n                      children: \"Cancel\"\n                    }), /*#__PURE__*/_jsx(_Button, {\n                      type: \"primary\",\n                      htmlType: \"submit\",\n                      loading: loadingcreate,\n                      size: \"middle\",\n                      children: \"Save\"\n                    })]\n                  })]\n                })\n              })\n            })]\n          }) : null, /*#__PURE__*/_jsxs(\"div\", {\n            className: \"flex items-center justify-between mb-3\",\n            children: [/*#__PURE__*/_jsx(\"div\", {\n              className: \" font-semibold text-gray-400\",\n              children: \"Semua Depresiasi\"\n            }), tambahbtn ?\n            /*#__PURE__*/\n            // <button className={`${tambahbtn} text-blue-500 hover:text-blue-700 text-sm flex items-center`} onClick={() => { settambahbtn(false) }}>\n            //     <PlusCircleTwoTone style={{ marginRight: `0.2rem`, marginTop: `0.1rem` }} /> Tambah Baru\n            // </button>\n            _jsx(_Fragment, {\n              children: [170].every(curr => dataProfile.data.registered_feature.includes(curr)) && /*#__PURE__*/_jsx(_Button, {\n                type: \"primary\",\n                onClick: () => {\n                  settambahbtn(false);\n                },\n                children: \"Add New\"\n              })\n            }) : null]\n          }), /*#__PURE__*/_jsx(_Table, {\n            columns: columns,\n            dataSource: dataListDepreciationsMap,\n            pagination: {\n              pageSize: 8\n            },\n            scroll: {\n              x: 300\n            }\n          }), /*#__PURE__*/_jsx(_Modal, {\n            title: `Konfirmasi hapus depresiasi`,\n            visible: modaldelete,\n            okButtonProps: {\n              disabled: loadingdelete\n            },\n            onCancel: () => {\n              setmodaldelete(false);\n            },\n            onOk: handleDelete,\n            maskClosable: false,\n            style: {\n              top: `3rem`\n            },\n            width: 500,\n            destroyOnClose: true,\n            children: \"Yakin ingin hapus depresiasi ini?\"\n          }), /*#__PURE__*/_jsx(_Modal, {\n            title: `Edit Depresiasi`,\n            visible: modaledit,\n            onCancel: () => {\n              setmodaledit(false);\n            },\n            footer: null,\n            maskClosable: false,\n            style: {\n              top: `3rem`\n            },\n            width: 700,\n            destroyOnClose: true,\n            children: /*#__PURE__*/_jsxs(\"div\", {\n              className: \"flex flex-col mb-4\",\n              children: [/*#__PURE__*/_jsx(\"div\", {\n                className: \"flex items-center font-bold mb-3\",\n                children: \"Edit Depresiasi\"\n              }), /*#__PURE__*/_jsx(\"div\", {\n                className: \" flex flex-col\",\n                children: /*#__PURE__*/_jsx(\"div\", {\n                  className: \"w-full\",\n                  children: /*#__PURE__*/_jsxs(_Form, {\n                    layout: \"vertical\",\n                    onFinish: handleEdit,\n                    initialValues: dataedit,\n                    children: [/*#__PURE__*/_jsxs(\"div\", {\n                      className: \" w-full md:grid grid-cols-3\",\n                      children: [/*#__PURE__*/_jsx(_Form.Item, {\n                        label: \"Nama\",\n                        name: \"nama\",\n                        rules: [{\n                          required: true,\n                          message: 'Nama wajib diisi'\n                        }],\n                        style: {\n                          marginRight: `1rem`\n                        },\n                        children: /*#__PURE__*/_jsx(_Input, {\n                          name: \"nama\",\n                          onChange: onChangeEdit,\n                          defaultValue: dataedit.nama\n                        })\n                      }), /*#__PURE__*/_jsx(_Form.Item, {\n                        label: \"Tipe\",\n                        name: \"jenis\",\n                        rules: [{\n                          required: true,\n                          message: 'Wajib diisi'\n                        }],\n                        style: {\n                          marginRight: `1rem`\n                        },\n                        children: /*#__PURE__*/_jsxs(_Select, {\n                          defaultValue: dataedit.jenis,\n                          onChange: value => {\n                            setdataedit(_objectSpread(_objectSpread({}, dataedit), {}, {\n                              jenis: value\n                            }));\n                          },\n                          children: [/*#__PURE__*/_jsx(Option, {\n                            value: \"Declining Balance\",\n                            children: \"Declining Balance\"\n                          }), /*#__PURE__*/_jsx(Option, {\n                            value: 'Staright Line',\n                            children: \"Staright Line\"\n                          }), /*#__PURE__*/_jsx(Option, {\n                            value: 'Sum of Years Digit',\n                            children: \"Sum of Years Digit\"\n                          })]\n                        })\n                      }), /*#__PURE__*/_jsx(_Form.Item, {\n                        label: \"Daya Tahan (tahun)\",\n                        name: \"tahun_penggunaan\",\n                        rules: [{\n                          required: true,\n                          message: 'Wajib diisi'\n                        }],\n                        style: {\n                          marginRight: `1rem`\n                        },\n                        children: /*#__PURE__*/_jsx(_Input, {\n                          name: \"tahun_penggunaan\",\n                          onChange: onChangeEdit,\n                          defaultValue: dataedit.tahun_penggunaan\n                        })\n                      })]\n                    }), /*#__PURE__*/_jsx(\"div\", {\n                      className: \"mb-2\",\n                      children: /*#__PURE__*/_jsx(_Form.Item, {\n                        label: \"Deskripsi\",\n                        name: \"deskripsi\",\n                        children: /*#__PURE__*/_jsx(_Input.TextArea, {\n                          name: \"deskripsi\",\n                          onChange: onChangeEdit,\n                          defaultValue: dataedit.deskripsi,\n                          style: {\n                            width: `100%`\n                          }\n                        })\n                      })\n                    }), /*#__PURE__*/_jsxs(\"div\", {\n                      className: \"flex justify-end items-center\",\n                      children: [/*#__PURE__*/_jsx(_Button, {\n                        type: \"default\",\n                        onClick: () => {\n                          setmodaledit(false);\n                        },\n                        size: \"middle\",\n                        style: {\n                          marginRight: `1rem`\n                        },\n                        children: \"Cancel\"\n                      }), /*#__PURE__*/_jsx(_Button, {\n                        type: \"primary\",\n                        htmlType: \"submit\",\n                        loading: loadingedit,\n                        size: \"middle\",\n                        children: \"Save\"\n                      })]\n                    })]\n                  })\n                })\n              })]\n            })\n          })]\n        })]\n      })\n    })\n  });\n}\n\nexport async function getServerSideProps({\n  req,\n  res\n}) {\n  var initProps = {};\n\n  if (req && req.headers) {\n    const cookies = req.headers.cookie;\n\n    if (!cookies) {\n      res.writeHead(302, {\n        Location: '/login'\n      });\n      res.end();\n    }\n\n    if (typeof cookies === 'string') {\n      const cookiesJSON = httpcookie.parse(cookies);\n      initProps = cookiesJSON.token;\n    }\n  }\n\n  const resources = await fetch(`https://boiling-thicket-46501.herokuapp.com/detailProfile`, {\n    method: `GET`,\n    headers: {\n      'Authorization': JSON.parse(initProps)\n    }\n  });\n  const resjson = await resources.json();\n  const dataProfile = resjson; // if (![169, 170, 171, 172].every((curr) => dataProfile.data.registered_feature.includes(curr))) {\n  //     res.writeHead(302, { Location: '/dashboard/admin' })\n  //     res.end()\n  // }\n\n  const resourcesGD = await fetch(`https://boiling-thicket-46501.herokuapp.com/getDepreciations`, {\n    method: `GET`,\n    headers: {\n      'Authorization': JSON.parse(initProps)\n    }\n  });\n  const resjsonGD = await resourcesGD.json();\n  const dataGetDepreciations = resjsonGD;\n  return {\n    props: {\n      initProps,\n      dataProfile,\n      dataGetDepreciations,\n      sidemenu: \"4\"\n    }\n  };\n}\nexport default Financial;","map":null,"metadata":{},"sourceType":"module"}