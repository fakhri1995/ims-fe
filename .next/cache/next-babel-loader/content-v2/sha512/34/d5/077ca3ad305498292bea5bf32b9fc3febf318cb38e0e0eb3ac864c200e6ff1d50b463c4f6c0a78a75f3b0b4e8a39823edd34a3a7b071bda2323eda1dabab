{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport _Row from \"antd/lib/row\";\nimport _Col from \"antd/lib/col\";\nimport _Radio from \"antd/lib/radio\";\nimport _Divider from \"antd/lib/divider\";\nimport _Select from \"antd/lib/select\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport _Button from \"antd/lib/button\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport _Input from \"antd/lib/input\";\nimport _notification from \"antd/lib/notification\";\nimport _Form from \"antd/lib/form\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport Link from \"next/link\";\nimport { useRouter } from \"next/router\";\nimport { useState } from \"react\";\nimport Sticky from \"wil-react-sticky\";\nimport Layout from \"../../../../../components/layout-dashboard\";\nimport st from \"../../../../../components/layout-dashboard.module.css\";\nimport httpcookie from \"cookie\";\n\nfunction GroupsRequestersDetail({\n  initProps,\n  dataProfile,\n  dataListAccount,\n  dataDetailGroup,\n  sidemenu\n}) {\n  const rt = useRouter();\n  const tok = initProps;\n  const pathArr = rt.pathname.split(\"/\").slice(1);\n  pathArr.splice(2, 2);\n  pathArr[pathArr.length - 1] = \"Edit Requesters Group\"; // const pathArr = ['groups', 'edit requester groups']\n\n  const {\n    originPath\n  } = rt.query;\n\n  const [instanceForm] = _Form.useForm();\n\n  const {\n    0: loadingbtn,\n    1: setLoadingbtn\n  } = useState(false);\n  const {\n    0: editgroup,\n    1: setEditgroup\n  } = useState({\n    id: dataDetailGroup.data.group_detail.id,\n    name: dataDetailGroup.data.group_detail.name,\n    description: dataDetailGroup.data.group_detail.description,\n    group_head: dataDetailGroup.data.group_detail.group_head,\n    user_ids: dataDetailGroup.data.group_user\n  });\n\n  const onChangeEditGroup = e => {\n    var val = e.target.value;\n    setEditgroup(_objectSpread(_objectSpread({}, editgroup), {}, {\n      [e.target.name]: val\n    }));\n  };\n\n  const onChangeEditGroupHeadGroup = value => {\n    setEditgroup(_objectSpread(_objectSpread({}, editgroup), {}, {\n      [\"group_head\"]: value\n    }));\n  };\n\n  const handleChangeEditRequester = value => {\n    setEditgroup(_objectSpread(_objectSpread({}, editgroup), {}, {\n      [\"user_ids\"]: value\n    }));\n  };\n\n  function handleClick() {\n    console.log(editgroup);\n  }\n\n  const handleEditGroup = () => {\n    setLoadingbtn(true);\n    fetch(`${process.env.NEXT_PUBLIC_BACKEND_URL}/updateRequesterGroup`, {\n      method: \"PUT\",\n      headers: {\n        Authorization: JSON.parse(tok),\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify(editgroup)\n    }).then(res => res.json()).then(res2 => {\n      setLoadingbtn(false);\n\n      if (res2.success) {\n        _notification[\"success\"]({\n          message: res2.message,\n          duration: 3\n        });\n\n        setTimeout(() => {\n          rt.push(`/admin/groups/update/requesters/${dataDetailGroup.data.group_detail.id}`);\n        }, 100);\n      } else if (!res2.success) {\n        _notification[\"error\"]({\n          message: res2.message,\n          duration: 3\n        });\n      }\n    });\n  }; //------------------------------------------\n  //----------------radio button--------------\n\n\n  const {\n    0: value,\n    1: setValue\n  } = useState(1);\n\n  const onChange = e => {\n    setValue(e.target.value);\n  }; //------------------------------------------\n  //------------populate list account-------------\n\n\n  const dataDD = dataListAccount.data.data.map((doc, idx) => {\n    return {\n      value: doc.id,\n      label: doc.name\n    };\n  });\n\n  function handleChange(value) {\n    console.log(`selected ${value}`);\n  } //----------------------------------------------\n\n\n  const {\n    TextArea\n  } = _Input;\n  return /*#__PURE__*/_jsx(Layout, {\n    tok: tok,\n    dataProfile: dataProfile,\n    pathArr: pathArr,\n    sidemenu: sidemenu,\n    dataDetailGroup: dataDetailGroup,\n    originPath: originPath,\n    st: st,\n    children: /*#__PURE__*/_jsx(_Fragment, {\n      children: /*#__PURE__*/_jsxs(\"div\", {\n        className: \"w-full h-auto grid grid-cols-1 md:grid-cols-4\",\n        children: [/*#__PURE__*/_jsx(\"div\", {\n          className: \" col-span-1 md:col-span-4\",\n          children: /*#__PURE__*/_jsx(Sticky, {\n            containerSelectorFocus: \"#formAgentsWrapper\",\n            children: /*#__PURE__*/_jsxs(\"div\", {\n              className: \"flex justify-between p-4 border-gray-400 border-t border-b bg-white mb-8\",\n              children: [/*#__PURE__*/_jsx(\"h1\", {\n                className: \"font-semibold text-base w-auto\",\n                children: \"Edit Requesters Group\"\n              }), /*#__PURE__*/_jsxs(\"div\", {\n                className: \"flex space-x-2\",\n                children: [/*#__PURE__*/_jsx(Link, {\n                  href: \"/admin/groups\",\n                  children: /*#__PURE__*/_jsx(_Button, {\n                    type: \"default\",\n                    size: \"middle\",\n                    children: \"Cancel\"\n                  })\n                }),\n                /*#__PURE__*/\n                // [142].every((curr) => dataProfile.data.registered_feature.includes(curr)) &&\n                _jsx(_Button, {\n                  type: \"primary\",\n                  size: \"middle\",\n                  onClick: instanceForm.submit,\n                  loading: loadingbtn,\n                  children: \"Save\"\n                })]\n              })]\n            })\n          })\n        }), /*#__PURE__*/_jsx(_Form, {\n          layout: \"vertical\",\n          onFinish: handleEditGroup,\n          style: {\n            display: \"contents\"\n          },\n          form: instanceForm,\n          children: /*#__PURE__*/_jsxs(\"div\", {\n            className: \" col-span-1 md:col-span-3 flex flex-col\",\n            id: \"formAgentsWrapper\",\n            children: [/*#__PURE__*/_jsx(\"div\", {\n              className: \"pb-4 md:mb-0 \",\n              children: /*#__PURE__*/_jsx(_Form.Item, {\n                name: \"name\",\n                style: {\n                  marginRight: `1rem`\n                },\n                label: \"Group Name\",\n                rules: [{\n                  required: true,\n                  message: \"Nama grup harus diisi\"\n                }],\n                initialValue: editgroup.name,\n                children:\n                /*#__PURE__*/\n                // [142].every((curr) => dataProfile.data.registered_feature.includes(curr)) ?\n                _jsx(_Input, {\n                  placeholder: \"Group Name\",\n                  name: `name`,\n                  onChange: onChangeEditGroup\n                })\n              })\n            }), /*#__PURE__*/_jsx(\"div\", {\n              className: \"pb-4 md:mb-0\",\n              children: /*#__PURE__*/_jsx(_Form.Item, {\n                name: \"description\",\n                style: {\n                  marginRight: `1rem`\n                },\n                label: \"Group Description\",\n                rules: [{\n                  required: true,\n                  message: \"Deskripsi grup harus diisi\"\n                }],\n                initialValue: editgroup.description,\n                children:\n                /*#__PURE__*/\n                // [142].every((curr) => dataProfile.data.registered_feature.includes(curr)) ?\n                _jsx(TextArea, {\n                  placeholder: \"Group Description\",\n                  rows: 2,\n                  name: `description`,\n                  onChange: onChangeEditGroup\n                })\n              })\n            }), /*#__PURE__*/_jsx(\"div\", {\n              className: \"pb-4 md:mb-0 \",\n              children: /*#__PURE__*/_jsx(_Form.Item, {\n                name: \"group_head\",\n                style: {\n                  marginRight: `1rem`\n                },\n                label: \"Group Head\",\n                rules: [{\n                  required: true,\n                  message: \"Ketua grup harus diisi\"\n                }],\n                initialValue: editgroup.group_head,\n                children:\n                /*#__PURE__*/\n                // [142].every((curr) => dataProfile.data.registered_feature.includes(curr)) ?\n                _jsx(_Select, {\n                  showSearch: true,\n                  placeholder: \"Add Group Head\",\n                  name: `group_head`,\n                  showArrow: true,\n                  options: dataDD,\n                  optionFilterProp: \"label\",\n                  onChange: onChangeEditGroupHeadGroup,\n                  style: {\n                    width: \"100%\",\n                    lineHeight: \"2.4\"\n                  }\n                })\n              })\n            }), /*#__PURE__*/_jsx(_Divider, {\n              style: {\n                borderTop: \"1px solid rgba(0, 0, 0, 0.2)\"\n              }\n            }),\n            /*#__PURE__*/\n            // [142].every((curr) => dataProfile.data.registered_feature.includes(curr)) ?\n            _jsxs(_Fragment, {\n              children: [/*#__PURE__*/_jsx(\"h1\", {\n                className: \"font-semibold text-base w-auto py-2\",\n                children: \"Agents\"\n              }), /*#__PURE__*/_jsxs(\"div\", {\n                className: \"border-gray-300 md:px-4 px-0 py-4 mb-5 border bg-white w-full h-auto \",\n                children: [/*#__PURE__*/_jsxs(_Radio.Group, {\n                  className: \"flex flex-col md:flex-row\",\n                  row: true,\n                  onChange: onChange,\n                  value: value,\n                  children: [/*#__PURE__*/_jsxs(_Radio, {\n                    className: \"flex-initial font-bold \",\n                    value: 1,\n                    children: [\"Add as a Member\", /*#__PURE__*/_jsx(\"p\", {\n                      className: \"pl-6 whitespace-normal font-normal\",\n                      style: {\n                        width: \"min-content\",\n                        minWidth: \"15rem\"\n                      },\n                      children: \"Members can be assigned tickets, tasks and other items that belong to this group.\"\n                    })]\n                  }), /*#__PURE__*/_jsxs(_Radio, {\n                    disabled: true,\n                    className: \"flex-initial font-bold\",\n                    value: 2,\n                    children: [\"Add as an Observer\", /*#__PURE__*/_jsx(\"p\", {\n                      className: \"pl-6 whitespace-normal font-normal\",\n                      style: {\n                        width: \"min-content\",\n                        minWidth: \"15rem\"\n                      },\n                      children: \"Members can be assigned tickets, tasks and other items that belong to this group.\"\n                    })]\n                  })]\n                }), /*#__PURE__*/_jsx(_Row, {\n                  children: /*#__PURE__*/_jsx(_Col, {\n                    flex: \"auto\",\n                    children: /*#__PURE__*/_jsx(_Select, {\n                      placeholder: \"Add an Requester\",\n                      showArrow: true,\n                      mode: \"multiple\",\n                      optionFilterProp: \"label\",\n                      onChange: handleChangeEditRequester,\n                      defaultValue: editgroup.user_ids,\n                      options: dataDD,\n                      style: {\n                        width: \"100%\",\n                        padding: \"0 5px\",\n                        lineHeight: \"2.4\"\n                      }\n                    })\n                  })\n                })]\n              })]\n            })]\n          })\n        }), /*#__PURE__*/_jsx(\"div\", {\n          className: `${st.grupdesc} flex flex-col space-y-3 px-4`\n        })]\n      })\n    })\n  });\n}\n\nexport async function getServerSideProps({\n  req,\n  res,\n  params\n}) {\n  var initProps = {};\n  const groupsid = params.groupsId;\n  const reqBodyAccountList = {\n    page: 1,\n    rows: 50,\n    order_by: \"asc\"\n  };\n\n  if (req && req.headers) {\n    const cookies = req.headers.cookie;\n\n    if (!cookies) {\n      res.writeHead(302, {\n        Location: \"/login\"\n      });\n      res.end();\n    }\n\n    if (typeof cookies === \"string\") {\n      const cookiesJSON = httpcookie.parse(cookies);\n      initProps = cookiesJSON.token;\n    }\n  } //get data detail group\n\n\n  const resourcesGetDetailGroup = await fetch(`${process.env.NEXT_PUBLIC_BACKEND_URL}/getRequesterGroup?id=${groupsid}`, {\n    method: `GET`,\n    headers: {\n      Authorization: JSON.parse(initProps)\n    }\n  });\n  const resjsonGetDetailGroup = await resourcesGetDetailGroup.json();\n  const dataDetailGroup = resjsonGetDetailGroup; //get detail profil yang login\n\n  const resourcesGP = await fetch(`${process.env.NEXT_PUBLIC_BACKEND_URL}/detailProfile`, {\n    method: `GET`,\n    headers: {\n      Authorization: JSON.parse(initProps)\n    }\n  });\n  const resjsonGP = await resourcesGP.json();\n  const dataProfile = resjsonGP; // if (![141, 142].every((curr) => dataProfile.data.registered_feature.includes(curr))) {\n  //     res.writeHead(302, { Location: '/dashboard/admin' })\n  //     res.end()\n  // }\n  //get data list akun\n\n  const resourcesLA = await fetch(`${process.env.NEXT_PUBLIC_BACKEND_URL}/getRequesterList`, {\n    method: `GET`,\n    headers: {\n      Authorization: JSON.parse(initProps),\n      \"Content-Type\": \"application/json\"\n    }\n  });\n  const resjsonLA = await resourcesLA.json();\n  const dataListAccount = resjsonLA;\n  return {\n    props: {\n      initProps,\n      dataProfile,\n      dataListAccount,\n      dataDetailGroup,\n      sidemenu: \"63\"\n    }\n  };\n}\nexport default GroupsRequestersDetail;","map":null,"metadata":{},"sourceType":"module"}