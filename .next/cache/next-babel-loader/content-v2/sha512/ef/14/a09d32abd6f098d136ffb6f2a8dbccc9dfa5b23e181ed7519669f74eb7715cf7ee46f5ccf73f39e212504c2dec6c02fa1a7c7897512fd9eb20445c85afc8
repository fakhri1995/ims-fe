{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport _Empty from \"antd/lib/empty\";\nimport _Select from \"antd/lib/select\";\nimport _DatePicker from \"antd/lib/date-picker\";\nimport _Button from \"antd/lib/button\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport _defineProperty from \"/home/kjokken/mig/code/frontend/ims-fe-ssh-dev/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _slicedToArray from \"/home/kjokken/mig/code/frontend/ims-fe-ssh-dev/node_modules/next/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _Checkbox from \"antd/lib/checkbox\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { useRouter } from 'next/router';\nimport React, { useEffect, useState } from 'react';\nimport Link from 'next/link';\nimport { SearchOutlined } from '@ant-design/icons';\nimport Layout from '../../../components/layout-dashboard2';\nimport moment from 'moment';\nimport st from '../../../components/layout-dashboard.module.css';\n\nvar TicketExporting = function TicketExporting(_ref) {\n  var initProps = _ref.initProps,\n      dataProfile = _ref.dataProfile,\n      sidemenu = _ref.sidemenu;\n  // 1.Init\n  var rt = useRouter();\n  var pathArr = rt.pathname.split(\"/\").slice(1);\n  var CheckboxGroup = _Checkbox.Group;\n  var closed = rt.query.closed; //useState\n\n  var _useState = useState({\n    group: [],\n    engineer: []\n  }),\n      displaydata = _useState[0],\n      setdisplaydata = _useState[1];\n\n  var _useState2 = useState({\n    group: null,\n    engineer: null,\n    type: null,\n    from: \"\",\n    to: \"\",\n    core_attributes: [1, 1, 1, 1, 1, 1, 1, 1, 1],\n    secondary_attributes: [1, 1, 1, 1, 1, 1, 1, 1]\n  }),\n      attr = _useState2[0],\n      setattr = _useState2[1];\n\n  var _useState3 = useState(true),\n      praloading = _useState3[0],\n      setpraloading = _useState3[1]; //checkbox\n  //core attr\n\n\n  var _useState4 = useState([1, 2, 3, 4, 5, 6, 7, 8]),\n      coreopt = _useState4[0],\n      setcoreopt = _useState4[1];\n\n  var _useState5 = useState([1, 2, 3, 4, 5, 6, 7, 8]),\n      defaultcoreopt = _useState5[0],\n      setdefaultcoreopt = _useState5[1];\n\n  var _React$useState = React.useState(false),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      indeterminatecore = _React$useState2[0],\n      setIndeterminatecore = _React$useState2[1];\n\n  var _React$useState3 = React.useState(true),\n      _React$useState4 = _slicedToArray(_React$useState3, 2),\n      checkAllcore = _React$useState4[0],\n      setCheckAllcore = _React$useState4[1];\n\n  var onChangecore = function onChangecore(list) {\n    console.log(list);\n    setdefaultcoreopt(list);\n    setIndeterminatecore(!!list.length && list.length < coreopt.length);\n    setCheckAllcore(list.length === coreopt.length);\n    var arr = [0, 0, 0, 0, 0, 0, 0, 0, 0].map(function (_, idx) {\n      return list.includes(idx) ? 1 : 0;\n    });\n    setattr(_objectSpread(_objectSpread({}, attr), {}, {\n      core_attributes: arr\n    }));\n  };\n\n  var onCheckAllChangecore = function onCheckAllChangecore(e) {\n    setdefaultcoreopt(e.target.checked ? coreopt : []);\n    setIndeterminatecore(false);\n    setCheckAllcore(e.target.checked);\n    var arr = [1, 1, 1, 1, 1, 1, 1, 1, 1],\n        arr2 = [0, 0, 0, 0, 0, 0, 0, 0, 0];\n    setattr(_objectSpread(_objectSpread({}, attr), {}, {\n      core_attributes: e.target.checked ? arr : arr2\n    }));\n  }; //secondary attr\n\n\n  var _useState6 = useState([1, 2, 3, 4, 5, 6, 7]),\n      secopt = _useState6[0],\n      setsecopt = _useState6[1];\n\n  var _useState7 = useState([1, 2, 3, 4, 5, 6, 7]),\n      defaultsecopt = _useState7[0],\n      setdefaultsecopt = _useState7[1];\n\n  var _React$useState5 = React.useState(false),\n      _React$useState6 = _slicedToArray(_React$useState5, 2),\n      indeterminatesec = _React$useState6[0],\n      setIndeterminatesec = _React$useState6[1];\n\n  var _React$useState7 = React.useState(true),\n      _React$useState8 = _slicedToArray(_React$useState7, 2),\n      checkAllsec = _React$useState8[0],\n      setCheckAllsec = _React$useState8[1];\n\n  var onChangesec = function onChangesec(list) {\n    setdefaultsecopt(list);\n    setIndeterminatesec(!!list.length && list.length < secopt.length);\n    setCheckAllsec(list.length === secopt.length);\n    var arr = [0, 0, 0, 0, 0, 0, 0, 0].map(function (_, idx) {\n      return list.includes(idx) ? 1 : 0;\n    });\n    setattr(_objectSpread(_objectSpread({}, attr), {}, {\n      secondary_attributes: arr\n    }));\n  };\n\n  var onCheckAllChangesec = function onCheckAllChangesec(e) {\n    setdefaultsecopt(e.target.checked ? secopt : []);\n    setIndeterminatesec(false);\n    setCheckAllsec(e.target.checked);\n    var arr = [1, 1, 1, 1, 1, 1, 1, 1],\n        arr2 = [0, 0, 0, 0, 0, 0, 0, 0];\n    setattr(_objectSpread(_objectSpread({}, attr), {}, {\n      secondary_attributes: e.target.checked ? arr : arr2\n    }));\n  };\n\n  var handleExport = function handleExport() {\n    // console.log(`https://boiling-thicket-46501.herokuapp.com/downloadTickets?group=${attr.group === null ? \"\" : attr.group}&engineer=${attr.engineer === null ? \"\" : attr.engineer}&type=${attr.type === null ? null : attr.type}&from=${attr.from}&to=${attr.to}&core_attributes=[${attr.core_attributes}]&secondary_attributes=[${attr.secondary_attributes}]`)\n    fetch(\"https://boiling-thicket-46501.herokuapp.com/ticketsExport?group=\".concat(attr.group === null ? \"\" : attr.group, \"&engineer=\").concat(attr.engineer === null ? \"\" : attr.engineer, \"&type=\").concat(attr.type === null ? null : attr.type, \"&from=\").concat(attr.from, \"&to=\").concat(attr.to, \"&core_attributes=[\").concat(attr.core_attributes, \"]&secondary_attributes=[\").concat(attr.secondary_attributes, \"]\").concat(closed === \"1\" ? \"&is_history=1\" : \"&is_history=0\"), {\n      method: 'GET',\n      headers: {\n        'Authorization': JSON.parse(initProps)\n      }\n    }).then(function (res) {\n      return res.blob();\n    }).then(function (res2) {\n      var newBlob = new Blob([res2], {\n        type: \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\"\n      });\n      var data = window.URL.createObjectURL(newBlob);\n      var link = document.createElement('a');\n      link.href = data;\n      link.download = \"\".concat(moment(new Date()).locale('id').format(\"L\"), \"-\").concat(moment(new Date()).locale('id').format('LT'), \".xlsx\");\n      link.click();\n      setTimeout(function () {\n        window.URL.revokeObjectURL(data);\n      });\n    });\n  };\n\n  useEffect(function () {\n    fetch(\"https://boiling-thicket-46501.herokuapp.com/getAssignToList?assignable_type=\".concat(0), {\n      method: \"GET\",\n      headers: {\n        'Authorization': JSON.parse(initProps)\n      }\n    }).then(function (res) {\n      return res.json();\n    }).then(function (res2) {\n      fetch(\"https://boiling-thicket-46501.herokuapp.com/getAssignToList?assignable_type=\".concat(1), {\n        method: \"GET\",\n        headers: {\n          'Authorization': JSON.parse(initProps)\n        }\n      }).then(function (res3) {\n        return res3.json();\n      }).then(function (res4) {\n        setdisplaydata({\n          group: res2.data,\n          engineer: res4.data\n        });\n        setpraloading(false);\n      });\n    });\n  }, []);\n  return /*#__PURE__*/_jsxs(Layout, {\n    dataProfile: dataProfile,\n    sidemenu: sidemenu,\n    tok: initProps,\n    st: st,\n    pathArr: pathArr,\n    children: [/*#__PURE__*/_jsxs(\"div\", {\n      className: \" w-full grid grid-cols-1 md:grid-cols-4 border-t border-b bg-white mb-5 px-4 py-5\",\n      children: [/*#__PURE__*/_jsx(\"div\", {\n        className: \" col-span-1 md:col-span-3 flex items-center mb-2 md:mb-0\",\n        children: /*#__PURE__*/_jsxs(\"div\", {\n          className: \"font-bold text-2xl w-auto\",\n          children: [\"Export Tickets \", closed === \"1\" && \"(Closed)\"]\n        })\n      }), /*#__PURE__*/_jsxs(\"div\", {\n        className: \" col-span-1 md:col-span-1 flex md:justify-end items-center\",\n        children: [/*#__PURE__*/_jsx(_Button, {\n          size: \"large\",\n          onClick: function onClick() {\n            rt.push(\"/tickets\");\n          },\n          type: \"default\",\n          style: {\n            marginRight: \"1rem\"\n          },\n          children: \"Batal\"\n        }), /*#__PURE__*/_jsx(_Button, {\n          size: \"large\",\n          type: \"primary\",\n          style: {\n            marginRight: \"1rem\"\n          },\n          onClick: handleExport,\n          children: \"Unduh\"\n        })]\n      })]\n    }), /*#__PURE__*/_jsxs(\"div\", {\n      className: \"h-auto w-full grid grid-cols-1 md:grid-cols-5 mb-5 bg-white rounded-md\",\n      children: [/*#__PURE__*/_jsxs(\"div\", {\n        className: \"md:col-span-5 col-span-1 flex flex-col py-3\",\n        children: [/*#__PURE__*/_jsx(\"h1\", {\n          className: \"font-semibold text-base mb-3\",\n          children: \"Filter Ticket by\"\n        }), /*#__PURE__*/_jsxs(\"div\", {\n          className: \"border-2 shadow-md rounded-md flex flex-col py-5 px-10 mb-9 w-9/12\",\n          children: [/*#__PURE__*/_jsxs(\"div\", {\n            className: \"flex flex-col mb-5\",\n            children: [/*#__PURE__*/_jsx(\"h1\", {\n              className: \"text-sm font-semibold mb-2\",\n              children: \"Rentang Waktu\"\n            }), /*#__PURE__*/_jsx(_DatePicker.RangePicker, {\n              onChange: function onChange(dates, datestrings) {\n                if (datestrings[0] === '' && datestrings[1] === '') {\n                  setattr(_objectSpread(_objectSpread({}, attr), {}, {\n                    from: \"\",\n                    to: \"\"\n                  }));\n                } else {\n                  setattr(_objectSpread(_objectSpread({}, attr), {}, {\n                    from: moment(datestrings[0]).locale('id').format('YYYY-MM-DD'),\n                    to: moment(datestrings[1]).locale('id').format('YYYY-MM-DD')\n                  }));\n                }\n              }\n            })]\n          }), /*#__PURE__*/_jsxs(\"div\", {\n            className: \"flex flex-col mb-5\",\n            children: [/*#__PURE__*/_jsx(\"p\", {\n              className: \"mb-2 font-semibold text-sm\",\n              children: \"Group\"\n            }), /*#__PURE__*/_jsx(_Select, {\n              loading: praloading,\n              onChange: function onChange(value) {\n                setattr(_objectSpread(_objectSpread({}, attr), {}, {\n                  group: Number(value)\n                }));\n              },\n              children: displaydata.group.map(function (doc, idx) {\n                return /*#__PURE__*/_jsx(_Select.Option, {\n                  value: doc.id,\n                  children: doc.name\n                });\n              })\n            })]\n          }), /*#__PURE__*/_jsxs(\"div\", {\n            className: \"flex flex-col mb-5\",\n            children: [/*#__PURE__*/_jsx(\"p\", {\n              className: \"mb-2 font-semibold text-sm\",\n              children: \"Engineer\"\n            }), /*#__PURE__*/_jsx(_Select, {\n              loading: praloading,\n              onChange: function onChange(value) {\n                setattr(_objectSpread(_objectSpread({}, attr), {}, {\n                  engineer: Number(value)\n                }));\n              },\n              children: displaydata.engineer.map(function (doc, idx) {\n                return /*#__PURE__*/_jsx(_Select.Option, {\n                  value: doc.id,\n                  children: doc.name\n                });\n              })\n            })]\n          })]\n        })]\n      }), /*#__PURE__*/_jsxs(\"div\", {\n        className: \"md:col-span-5 col-span-1 flex flex-col py-3\",\n        children: [/*#__PURE__*/_jsx(\"h1\", {\n          className: \"font-semibold text-base mb-3\",\n          children: \"Export Field\"\n        }), /*#__PURE__*/_jsx(_Select, {\n          allowClear: true,\n          placeholder: \"Pilih Tipe Ticket\",\n          style: {\n            marginBottom: \"1rem\",\n            width: \"25%\"\n          },\n          onChange: function onChange(value) {\n            console.log(value);\n            setattr(_objectSpread(_objectSpread({}, attr), {}, {\n              type: typeof value === 'undefined' ? null : value\n            }));\n          },\n          children: /*#__PURE__*/_jsx(_Select.Option, {\n            value: 1,\n            children: \"Incident\"\n          })\n        }), /*#__PURE__*/_jsxs(\"div\", {\n          className: \"flex flex-col mb-4\",\n          children: [/*#__PURE__*/_jsx(\"div\", {\n            className: \"font-semibold w-9/12 border-b mb-3\",\n            children: \"Atribut Utama\"\n          }), /*#__PURE__*/_jsx(_Checkbox, {\n            style: {\n              marginBottom: \"0.5rem\"\n            },\n            indeterminate: indeterminatecore,\n            onChange: onCheckAllChangecore,\n            checked: checkAllcore,\n            children: /*#__PURE__*/_jsx(\"strong\", {\n              children: \"Pilih Semua\"\n            })\n          }), /*#__PURE__*/_jsx(CheckboxGroup, {\n            value: defaultcoreopt,\n            onChange: onChangecore,\n            children: /*#__PURE__*/_jsxs(\"div\", {\n              className: \" w-9/12 grid grid-cols-1 md:grid-cols-3 mr-5\",\n              children: [/*#__PURE__*/_jsx(_Checkbox, {\n                value: coreopt[0],\n                style: {\n                  marginBottom: \"0.5rem\",\n                  marginLeft: \"0rem\"\n                },\n                children: \"Nama Pembuat\"\n              }), /*#__PURE__*/_jsx(_Checkbox, {\n                value: coreopt[1],\n                style: {\n                  marginBottom: \"0.5rem\",\n                  marginLeft: \"0rem\"\n                },\n                children: \"Lokasi Pembuat\"\n              }), /*#__PURE__*/_jsx(_Checkbox, {\n                value: coreopt[2],\n                style: {\n                  marginBottom: \"0.5rem\",\n                  marginLeft: \"0rem\"\n                },\n                children: \"Data Raised Ticket\"\n              }), /*#__PURE__*/_jsx(_Checkbox, {\n                value: coreopt[3],\n                style: {\n                  marginBottom: \"0.5rem\",\n                  marginLeft: \"0rem\"\n                },\n                children: \"Data Closed Ticket\"\n              }), /*#__PURE__*/_jsx(_Checkbox, {\n                value: coreopt[4],\n                style: {\n                  marginBottom: \"0.5rem\",\n                  marginLeft: \"0rem\"\n                },\n                children: \"Ticket Number\"\n              }), /*#__PURE__*/_jsx(_Checkbox, {\n                value: coreopt[5],\n                style: {\n                  marginBottom: \"0.5rem\",\n                  marginLeft: \"0rem\"\n                },\n                children: \"Ticket Type\"\n              }), /*#__PURE__*/_jsx(_Checkbox, {\n                value: coreopt[6],\n                style: {\n                  marginBottom: \"0.5rem\",\n                  marginLeft: \"0rem\"\n                },\n                children: \"Status Ticket\"\n              }), /*#__PURE__*/_jsx(_Checkbox, {\n                value: coreopt[7],\n                style: {\n                  marginBottom: \"0.5rem\",\n                  marginLeft: \"0rem\"\n                },\n                children: \"Assign To\"\n              })]\n            })\n          })]\n        }), /*#__PURE__*/_jsxs(\"div\", {\n          className: \"flex flex-col mb-4 w-9/12\",\n          children: [/*#__PURE__*/_jsx(\"div\", {\n            className: \"font-semibold w-full border-b mb-3\",\n            children: \"Atribut Tambahan\"\n          }), attr.type === null ? /*#__PURE__*/_jsx(_Fragment, {\n            children: /*#__PURE__*/_jsx(_Empty, {\n              image: _Empty.PRESENTED_IMAGE_DEFAULT,\n              description: \"Jika Tipe Ticket tidak dipilih, akan menampilkan semua field\"\n            })\n          }) : /*#__PURE__*/_jsxs(_Fragment, {\n            children: [/*#__PURE__*/_jsx(_Checkbox, {\n              style: {\n                marginBottom: \"0.5rem\"\n              },\n              indeterminate: indeterminatesec,\n              onChange: onCheckAllChangesec,\n              checked: checkAllsec,\n              children: /*#__PURE__*/_jsx(\"strong\", {\n                children: \"Pilih Semua\"\n              })\n            }), /*#__PURE__*/_jsx(CheckboxGroup, {\n              value: defaultsecopt,\n              onChange: onChangesec,\n              children: /*#__PURE__*/_jsxs(\"div\", {\n                className: \" w-9/12 grid grid-cols-1 md:grid-cols-3 mr-5\",\n                children: [/*#__PURE__*/_jsx(_Checkbox, {\n                  value: secopt[0],\n                  style: {\n                    marginBottom: \"0.5rem\",\n                    marginLeft: \"0rem\"\n                  },\n                  children: \"Jenis Produk\"\n                }), /*#__PURE__*/_jsx(_Checkbox, {\n                  value: secopt[1],\n                  style: {\n                    marginBottom: \"0.5rem\",\n                    marginLeft: \"0rem\"\n                  },\n                  children: \"ID Produk\"\n                }), /*#__PURE__*/_jsx(_Checkbox, {\n                  value: secopt[2],\n                  style: {\n                    marginBottom: \"0.5rem\",\n                    marginLeft: \"0rem\"\n                  },\n                  children: \"Nama PIC\"\n                }), /*#__PURE__*/_jsx(_Checkbox, {\n                  value: secopt[3],\n                  style: {\n                    marginBottom: \"0.5rem\",\n                    marginLeft: \"0rem\"\n                  },\n                  children: \"Kontak PIC\"\n                }), /*#__PURE__*/_jsx(_Checkbox, {\n                  value: secopt[4],\n                  style: {\n                    marginBottom: \"0.5rem\",\n                    marginLeft: \"0rem\"\n                  },\n                  children: \"Problem\"\n                }), /*#__PURE__*/_jsx(_Checkbox, {\n                  value: secopt[5],\n                  style: {\n                    marginBottom: \"0.5rem\",\n                    marginLeft: \"0rem\"\n                  },\n                  children: \"Lokasi Problem\"\n                }), /*#__PURE__*/_jsx(_Checkbox, {\n                  value: secopt[6],\n                  style: {\n                    marginBottom: \"0.5rem\",\n                    marginLeft: \"0rem\"\n                  },\n                  children: \"Waktu Kejadian\"\n                })]\n              })\n            })]\n          })]\n        })]\n      })]\n    })]\n  });\n};\n\nexport var __N_SSP = true;\nexport default TicketExporting;\n{\n  /* <Checkbox style={{ marginBottom: `0.5rem`, marginLeft: `0rem` }}>Resolved Time</Checkbox> */\n}\n{\n  /* <Checkbox style={{ marginBottom: `0.5rem`, marginLeft: `0rem` }}>Deskripsi Kejadian</Checkbox> */\n}","map":null,"metadata":{},"sourceType":"module"}