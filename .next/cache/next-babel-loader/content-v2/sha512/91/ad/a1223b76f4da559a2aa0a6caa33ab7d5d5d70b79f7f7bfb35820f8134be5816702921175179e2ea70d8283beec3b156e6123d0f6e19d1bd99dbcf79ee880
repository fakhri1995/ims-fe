{"ast":null,"code":"import _Empty from \"antd/lib/empty\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport _Checkbox from \"antd/lib/checkbox\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport _Button from \"antd/lib/button\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport _notification from \"antd/lib/notification\";\nimport _defineProperty from \"/home/kjokken/mig/code/frontend/ims-fe-ssh-dev/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _Form from \"antd/lib/form\";\nimport _slicedToArray from \"/home/kjokken/mig/code/frontend/ims-fe-ssh-dev/node_modules/next/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _Tabs from \"antd/lib/tabs\";\nimport _Input from \"antd/lib/input\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { useRouter } from 'next/router';\nimport { useState } from 'react';\nimport Layout from '../../../../components/layout-dashboard';\nimport st from '../../../../components/layout-dashboard.module.css';\nimport Link from 'next/link';\nimport Sticky from 'wil-react-sticky';\nimport { useEffect } from 'react';\n\nfunction RolesCreate(_ref) {\n  var initProps = _ref.initProps,\n      dataProfile = _ref.dataProfile,\n      dataListModules = _ref.dataListModules,\n      sidemenu = _ref.sidemenu;\n  var rt = useRouter();\n  var tok = initProps;\n  var pathArr = rt.pathname.split(\"/\").slice(1);\n  pathArr[pathArr.length - 1] = \"Buat Role\";\n  var originPath = rt.query.originPath;\n  var TextArea = _Input.TextArea;\n  var TabPane = _Tabs.TabPane;\n\n  var _Form$useForm = _Form.useForm(),\n      _Form$useForm2 = _slicedToArray(_Form$useForm, 1),\n      instanceForm = _Form$useForm2[0];\n\n  var _useState = useState(false),\n      loadingcreate = _useState[0],\n      setloadingcreate = _useState[1];\n\n  var _useState2 = useState(true),\n      praloading2 = _useState2[0],\n      setpraloading2 = _useState2[1]; //----------CreateGroup-------------\n\n\n  var _useState3 = useState({\n    name: '',\n    description: '',\n    feature_ids: []\n  }),\n      newroles = _useState3[0],\n      setNewroles = _useState3[1];\n\n  var _useState4 = useState([{\n    id: \"\",\n    key: \"\",\n    name: \"\",\n    status: \"\",\n    company_id: 0,\n    description: \"\",\n    feature: [{\n      id: \"\",\n      key: \"\",\n      name: \"\"\n    }]\n  }]),\n      modules = _useState4[0],\n      setmodules = _useState4[1];\n\n  var onChangeCreateRoles = function onChangeCreateRoles(e) {\n    var val = e.target.value;\n    setNewroles(_objectSpread(_objectSpread({}, newroles), {}, _defineProperty({}, e.target.name, val)));\n  };\n\n  var onChangeCreateCheckbox = function onChangeCreateCheckbox(e, id) {\n    if (e.target.checked) {\n      var _temp = newroles.feature_ids;\n\n      _temp.push(id);\n\n      setNewroles(_objectSpread(_objectSpread({}, newroles), {}, {\n        feature_ids: _temp\n      }));\n    } else {\n      var temp = newroles.feature_ids;\n      var idx = temp.indexOf(id);\n      temp.splice(idx, 1);\n      setNewroles(_objectSpread(_objectSpread({}, newroles), {}, {\n        feature_ids: temp\n      }));\n    }\n  };\n\n  var handleCreateRoles = function handleCreateRoles() {\n    setloadingcreate(true);\n    fetch(\"https://boiling-thicket-46501.herokuapp.com/addRole\", {\n      method: 'POST',\n      headers: {\n        'Authorization': JSON.parse(initProps),\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify(newroles)\n    }).then(function (res) {\n      return res.json();\n    }).then(function (res2) {\n      if (res2.success) {\n        _notification['success']({\n          message: \"Role berhasil ditambahkan\",\n          duration: 3\n        });\n\n        setNewroles({\n          name: '',\n          description: '',\n          feature_ids: []\n        });\n        setTimeout(function () {\n          setloadingcreate(false);\n          rt.push(\"/admin/roles/detail/\".concat(res2.id));\n        }, 300);\n      } else if (!res2.success) {\n        _notification['error']({\n          message: res2.message.errorInfo.status_detail,\n          duration: 3\n        });\n\n        setloadingcreate(false);\n      }\n    });\n  }; //useEffect\n\n\n  useEffect(function () {\n    fetch(\"https://boiling-thicket-46501.herokuapp.com/getModules\", {\n      method: \"GET\",\n      headers: {\n        'Authorization': JSON.parse(initProps)\n      }\n    }).then(function (res) {\n      return res.json();\n    }).then(function (res2) {\n      setmodules(res2.data);\n      setpraloading2(false);\n    });\n  }, []);\n  return /*#__PURE__*/_jsx(Layout, {\n    tok: tok,\n    dataProfile: dataProfile,\n    pathArr: pathArr,\n    sidemenu: sidemenu,\n    originPath: originPath,\n    st: st,\n    children: /*#__PURE__*/_jsx(_Fragment, {\n      children: /*#__PURE__*/_jsxs(\"div\", {\n        className: \"w-full h-auto grid grid-cols-1 md:grid-cols-4\",\n        id: \"formAgentsWrapper\",\n        children: [/*#__PURE__*/_jsx(\"div\", {\n          className: \"col-span-1 md:col-span-4\",\n          children: /*#__PURE__*/_jsx(Sticky, {\n            containerSelectorFocus: \"#formAgentsWrapper\",\n            children: /*#__PURE__*/_jsxs(\"div\", {\n              className: \"flex justify-between p-4 border-gray-400 border-t border-b bg-white mb-8\",\n              children: [/*#__PURE__*/_jsx(\"h1\", {\n                className: \"font-semibold text-base w-auto \",\n                children: \"Buat Role\"\n              }), /*#__PURE__*/_jsxs(\"div\", {\n                className: \"flex space-x-2\",\n                children: [/*#__PURE__*/_jsx(Link, {\n                  href: \"/admin/roles\",\n                  children: /*#__PURE__*/_jsx(_Button, {\n                    type: \"default\",\n                    size: \"middle\",\n                    children: \"Batal\"\n                  })\n                }), /*#__PURE__*/_jsx(_Button, {\n                  type: \"primary\",\n                  size: \"middle\",\n                  onClick: instanceForm.submit,\n                  loading: loadingcreate,\n                  children: \"Simpan\"\n                })]\n              })]\n            })\n          })\n        }), /*#__PURE__*/_jsx(_Form, {\n          layout: \"vertical\",\n          style: {\n            display: 'contents'\n          },\n          form: instanceForm,\n          onFinish: handleCreateRoles,\n          initialValues: newroles,\n          children: /*#__PURE__*/_jsxs(\"div\", {\n            className: \" col-span-1 md:col-span-3 flex flex-col\",\n            children: [/*#__PURE__*/_jsx(\"div\", {\n              className: \"pb-4 md:mb-0 \",\n              children: /*#__PURE__*/_jsx(_Form.Item, {\n                name: \"name\",\n                style: {\n                  marginRight: \"1rem\"\n                },\n                label: \"Nama Role\",\n                rules: [{\n                  required: true,\n                  message: 'Nama role wajib diisi'\n                }],\n                children: /*#__PURE__*/_jsx(_Input, {\n                  name: \"name\",\n                  onChange: onChangeCreateRoles\n                })\n              })\n            }), /*#__PURE__*/_jsx(\"div\", {\n              className: \"pb-4 md:mb-0\",\n              children: /*#__PURE__*/_jsx(_Form.Item, {\n                name: \"description\",\n                style: {\n                  marginRight: \"1rem\"\n                },\n                label: \"Deskripsi\",\n                rules: [{\n                  required: true,\n                  message: 'Deskripsi role wajib diisi'\n                }],\n                children: /*#__PURE__*/_jsx(TextArea, {\n                  rows: 2,\n                  name: \"description\",\n                  onChange: onChangeCreateRoles\n                })\n              })\n            }), /*#__PURE__*/_jsx(\"hr\", {}), /*#__PURE__*/_jsx(\"h1\", {\n              className: \"font-semibold text-base w-auto p-2\",\n              children: \"Permissions\"\n            }), praloading2 ? null : /*#__PURE__*/_jsx(_Tabs, {\n              defaultActiveKey: \"1\",\n              tabPosition: \"left\",\n              children: modules.map(function (doc, idx) {\n                return /*#__PURE__*/_jsx(TabPane, {\n                  tab: doc.name,\n                  children: /*#__PURE__*/_jsx(\"div\", {\n                    className: \"mb-5\",\n                    children: doc.features !== null ? /*#__PURE__*/_jsx(_Fragment, {\n                      children: doc.features.map(function (doc, idx) {\n                        return /*#__PURE__*/_jsxs(\"div\", {\n                          className: \"flex items-center hover:bg-gray-300 p-3\",\n                          children: [/*#__PURE__*/_jsx(_Checkbox, {\n                            style: {\n                              marginRight: \"1rem\"\n                            },\n                            onChange: function onChange(e) {\n                              onChangeCreateCheckbox(e, doc.id);\n                            }\n                          }), \" \", doc.name]\n                        }, idx);\n                      })\n                    }) : /*#__PURE__*/_jsx(_Fragment, {\n                      children: /*#__PURE__*/_jsx(_Empty, {\n                        image: _Empty.PRESENTED_IMAGE_SIMPLE\n                      })\n                    })\n                  })\n                }, idx + 1);\n              })\n            })]\n          })\n        })]\n      })\n    })\n  });\n}\n\nexport var __N_SSP = true;\nexport default RolesCreate;","map":null,"metadata":{},"sourceType":"module"}