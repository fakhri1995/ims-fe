{"ast":null,"code":"import _Input from \"antd/lib/input\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport _Button from \"antd/lib/button\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport _notification from \"antd/lib/notification\";\nimport _Form from \"antd/lib/form\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport Layout from '../../../../../components/layout-dashboard';\nimport { useRouter } from 'next/router';\nimport httpcookie from 'cookie';\nimport Sticky from 'wil-react-sticky';\nimport Link from 'next/link';\nimport { useEffect, useState } from 'react';\nimport st from '../../../../../components/layout-dashboard.module.css';\n\nfunction AgentPassword({\n  initProps,\n  dataProfile,\n  sidemenu,\n  userid\n}) {\n  const rt = useRouter();\n  const {\n    name\n  } = rt.query;\n  const tok = initProps;\n  var pathArr = rt.pathname.split(\"/\").slice(1);\n  pathArr.splice(2, 1);\n  pathArr[pathArr.length - 1] = `Ubah Password Agent - ${name}`;\n\n  const [instanceForm] = _Form.useForm(); //useState\n  //data payload\n\n\n  const {\n    0: datapass,\n    1: setdatapass\n  } = useState({\n    id: Number(userid),\n    new_password: ''\n  }); //loading ubah password button\n\n  const {\n    0: loadingubahpass,\n    1: setloadingubahpass\n  } = useState(false); //data password confirm\n\n  const {\n    0: konfirmpass,\n    1: setkonfirmpass\n  } = useState(''); //loading pra render\n\n  const {\n    0: praloading,\n    1: setpraloading\n  } = useState(false); //handlePasswordUbahButton\n\n  const handleUbahPassword = () => {\n    if (datapass.new_password !== konfirmpass) {\n      _notification['error']({\n        message: 'Konfirmasi password tidak sama dengan password',\n        duration: 2\n      });\n    } else {\n      setloadingubahpass(true);\n      fetch(`https://boiling-thicket-46501.herokuapp.com/changeAgentPassword`, {\n        method: 'PUT',\n        headers: {\n          'Authorization': JSON.parse(tok),\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(datapass)\n      }).then(res => res.json()).then(res2 => {\n        setloadingubahpass(false);\n\n        if (res2.success) {\n          _notification['success']({\n            message: res2.message,\n            duration: 3\n          });\n\n          setTimeout(() => {\n            rt.push(`/admin/agents/detail/${userid}`);\n          }, 500);\n        } else if (!res2.success) {\n          _notification['error']({\n            message: res2.message,\n            duration: 3\n          });\n        }\n      });\n    }\n  };\n\n  return /*#__PURE__*/_jsx(Layout, {\n    tok: tok,\n    dataProfile: dataProfile,\n    pathArr: pathArr,\n    sidemenu: sidemenu,\n    st: st,\n    children: /*#__PURE__*/_jsxs(\"div\", {\n      className: \"w-full h-auto grid grid-cols-1 md:grid-cols-4\",\n      id: \"createAgentsWrapper\",\n      children: [/*#__PURE__*/_jsx(\"div\", {\n        className: \"col-span-1 md:col-span-4\",\n        children: /*#__PURE__*/_jsx(Sticky, {\n          containerSelectorFocus: \"#createAgentsWrapper\",\n          children: /*#__PURE__*/_jsxs(\"div\", {\n            className: \"flex justify-between p-2 pt-4 border-t-2 border-b-2 bg-white mb-8\",\n            children: [/*#__PURE__*/_jsx(\"h1\", {\n              className: \"font-semibold py-2\",\n              children: \"Ubah Password Agent\"\n            }), /*#__PURE__*/_jsxs(\"div\", {\n              className: \"flex space-x-2\",\n              children: [/*#__PURE__*/_jsx(Link, {\n                href: `/admin/agents/detail/${userid}`,\n                children: /*#__PURE__*/_jsx(_Button, {\n                  disabled: praloading,\n                  type: \"default\",\n                  children: \"Batal\"\n                })\n              }), /*#__PURE__*/_jsx(_Button, {\n                disabled: praloading,\n                loading: loadingubahpass,\n                onClick: instanceForm.submit,\n                type: \"primary\",\n                children: \"Simpan\"\n              })]\n            })]\n          })\n        })\n      }), /*#__PURE__*/_jsx(\"div\", {\n        className: \"col-span-1 md:col-span-3 flex flex-col\",\n        children: /*#__PURE__*/_jsxs(\"div\", {\n          className: \"shadow-lg flex flex-col rounded-md w-full h-auto p-4 mb-14\",\n          children: [/*#__PURE__*/_jsxs(\"div\", {\n            className: \"border-b border-black p-4 font-semibold mb-5\",\n            children: [\"Akun Agent - \", name]\n          }), /*#__PURE__*/_jsx(\"div\", {\n            className: \"grid grid-cols-1 md:grid-cols-4\",\n            children: /*#__PURE__*/_jsx(\"div\", {\n              className: \"p-3 col-span-1 md:col-span-3\",\n              children: /*#__PURE__*/_jsxs(_Form, {\n                layout: \"vertical\",\n                className: \"createAgentsForm\",\n                onFinish: handleUbahPassword,\n                form: instanceForm,\n                children: [/*#__PURE__*/_jsx(_Form.Item, {\n                  label: \"Password Baru\",\n                  name: \"new_password\",\n                  rules: [{\n                    required: true,\n                    message: 'Password baru wajib diisi'\n                  }, {\n                    pattern: /([A-z0-9]{8})/,\n                    message: 'Password minimal 8 karakter'\n                  }],\n                  children: /*#__PURE__*/_jsx(_Input.Password, {\n                    name: `new_password`,\n                    onChange: e => {\n                      setdatapass(_objectSpread(_objectSpread({}, datapass), {}, {\n                        new_password: e.target.value\n                      }));\n                    }\n                  })\n                }), /*#__PURE__*/_jsx(_Form.Item, {\n                  label: \"Konfirmasi Password Baru\",\n                  name: \"konfirmpass\",\n                  rules: [{\n                    required: true,\n                    message: 'Konfirmasi Password baru wajib diisi'\n                  }, {\n                    pattern: /([A-z0-9]{8})/,\n                    message: 'Password minimal 8 karakter'\n                  }],\n                  children: /*#__PURE__*/_jsx(_Input.Password, {\n                    name: `konfirmpass`,\n                    onChange: e => {\n                      setkonfirmpass(e.target.value);\n                    }\n                  })\n                })]\n              })\n            })\n          })]\n        })\n      })]\n    })\n  });\n}\n\nexport async function getServerSideProps({\n  req,\n  res,\n  params\n}) {\n  const userid = params.userId;\n  const reqBody = {\n    page: 1,\n    rows: 50,\n    order_by: \"asc\"\n  };\n  var initProps = {};\n\n  if (!req.headers.cookie) {\n    return {\n      redirect: {\n        permanent: false,\n        destination: '/login'\n      }\n    };\n  }\n\n  const cookiesJSON1 = httpcookie.parse(req.headers.cookie);\n\n  if (!cookiesJSON1.token) {\n    return {\n      redirect: {\n        permanent: false,\n        destination: '/login'\n      }\n    };\n  }\n\n  initProps = cookiesJSON1.token;\n  const resources = await fetch(`https://boiling-thicket-46501.herokuapp.com/detailProfile`, {\n    method: `GET`,\n    headers: {\n      'Authorization': JSON.parse(initProps)\n    }\n  });\n  const resjson = await resources.json();\n  const dataProfile = resjson; // if (![117].every((curr) => dataProfile.data.registered_feature.includes(curr))) {\n  //     res.writeHead(302, { Location: '/dashboard/admin' })\n  //     res.end()\n  // }\n\n  return {\n    props: {\n      initProps,\n      dataProfile,\n      sidemenu: \"61\",\n      userid\n    }\n  };\n}\nexport default AgentPassword;","map":null,"metadata":{},"sourceType":"module"}