{"ast":null,"code":"import _Table from \"antd/lib/table\";\nimport _TreeSelect from \"antd/lib/tree-select\";\nimport _Input from \"antd/lib/input\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport _Button from \"antd/lib/button\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { SearchOutlined } from \"@ant-design/icons\";\nimport Link from \"next/link\";\nimport { useRouter } from \"next/router\";\nimport { useEffect, useState } from \"react\";\nimport Layout from \"../../../components/layout-dashboard\";\nimport st from \"../../../components/layout-dashboard.module.css\";\n\nvar ModelsIndex = function ModelsIndex(_ref) {\n  var initProps = _ref.initProps,\n      dataProfile = _ref.dataProfile,\n      sidemenu = _ref.sidemenu;\n  // 1.Init\n  var rt = useRouter();\n  var pathArr = rt.pathname.split(\"/\").slice(1);\n  var asset_id1 = \"\",\n      name1 = \"\";\n  var _rt$query = rt.query,\n      asset_id = _rt$query.asset_id,\n      name = _rt$query.name,\n      sort_by = _rt$query.sort_by,\n      sort_type = _rt$query.sort_type;\n\n  if (asset_id) {\n    asset_id1 = asset_id;\n  }\n\n  if (name) {\n    name1 = name;\n  } //2.useState\n\n\n  var _useState = useState({\n    success: false,\n    message: \"\",\n    data: {\n      current_page: 0,\n      data: [],\n      first_page_url: \"\",\n      from: 0,\n      last_page: 0,\n      last_page_url: \"\",\n      next_page_url: null,\n      path: \"\",\n      per_page: \"\",\n      prev_page_url: \"\",\n      to: 0,\n      total: 0\n    }\n  }),\n      displayentiredata = _useState[0],\n      setdisplayentiredata = _useState[1];\n\n  var _useState2 = useState([]),\n      displaydata = _useState2[0],\n      setdisplaydata = _useState2[1];\n\n  var _useState3 = useState([]),\n      assetdata = _useState3[0],\n      setassetdata = _useState3[1];\n\n  var _useState4 = useState([]),\n      displaydata1 = _useState4[0],\n      setdisplaydata1 = _useState4[1];\n\n  var _useState5 = useState([]),\n      displaydata2 = _useState5[0],\n      setdisplaydata2 = _useState5[1];\n\n  var _useState6 = useState(name1 === \"\" ? false : true),\n      namasearchact = _useState6[0],\n      setnamasearchact = _useState6[1];\n\n  var _useState7 = useState(null),\n      namavalue = _useState7[0],\n      setnamavalue = _useState7[1];\n\n  var _useState8 = useState(asset_id1 === \"\" ? false : true),\n      assettypefilteract = _useState8[0],\n      setassettypefilteract = _useState8[1];\n\n  var _useState9 = useState(null),\n      assettypevalue = _useState9[0],\n      setassettypevalue = _useState9[1];\n\n  var _useState10 = useState(asset_id1),\n      namaasset = _useState10[0],\n      setnamaasset = _useState10[1];\n\n  var _useState11 = useState(null),\n      defasset = _useState11[0],\n      setdefasset = _useState11[1];\n\n  var _useState12 = useState(0),\n      rowstate = _useState12[0],\n      setrowstate = _useState12[1];\n\n  var _useState13 = useState(true),\n      praloading = _useState13[0],\n      setpraloading = _useState13[1]; //3.Define\n\n\n  var columnsTable = [{\n    title: \"Nama\",\n    dataIndex: \"name\",\n    sorter: function sorter(a, b) {\n      return a.name.length - b.name.length;\n    },\n    defaultSortOrder: \"\".concat(sort_type && sort_by === \"name\" ? sort_type === \"asc\" ? \"ascend\" : \"descend\" : null)\n  }, {\n    title: \"Asset Type\",\n    dataIndex: \"asset_name\"\n  }, {\n    title: \"Jumlah Item\",\n    dataIndex: \"count\",\n    sorter: function sorter(a, b) {\n      return a.count - b.count;\n    },\n    defaultSortOrder: \"\".concat(sort_type && sort_by === \"count\" ? sort_type === \"asc\" ? \"ascend\" : \"descend\" : null)\n  }]; //3.onChange\n\n  var onChangeSearch = function onChangeSearch(e) {\n    if (e.target.value === \"\") {\n      // setdisplaydata(displaydata2)\n      window.location.href = \"/admin/models?asset_id=\".concat(assettypefilteract ? asset_id1 : \"\", \"&name=&sort_by=\").concat(sort_by, \"&sort_type=\").concat(sort_type);\n      setnamasearchact(false);\n    } else {\n      setnamasearchact(true);\n      setnamavalue(e.target.value);\n    }\n  };\n\n  var onChangeAssetType = function onChangeAssetType(id) {\n    if (typeof id === \"undefined\") {\n      // setdisplaydata(displaydata2)\n      window.location.href = \"/admin/models?asset_id=&name=\".concat(namasearchact ? name1 : \"\", \"&sort_by=\").concat(sort_by, \"&sort_type=\").concat(sort_type);\n      setassettypefilteract(false);\n    } else {\n      setassettypefilteract(true);\n      setassettypevalue(id);\n    }\n  };\n\n  var onFinalClick = function onFinalClick() {\n    // var datatemp = displaydata1\n    // if (assettypefilteract) {\n    //     datatemp = datatemp.filter(flt => {\n    //         return (flt.asset_id === Number(assettypevalue)) || (flt.asset_name.replaceAll(/\\s+\\/\\s+/g, \"/\").split(\"/\")[0] === namaasset)\n    //     })\n    // }\n    // if (namasearchact) {\n    //     datatemp = datatemp.filter(flt => {\n    //         return flt.name.toLowerCase().includes(namavalue.toLowerCase())\n    //     })\n    // }\n    // setdisplaydata(datatemp)\n    window.location.href = \"/admin/models?asset_id=\".concat(assettypefilteract ? assettypevalue === null ? asset_id1 : assettypevalue : \"\", \"&name=\").concat(namasearchact ? namavalue === null ? name1 : namavalue : \"\", \"&sort_by=\").concat(sort_by, \"&sort_type=\").concat(sort_type);\n  }; //4.handler\n  //5.useEffect\n\n\n  useEffect(function () {\n    fetch(\"\".concat(process.env.NEXT_PUBLIC_BACKEND_URL, \"/getModels?asset_id=\").concat(asset_id1, \"&name=\").concat(name1, \"&sort_by=\").concat(sort_by, \"&sort_type=\").concat(sort_type), {\n      method: \"GET\",\n      headers: {\n        Authorization: JSON.parse(initProps)\n      }\n    }).then(function (res) {\n      return res.json();\n    }).then(function (res2) {\n      setdisplayentiredata(res2);\n      setdisplaydata(res2.data.data);\n      setdisplaydata1(res2.data.data);\n      setdisplaydata2(res2.data.data);\n      console.log(assettypefilteract, namasearchact);\n    });\n  }, []);\n  useEffect(function () {\n    fetch(\"\".concat(process.env.NEXT_PUBLIC_BACKEND_URL, \"/getAssets\"), {\n      method: \"GET\",\n      headers: {\n        Authorization: JSON.parse(initProps)\n      }\n    }).then(function (res) {\n      return res.json();\n    }).then(function (res2) {\n      var selectedAsset = {};\n\n      var recursiveSearchAsset = function recursiveSearchAsset(doc, key) {\n        for (var i = 0; i < doc.length; i++) {\n          if (doc[i].id === key) {\n            selectedAsset = doc[i];\n          } else {\n            if (doc[i].children) {\n              recursiveSearchAsset(doc[i].children, key);\n            }\n          }\n        }\n      };\n\n      recursiveSearchAsset(res2.data, Number(namaasset));\n      setdefasset(selectedAsset.key);\n      setassetdata(res2.data);\n      setpraloading(false);\n    });\n  }, []);\n  return /*#__PURE__*/_jsxs(Layout, {\n    tok: initProps,\n    dataProfile: dataProfile,\n    sidemenu: sidemenu,\n    st: st,\n    pathArr: pathArr,\n    children: [/*#__PURE__*/_jsxs(\"div\", {\n      className: \"h-20 w-full grid grid-cols-1 md:grid-cols-3 border-gray-400 md:border-t md:border-b bg-white mb-5 p-4\",\n      children: [/*#__PURE__*/_jsx(\"div\", {\n        className: \" col-span-1 md:col-span-2 flex items-center mb-2 md:mb-0\",\n        children: /*#__PURE__*/_jsx(\"div\", {\n          className: \"font-semibold text-base w-auto\",\n          children: \"Models\"\n        })\n      }), /*#__PURE__*/_jsx(\"div\", {\n        className: \" col-span-1 md:col-span-1 flex md:justify-end items-center\",\n        children: /*#__PURE__*/_jsx(Link, {\n          href: \"/admin/models/create\",\n          children: /*#__PURE__*/_jsx(_Button, {\n            size: \"large\",\n            type: \"primary\",\n            children: \"Tambah\"\n          })\n        })\n      })]\n    }), /*#__PURE__*/_jsx(\"div\", {\n      className: \"h-auto w-full grid grid-cols-1 md:grid-cols-5 mb-5 bg-white rounded-md\",\n      children: /*#__PURE__*/_jsxs(\"div\", {\n        className: \"md:col-span-5 col-span-1 flex flex-col py-3\",\n        children: [praloading ? null : /*#__PURE__*/_jsxs(\"div\", {\n          className: \"flex mb-8\",\n          children: [/*#__PURE__*/_jsxs(\"div\", {\n            className: \" w-10/12 mr-1 grid grid-cols-6\",\n            children: [/*#__PURE__*/_jsx(\"div\", {\n              className: \"col-span-4 mr-1\",\n              children: /*#__PURE__*/_jsx(_Input, {\n                style: {\n                  width: \"100%\",\n                  marginRight: \"0.5rem\"\n                },\n                defaultValue: name1,\n                placeholder: \"Cari Nama Model\",\n                onChange: onChangeSearch,\n                allowClear: true\n              })\n            }), /*#__PURE__*/_jsx(\"div\", {\n              className: \"col-span-2 mr-1\",\n              children: /*#__PURE__*/_jsx(_TreeSelect, {\n                allowClear: true,\n                dropdownStyle: {\n                  maxHeight: 400,\n                  overflow: \"auto\"\n                },\n                defaultValue: namaasset === \"\" ? null : defasset,\n                treeData: assetdata,\n                placeholder: \"Cari Asset Type\",\n                treeDefaultExpandAll: true,\n                style: {\n                  width: \"100%\",\n                  marginRight: \"0.5rem\"\n                },\n                onChange: function onChange(value, label, extra) {\n                  if (typeof value === \"undefined\") {\n                    onChangeAssetType();\n                  } else {\n                    onChangeAssetType(extra.allCheckedNodes[0].node.props.id);\n                    setnamaasset(extra.allCheckedNodes[0].node.props.title);\n                  }\n                }\n              })\n            })]\n          }), /*#__PURE__*/_jsx(\"div\", {\n            className: \"w-2/12\",\n            children: /*#__PURE__*/_jsx(_Button, {\n              type: \"primary\",\n              style: {\n                width: \"100%\"\n              },\n              onClick: onFinalClick,\n              children: /*#__PURE__*/_jsx(SearchOutlined, {})\n            })\n          })]\n        }), /*#__PURE__*/_jsx(_Table, {\n          className: \"tableTypeTask\",\n          pagination: {\n            pageSize: 10,\n            total: displayentiredata.data.total,\n            onChange: function onChange(page, pageSize) {\n              setpraloading(true);\n              fetch(\"\".concat(process.env.NEXT_PUBLIC_BACKEND_URL, \"/getModels?page=\").concat(page, \"&rows=10&asset_id=\").concat(asset_id1, \"&name=\").concat(name1, \"&sort_by=\").concat(sort_by, \"&sort_type=\").concat(sort_type), {\n                method: \"GET\",\n                headers: {\n                  Authorization: JSON.parse(initProps)\n                }\n              }).then(function (res) {\n                return res.json();\n              }).then(function (res2) {\n                setdisplayentiredata(res2);\n                setdisplaydata(res2.data.data);\n                setdisplaydata1(res2.data.data);\n                setdisplaydata2(res2.data.data);\n                setpraloading(false);\n              });\n            }\n          },\n          scroll: {\n            x: 200\n          },\n          dataSource: displaydata,\n          columns: columnsTable,\n          loading: praloading,\n          onRow: function onRow(record, rowIndex) {\n            return {\n              onMouseOver: function onMouseOver(event) {\n                setrowstate(record.id);\n              },\n              onClick: function onClick(event) {\n                // {\n                //     [107, 110, 111, 112, 132].every((curr) => dataProfile.data.registered_feature.includes(curr)) ?\n                rt.push(\"/admin/models/detail/\".concat(record.id)); //         :\n                //         null\n                // }\n              }\n            };\n          },\n          rowClassName: function rowClassName(record, idx) {\n            return record.id === rowstate ? \"cursor-pointer\" : \"\";\n          },\n          onChange: function onChange(pagination, filters, sorter, extra) {\n            // console.log('params', pagination, filters, sorter, extra);\n            if (extra.action === \"sort\") {\n              if (sorter.column) {\n                if (sorter.column.dataIndex === \"name\") {\n                  window.location.href = \"/admin/models?asset_id=\".concat(assettypefilteract ? assettypevalue === null ? asset_id1 : assettypevalue : \"\", \"&name=\").concat(namasearchact ? namavalue === \"\" ? name1 : namavalue : \"\", \"&sort_by=name&sort_type=\").concat(sorter.order === \"ascend\" ? \"asc\" : \"desc\");\n                } else if (sorter.column.dataIndex === \"count\") {\n                  window.location.href = \"/admin/models?asset_id=\".concat(assettypefilteract ? assettypevalue === null ? asset_id1 : assettypevalue : \"\", \"&name=\").concat(namasearchact ? namavalue === \"\" ? name1 : namavalue : \"\", \"&sort_by=count&sort_type=\").concat(sorter.order === \"ascend\" ? \"asc\" : \"desc\");\n                }\n              } else {\n                window.location.href = \"/admin/models?asset_id=\".concat(assettypefilteract ? assettypevalue === null ? asset_id1 : assettypevalue : \"\", \"&name=\").concat(namasearchact ? namavalue === \"\" ? name1 : namavalue : \"\", \"&sort_by=&sort_type=\");\n              }\n            }\n          }\n        })]\n      })\n    })]\n  });\n};\n\nexport var __N_SSP = true;\nexport default ModelsIndex;","map":null,"metadata":{},"sourceType":"module"}