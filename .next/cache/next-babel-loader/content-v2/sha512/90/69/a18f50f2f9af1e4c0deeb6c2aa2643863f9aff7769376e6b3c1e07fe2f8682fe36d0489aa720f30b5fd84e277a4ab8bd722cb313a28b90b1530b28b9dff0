{"ast":null,"code":"import _Select from \"antd/lib/select\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport _DatePicker from \"antd/lib/date-picker\";\nimport _defineProperty from \"/Users/makarim/Documents/code/Next/mighty-fe/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport _Spin from \"antd/lib/spin\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport _JSXStyle from \"styled-jsx/style\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useState, useEffect } from 'react';\nimport DrawerCore from '../drawerCore';\nimport { InputRequired, SelectRequired, TextAreaNotRequired } from '../../input';\nimport { AssetIconSvg, CalendartimeIconSvg, CircleXIconSvg, CloudUploadIconSvg, TrashIconSvg, UserIconSvg } from '../../icon';\nimport { Label, H1, H2, Text } from '../../typography';\nimport { SearchOutlined, LoadingOutlined } from '@ant-design/icons';\nimport ButtonSys from '../../button';\nimport moment from 'moment';\nimport Checkbox from 'antd/lib/checkbox/Checkbox';\n\nvar DrawerTicketExports = function DrawerTicketExports(_ref) {\n  var title = _ref.title,\n      visible = _ref.visible,\n      onvisible = _ref.onvisible,\n      onClose = _ref.onClose,\n      buttonOkText = _ref.buttonOkText,\n      disabled = _ref.disabled,\n      initProps = _ref.initProps,\n      refreshtickets = _ref.refreshtickets,\n      setrefreshtickets = _ref.setrefreshtickets,\n      dataprofile = _ref.dataprofile;\n\n  //useState\n  var _useState = useState({\n    group: null,\n    engineer: null,\n    type: null,\n    from: \"\",\n    to: \"\",\n    core_attributes: [1, 1, 1, 1, 1, 1, 1, 1, 1],\n    secondary_attributes: [1, 1, 1, 1, 1, 1, 1, 1]\n  }),\n      datapayload = _useState[0],\n      setdatapayload = _useState[1];\n\n  var _useState2 = useState(false),\n      loadingsave = _useState2[0],\n      setloadingsave = _useState2[1];\n\n  var _useState3 = useState([]),\n      listengs = _useState3[0],\n      setlistengs = _useState3[1];\n\n  var _useState4 = useState(false),\n      fecthingengs = _useState4[0],\n      setfecthingengs = _useState4[1];\n\n  var _useState5 = useState([]),\n      listgroups = _useState5[0],\n      setlistgroups = _useState5[1];\n\n  var _useState6 = useState(false),\n      fecthinggroups = _useState6[0],\n      setfecthinggroups = _useState6[1]; //core attributes\n\n\n  var _useState7 = useState([1, 2, 3, 4, 5, 6, 7, 8]),\n      coreopt = _useState7[0],\n      setcoreopt = _useState7[1];\n\n  var _useState8 = useState([1, 2, 3, 4, 5, 6, 7, 8]),\n      valuecoreopt = _useState8[0],\n      setvaluecoreopt = _useState8[1]; //second attributes\n\n\n  var _useState9 = useState([1, 2, 3, 4, 5, 6, 7]),\n      secondopt = _useState9[0],\n      setsecondopt = _useState9[1];\n\n  var _useState10 = useState([1, 2, 3, 4, 5, 6, 7]),\n      valuesecondopt = _useState10[0],\n      setvaluesecondopt = _useState10[1]; //disabled save button\n\n\n  var _useState11 = useState(false),\n      disabledcreate = _useState11[0],\n      setdisabledcreate = _useState11[1];\n\n  var _useState12 = useState(-1),\n      disabledtrigger = _useState12[0],\n      setdisabledtrigger = _useState12[1]; //handler\n\n\n  var handleExports = function handleExports() {\n    fetch(\"https://boiling-thicket-46501.herokuapp.com/ticketsExport?group=\".concat(datapayload.group === null ? \"\" : datapayload.group, \"&engineer=\").concat(datapayload.engineer === null ? \"\" : datapayload.engineer, \"&type=\").concat(datapayload.type === null ? null : datapayload.type, \"&from=\").concat(datapayload.from, \"&to=\").concat(datapayload.to, \"&core_attributes=[\").concat(datapayload.core_attributes, \"]&secondary_attributes=[\").concat(datapayload.secondary_attributes, \"]&is_history=0\"), {\n      method: 'GET',\n      headers: {\n        'Authorization': JSON.parse(initProps)\n      }\n    }).then(function (res) {\n      return res.blob();\n    }).then(function (res2) {\n      var newBlob = new Blob([res2], {\n        type: \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\"\n      });\n      var data = window.URL.createObjectURL(newBlob);\n      var link = document.createElement('a');\n      link.href = data;\n      link.download = \"\".concat(moment(new Date()).locale('id').format(\"L\"), \"-\").concat(moment(new Date()).locale('id').format('LT'), \".xlsx\");\n      link.click();\n      setTimeout(function () {\n        window.URL.revokeObjectURL(data);\n      });\n    });\n  }; //useEffect\n\n\n  useEffect(function () {\n    fetch(\"https://boiling-thicket-46501.herokuapp.com/getFilterGroups\", {\n      method: \"GET\",\n      headers: {\n        'Authorization': JSON.parse(initProps)\n      }\n    }).then(function (res) {\n      return res.json();\n    }).then(function (res2) {\n      setlistgroups(res2.data);\n    });\n  }, []);\n  useEffect(function () {\n    fetch(\"https://boiling-thicket-46501.herokuapp.com/getFilterUsers?type=\".concat(1), {\n      method: \"GET\",\n      headers: {\n        'Authorization': JSON.parse(initProps)\n      }\n    }).then(function (res) {\n      return res.json();\n    }).then(function (res2) {\n      setlistengs(res2.data);\n    });\n  }, []);\n  useEffect(function () {\n    if (datapayload.core_attributes.every(function (val) {\n      return val === 0;\n    }) === false) {\n      setdisabledcreate(false);\n    } else {\n      setdisabledcreate(true);\n    }\n  }, [disabledtrigger]);\n  return /*#__PURE__*/_jsx(DrawerCore, {\n    title: title,\n    visible: visible,\n    onClose: function onClose() {\n      setdatapayload({\n        group: null,\n        engineer: null,\n        type: null,\n        from: \"\",\n        to: \"\",\n        core_attributes: [1, 1, 1, 1, 1, 1, 1, 1, 1],\n        secondary_attributes: [1, 1, 1, 1, 1, 1, 1, 1]\n      });\n      onvisible(false);\n    },\n    buttonOkText: buttonOkText,\n    onClick: function onClick() {\n      console.log(datapayload);\n      handleExports();\n    },\n    disabled: disabledcreate,\n    children: loadingsave ? /*#__PURE__*/_jsx(_Fragment, {\n      children: /*#__PURE__*/_jsx(_Spin, {})\n    }) : /*#__PURE__*/_jsxs(\"div\", {\n      className: \"flex flex-col\",\n      children: [/*#__PURE__*/_jsx(\"div\", {\n        className: \"mb-6\",\n        children: /*#__PURE__*/_jsx(\"p\", {\n          className: \"mb-0 text-red-500 text-xs italic\",\n          children: \"*Informasi ini harus diisi\"\n        })\n      }), /*#__PURE__*/_jsx(\"div\", {\n        className: \"mb-6\",\n        children: /*#__PURE__*/_jsx(H2, {\n          children: \"Pilih Filter:\"\n        })\n      }), /*#__PURE__*/_jsxs(\"div\", {\n        className: \"flex flex-col mb-6\",\n        children: [/*#__PURE__*/_jsx(\"div\", {\n          className: \"flex mb-2\",\n          children: /*#__PURE__*/_jsx(Label, {\n            children: \"Rentang Waktu\"\n          })\n        }), /*#__PURE__*/_jsx(\"div\", {\n          className: \" mb-2 flex\",\n          children: /*#__PURE__*/_jsx(_DatePicker.RangePicker, {\n            style: {\n              width: \"100%\"\n            },\n            allowClear: true,\n            className: \"datepickerStatus\",\n            onChange: function onChange(dates, datestrings) {\n              if (datestrings[0] === '' && datestrings[1] === '') {\n                setdatapayload(_objectSpread(_objectSpread({}, datapayload), {}, {\n                  from: \"\",\n                  to: \"\"\n                }));\n              } else {\n                setdatapayload(_objectSpread(_objectSpread({}, datapayload), {}, {\n                  from: moment(datestrings[0]).locale('id').format('YYYY-MM-DD'),\n                  to: moment(datestrings[1]).locale('id').format('YYYY-MM-DD')\n                }));\n              }\n            }\n          })\n        })]\n      }), /*#__PURE__*/_jsxs(\"div\", {\n        className: \"flex flex-col mb-6\",\n        children: [/*#__PURE__*/_jsx(\"div\", {\n          className: \"flex mb-2\",\n          children: /*#__PURE__*/_jsx(Label, {\n            children: \"Grup\"\n          })\n        }), /*#__PURE__*/_jsx(\"div\", {\n          className: \" mb-2 flex\",\n          children: /*#__PURE__*/_jsx(_Select, {\n            style: {\n              width: \"100%\"\n            },\n            placeholder: \"Nama Grup...\",\n            suffixIcon: /*#__PURE__*/_jsx(SearchOutlined, {}),\n            showArrow: true,\n            allowClear: true,\n            onChange: function onChange(value, option) {\n              setdatapayload(_objectSpread(_objectSpread({}, datapayload), {}, {\n                group: typeof value === 'undefined' ? null : Number(value)\n              }));\n            },\n            showSearch: true,\n            optionFilterProp: \"children\",\n            notFoundContent: fecthinggroups ? /*#__PURE__*/_jsx(_Spin, {\n              size: \"small\"\n            }) : null,\n            onSearch: function onSearch(value) {\n              setfecthinggroups(true);\n              fetch(\"https://boiling-thicket-46501.herokuapp.com/getFilterGroups?name=\".concat(value), {\n                method: \"GET\",\n                headers: {\n                  'Authorization': JSON.parse(initProps)\n                }\n              }).then(function (res) {\n                return res.json();\n              }).then(function (res2) {\n                setlistgroups(res2.data);\n                setfecthinggroups(false);\n              });\n            },\n            children: listgroups.map(function (doc, idx) {\n              return /*#__PURE__*/_jsx(_Select.Option, {\n                value: doc.id,\n                children: /*#__PURE__*/_jsxs(\"div\", {\n                  className: \" flex items-center\",\n                  children: [/*#__PURE__*/_jsx(\"div\", {\n                    className: \"mr-2\",\n                    children: /*#__PURE__*/_jsx(UserIconSvg, {})\n                  }), /*#__PURE__*/_jsx(\"div\", {\n                    children: doc.name\n                  })]\n                })\n              }, idx);\n            })\n          })\n        })]\n      }), /*#__PURE__*/_jsxs(\"div\", {\n        className: \"flex flex-col mb-6\",\n        children: [/*#__PURE__*/_jsx(\"div\", {\n          className: \"flex mb-2\",\n          children: /*#__PURE__*/_jsx(Label, {\n            children: \"Engineer\"\n          })\n        }), /*#__PURE__*/_jsx(\"div\", {\n          className: \" mb-2 flex\",\n          children: /*#__PURE__*/_jsx(_Select, {\n            style: {\n              width: \"100%\"\n            },\n            placeholder: \"Nama Engineer...\",\n            suffixIcon: /*#__PURE__*/_jsx(SearchOutlined, {}),\n            showArrow: true,\n            allowClear: true,\n            onChange: function onChange(value, option) {\n              setdatapayload(_objectSpread(_objectSpread({}, datapayload), {}, {\n                engineer: typeof value === 'undefined' ? null : Number(value)\n              }));\n            },\n            showSearch: true,\n            optionFilterProp: \"children\",\n            notFoundContent: fecthingengs ? /*#__PURE__*/_jsx(_Spin, {\n              size: \"small\"\n            }) : null,\n            onSearch: function onSearch(value) {\n              setfecthingengs(true);\n              fetch(\"https://boiling-thicket-46501.herokuapp.com/getFilterUsers?type=\".concat(1, \"&name=\", value), {\n                method: \"GET\",\n                headers: {\n                  'Authorization': JSON.parse(initProps)\n                }\n              }).then(function (res) {\n                return res.json();\n              }).then(function (res2) {\n                setlistengs(res2.data);\n                setfecthingengs(false);\n              });\n            },\n            children: listengs.map(function (doc, idx) {\n              return /*#__PURE__*/_jsx(_Select.Option, {\n                value: doc.id,\n                children: /*#__PURE__*/_jsxs(\"div\", {\n                  className: \" flex items-center\",\n                  children: [/*#__PURE__*/_jsx(\"div\", {\n                    className: \"mr-1 w-7 h7 rounded-full\",\n                    children: /*#__PURE__*/_jsx(\"img\", {\n                      src: doc.profile_image === \"-\" ? \"/image/stafftask.png\" : doc.profile_image,\n                      className: \" object-contain\",\n                      alt: \"\"\n                    })\n                  }), /*#__PURE__*/_jsx(\"div\", {\n                    children: doc.name\n                  })]\n                })\n              }, idx);\n            })\n          })\n        })]\n      }), /*#__PURE__*/_jsxs(\"div\", {\n        className: \"flex flex-col mb-6\",\n        children: [/*#__PURE__*/_jsxs(\"div\", {\n          className: \"jsx-1995394191\" + \" \" + \"flex items-center justify-between mb-2\",\n          children: [/*#__PURE__*/_jsxs(\"div\", {\n            className: \"jsx-1995394191\" + \" \" + \"flex\",\n            children: [/*#__PURE__*/_jsx(Label, {\n              children: \"Pilih Parameter Detail Tiket\"\n            }), /*#__PURE__*/_jsx(\"span\", {\n              className: \"jsx-1995394191\" + \" \" + \"core\"\n            })]\n          }), /*#__PURE__*/_jsx(\"div\", {\n            onClick: function onClick() {\n              setvaluecoreopt(coreopt);\n              var arr = [1, 1, 1, 1, 1, 1, 1, 1, 1];\n              setdatapayload(_objectSpread(_objectSpread({}, datapayload), {}, {\n                core_attributes: arr\n              }));\n            },\n            className: \"jsx-1995394191\",\n            children: /*#__PURE__*/_jsx(Text, {\n              color: \"green\",\n              cursor: \"pointer\",\n              children: \"Pilih Semua\"\n            })\n          }), /*#__PURE__*/_jsx(_JSXStyle, {\n            id: \"1995394191\",\n            children: [\".core.jsx-1995394191::before{content:'*';color:red;}\"]\n          })]\n        }), /*#__PURE__*/_jsx(\"div\", {\n          className: \"mb-2 flex\",\n          children: /*#__PURE__*/_jsx(Checkbox.Group, {\n            onChange: function onChange(values) {\n              setvaluecoreopt(values);\n              var arr = [0, 0, 0, 0, 0, 0, 0, 0, 0].map(function (_, idx) {\n                return values.includes(idx) ? 1 : 0;\n              });\n              setdatapayload(_objectSpread(_objectSpread({}, datapayload), {}, {\n                core_attributes: arr\n              }));\n              setdisabledtrigger(function (prev) {\n                return prev + 1;\n              });\n            },\n            value: valuecoreopt,\n            children: /*#__PURE__*/_jsxs(\"div\", {\n              className: \"flex flex-col\",\n              children: [/*#__PURE__*/_jsx(\"div\", {\n                className: \"mb-1\",\n                children: /*#__PURE__*/_jsx(Checkbox, {\n                  value: coreopt[0],\n                  children: \"No Tiket\"\n                })\n              }), /*#__PURE__*/_jsx(\"div\", {\n                className: \"mb-1\",\n                children: /*#__PURE__*/_jsx(Checkbox, {\n                  value: coreopt[1],\n                  children: \"Nama Pembuat\"\n                })\n              }), /*#__PURE__*/_jsx(\"div\", {\n                className: \"mb-1\",\n                children: /*#__PURE__*/_jsx(Checkbox, {\n                  value: coreopt[2],\n                  children: \"Lokasi Pembuatan Tiket\"\n                })\n              }), /*#__PURE__*/_jsx(\"div\", {\n                className: \"mb-1\",\n                children: /*#__PURE__*/_jsx(Checkbox, {\n                  value: coreopt[3],\n                  children: \"Tanggal Diajukan\"\n                })\n              }), /*#__PURE__*/_jsx(\"div\", {\n                className: \"mb-1\",\n                children: /*#__PURE__*/_jsx(Checkbox, {\n                  value: coreopt[4],\n                  children: \"Tanggal Ditutup\"\n                })\n              }), /*#__PURE__*/_jsx(\"div\", {\n                className: \"mb-1\",\n                children: /*#__PURE__*/_jsx(Checkbox, {\n                  value: coreopt[5],\n                  children: \"Durasi Pengerjaan\"\n                })\n              }), /*#__PURE__*/_jsx(\"div\", {\n                className: \"mb-1\",\n                children: /*#__PURE__*/_jsx(Checkbox, {\n                  value: coreopt[6],\n                  children: \"Nama Engineer\"\n                })\n              }), /*#__PURE__*/_jsx(\"div\", {\n                className: \"mb-1\",\n                children: /*#__PURE__*/_jsx(Checkbox, {\n                  value: coreopt[7],\n                  children: \"Status\"\n                })\n              })]\n            })\n          })\n        })]\n      }), /*#__PURE__*/_jsxs(\"div\", {\n        className: \"flex flex-col mb-6\",\n        children: [/*#__PURE__*/_jsx(\"div\", {\n          className: \"flex mb-2\",\n          children: /*#__PURE__*/_jsx(Label, {\n            children: \"Jenis Tiket\"\n          })\n        }), /*#__PURE__*/_jsx(_Select, {\n          allowClear: true,\n          placeholder: \"Pilih Jenis Ticket\",\n          style: {\n            width: \"100%\"\n          },\n          onChange: function onChange(value) {\n            setdatapayload(_objectSpread(_objectSpread({}, datapayload), {}, {\n              type: typeof value === 'undefined' ? null : value,\n              secondary_attributes: [1, 1, 1, 1, 1, 1, 1, 1]\n            }));\n            setvaluesecondopt(secondopt);\n          },\n          children: /*#__PURE__*/_jsx(_Select.Option, {\n            value: 1,\n            children: \"Incident\"\n          })\n        })]\n      }), datapayload.type === null ? /*#__PURE__*/_jsx(\"div\", {\n        children: /*#__PURE__*/_jsx(Label, {\n          children: \"Jika Jenis Tiket tidak dipilih, maka akan menampilkan semua parameter detail masalah\"\n        })\n      }) : /*#__PURE__*/_jsxs(\"div\", {\n        className: \"flex flex-col mb-6\",\n        children: [/*#__PURE__*/_jsxs(\"div\", {\n          className: \"flex items-center justify-between mb-2\",\n          children: [/*#__PURE__*/_jsx(\"div\", {\n            className: \"flex\",\n            children: /*#__PURE__*/_jsx(Label, {\n              children: \"Pilih Parameter Detail Masalah\"\n            })\n          }), /*#__PURE__*/_jsx(\"div\", {\n            onClick: function onClick() {\n              setvaluesecondopt(secondopt);\n              var arr = [1, 1, 1, 1, 1, 1, 1, 1];\n              setdatapayload(_objectSpread(_objectSpread({}, datapayload), {}, {\n                secondary_attributes: arr\n              }));\n            },\n            children: /*#__PURE__*/_jsx(Text, {\n              color: \"green\",\n              cursor: \"pointer\",\n              children: \"Pilih Semua\"\n            })\n          })]\n        }), /*#__PURE__*/_jsx(\"div\", {\n          className: \"mb-2 flex\",\n          children: /*#__PURE__*/_jsx(Checkbox.Group, {\n            onChange: function onChange(values) {\n              setvaluesecondopt(values);\n              var arr = [0, 0, 0, 0, 0, 0, 0, 0].map(function (_, idx) {\n                return values.includes(idx) ? 1 : 0;\n              });\n              setdatapayload(_objectSpread(_objectSpread({}, datapayload), {}, {\n                secondary_attributes: arr\n              }));\n            },\n            value: valuesecondopt,\n            children: /*#__PURE__*/_jsxs(\"div\", {\n              className: \"flex flex-col\",\n              children: [/*#__PURE__*/_jsx(\"div\", {\n                className: \"mb-1\",\n                children: /*#__PURE__*/_jsx(Checkbox, {\n                  value: secondopt[0],\n                  children: \"Jenis Aset\"\n                })\n              }), /*#__PURE__*/_jsx(\"div\", {\n                className: \"mb-1\",\n                children: /*#__PURE__*/_jsx(Checkbox, {\n                  value: secondopt[1],\n                  children: \"MIG ID Aset\"\n                })\n              }), /*#__PURE__*/_jsx(\"div\", {\n                className: \"mb-1\",\n                children: /*#__PURE__*/_jsx(Checkbox, {\n                  value: secondopt[2],\n                  children: \"Terminal ID\"\n                })\n              }), /*#__PURE__*/_jsx(\"div\", {\n                className: \"mb-1\",\n                children: /*#__PURE__*/_jsx(Checkbox, {\n                  value: secondopt[3],\n                  children: \"Nama PIC\"\n                })\n              }), /*#__PURE__*/_jsx(\"div\", {\n                className: \"mb-1\",\n                children: /*#__PURE__*/_jsx(Checkbox, {\n                  value: secondopt[4],\n                  children: \"Kontak PIC\"\n                })\n              }), /*#__PURE__*/_jsx(\"div\", {\n                className: \"mb-1\",\n                children: /*#__PURE__*/_jsx(Checkbox, {\n                  value: secondopt[5],\n                  children: \"Waktu Kejadian\"\n                })\n              }), /*#__PURE__*/_jsx(\"div\", {\n                className: \"mb-1\",\n                children: /*#__PURE__*/_jsx(Checkbox, {\n                  value: secondopt[6],\n                  children: \"Deskripsi Kerusakan\"\n                })\n              })]\n            })\n          })\n        })]\n      })]\n    })\n  });\n};\n\nexport default DrawerTicketExports;","map":null,"metadata":{},"sourceType":"module"}