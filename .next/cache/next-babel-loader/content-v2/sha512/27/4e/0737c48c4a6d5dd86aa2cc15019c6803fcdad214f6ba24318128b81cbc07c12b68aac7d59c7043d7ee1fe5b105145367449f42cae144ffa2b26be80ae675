{"ast":null,"code":"import _Modal from \"antd/lib/modal\";\nimport _Checkbox from \"antd/lib/checkbox\";\nimport _Form from \"antd/lib/form\";\nimport _Input from \"antd/lib/input\";\nimport _Button from \"antd/lib/button\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport _Switch from \"antd/lib/switch\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport _notification from \"antd/lib/notification\";\nimport _defineProperty from \"/home/kjokken/mig/code/frontend/ims-fe-ssh-dev/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _toConsumableArray from \"/home/kjokken/mig/code/frontend/ims-fe-ssh-dev/node_modules/next/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _Select from \"antd/lib/select\";\nimport _Anchor from \"antd/lib/anchor\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { useRouter } from 'next/router';\nimport { useState } from 'react';\nimport { DownOutlined, MinusCircleTwoTone } from '@ant-design/icons';\nimport Layout from '../../../../components/layout-dashboard';\nimport st from '../../../../components/layout-dashboard.module.css';\n\nfunction ServiceUpdate(_ref) {\n  var initProps = _ref.initProps,\n      dataProfile = _ref.dataProfile,\n      dataDetailServiceItem = _ref.dataDetailServiceItem,\n      dataListServiceItem = _ref.dataListServiceItem,\n      dataListServiceCategories = _ref.dataListServiceCategories,\n      serviceid = _ref.serviceid,\n      sidemenu = _ref.sidemenu;\n  var rt = useRouter();\n  var pathArr = rt.pathname.split(\"/\").slice(1);\n  pathArr[pathArr.length - 1] = dataDetailServiceItem.data.service.nama_service_item;\n  var Link = _Anchor.Link;\n  var Option = _Select.Option; //data\n\n  var dataListServiceItemMap = dataListServiceItem.data.filter(function (dataa) {\n    return dataa.id != serviceid;\n  }).map(function (doc, idx) {\n    return {\n      id: doc.id,\n      itemName: doc.nama_service_item,\n      categoryName: doc.nama_kategori,\n      usageType: 'Permanent',\n      status: doc.is_publish\n    };\n  }); //useState\n\n  var _useState = useState({\n    id: serviceid,\n    id_service_kategori: dataDetailServiceItem.data.service.id_service_kategori,\n    nama_service_item: dataDetailServiceItem.data.service.nama_service_item,\n    deskripsi_singkat: dataDetailServiceItem.data.service.deskripsi_singkat,\n    deskripsi_lengkap: dataDetailServiceItem.data.service.deskripsi_lengkap // new_child_ids: ''\n\n  }),\n      dataupdate = _useState[0],\n      setdataupdate = _useState[1];\n\n  var _useState2 = useState(dataDetailServiceItem.data.childs),\n      addfields = _useState2[0],\n      setaddfields = _useState2[1];\n\n  var _useState3 = useState(dataDetailServiceItem.data.childs.map(function (doc, idx) {\n    return doc.id;\n  })),\n      idfields = _useState3[0],\n      setidfields = _useState3[1];\n\n  var _useState4 = useState(false),\n      loadingupdate = _useState4[0],\n      setloadingupdate = _useState4[1];\n\n  var _useState5 = useState(false),\n      loadinghapus = _useState5[0],\n      setloadinghapus = _useState5[1];\n\n  var _useState6 = useState(false),\n      modalkonfhapuskateg = _useState6[0],\n      setmodalkonfhapuskateg = _useState6[1];\n\n  var _useState7 = useState(false),\n      modalpublish = _useState7[0],\n      setmodalpublish = _useState7[1];\n\n  var _useState8 = useState(false),\n      modalnonpublish = _useState8[0],\n      setmodalnonpublish = _useState8[1]; //onChange\n\n\n  var onChangeAddAdditionalItems = function onChangeAddAdditionalItems(val) {\n    var selectedData = dataListServiceItemMap.filter(function (dataa) {\n      return dataa.id == val;\n    }).map(function (doc, idx) {\n      return {\n        id: doc.id,\n        nama_service_item: doc.itemName\n      };\n    })[0];\n\n    if (selectedData) {\n      setaddfields([].concat(_toConsumableArray(addfields), [selectedData]));\n      setidfields(function (prev) {\n        return [].concat(_toConsumableArray(prev), [val]);\n      });\n    }\n  };\n\n  var onSearchAdditionalItems = function onSearchAdditionalItems(val) {\n    if (val === \"\") {\n      setaddfields(addfields);\n    }\n  };\n\n  var onDeleteAdditionalItems = function onDeleteAdditionalItems(id) {\n    setaddfields(function (prev) {\n      return prev.filter(function (dataa) {\n        return dataa.id !== id;\n      });\n    });\n    setidfields(function (prev) {\n      return prev.filter(function (dataa) {\n        return dataa !== id;\n      });\n    });\n  }; //handler\n\n\n  var handleUpdateService = function handleUpdateService() {\n    var objupdate = _objectSpread(_objectSpread({}, dataupdate), {}, {\n      new_child_ids: idfields\n    });\n\n    setloadingupdate(true);\n    fetch(\"https://boiling-thicket-46501.herokuapp.com/updateServiceItem\", {\n      method: 'PUT',\n      headers: {\n        'Authorization': JSON.parse(initProps),\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify(objupdate)\n    }).then(function (res) {\n      return res.json();\n    }).then(function (res2) {\n      if (res2.success) {\n        _notification['success']({\n          message: res2.message,\n          duration: 3\n        });\n\n        setTimeout(function () {\n          setloadingupdate(false); // rt.push(`/admin/service/${serviceid}`)\n\n          rt.push(\"/admin/service\");\n        }, 500);\n      } else if (!res2.success) {\n        _notification['error']({\n          message: res2.message.errorInfo.status_detail,\n          duration: 3\n        });\n\n        setloadingupdate(false);\n      }\n    });\n  };\n\n  var handleHapusService = function handleHapusService() {\n    setloadinghapus(true);\n    fetch(\"https://boiling-thicket-46501.herokuapp.com/deleteServiceItem\", {\n      method: 'DELETE',\n      headers: {\n        'Authorization': JSON.parse(initProps),\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        id: serviceid\n      })\n    }).then(function (res) {\n      return res.json();\n    }).then(function (res2) {\n      if (res2.success) {\n        _notification['success']({\n          message: res2.message,\n          duration: 3\n        });\n\n        setTimeout(function () {\n          setloadinghapus(false);\n          rt.push(\"/admin/service\");\n        }, 500);\n      } else if (!res2.success) {\n        _notification['error']({\n          message: res2.message.errorInfo.status_detail,\n          duration: 3\n        });\n\n        setloadinghapus(false);\n      }\n    });\n  };\n\n  var handlePublish = function handlePublish() {\n    setloadinghapus(true);\n    fetch(\"https://boiling-thicket-46501.herokuapp.com/depublishingServiceItem\", {\n      method: 'PUT',\n      headers: {\n        'Authorization': JSON.parse(initProps),\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        id: serviceid\n      })\n    }).then(function (res) {\n      return res.json();\n    }).then(function (res2) {\n      if (res2.success) {\n        _notification['success']({\n          message: res2.message,\n          duration: 3\n        });\n\n        setTimeout(function () {\n          setloadinghapus(false);\n          setmodalpublish(false); // rt.push(`/admin/service/${serviceid}`)\n\n          rt.push(\"/admin/service\");\n        }, 500);\n      } else if (!res2.success) {\n        _notification['error']({\n          message: res2.message.errorInfo.status_detail,\n          duration: 3\n        });\n\n        setloadinghapus(false);\n        setmodalpublish(false);\n      }\n    });\n  };\n\n  var handleNonPublish = function handleNonPublish() {\n    setloadinghapus(true);\n    fetch(\"https://boiling-thicket-46501.herokuapp.com/publishingServiceItem\", {\n      method: 'PUT',\n      headers: {\n        'Authorization': JSON.parse(initProps),\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        id: serviceid\n      })\n    }).then(function (res) {\n      return res.json();\n    }).then(function (res2) {\n      if (res2.success) {\n        _notification['success']({\n          message: res2.message,\n          duration: 3\n        });\n\n        setTimeout(function () {\n          setloadinghapus(false);\n          setmodalnonpublish(false);\n          rt.push(\"/admin/service/\".concat(serviceid));\n        }, 500);\n      } else if (!res2.success) {\n        _notification['error']({\n          message: res2.message.errorInfo.status_detail,\n          duration: 3\n        });\n\n        setloadinghapus(false);\n        setmodalnonpublish(false);\n      }\n    });\n  }; //Render Components\n  // const menu = (\n  //     <Menu>\n  //         <Menu.Item key=\"1\" onClick={handleUpdateService}>\n  //             Save & Publish\n  //       </Menu.Item>\n  //         <Menu.Item key=\"2\" onClick={handleUpdateService}>\n  //             Save As Draft\n  //       </Menu.Item>\n  //     </Menu>\n  // );\n  // const uploadButton = (\n  //     <div>\n  //         {loadingupload ? <LoadingOutlined /> : <PlusOutlined />}\n  //         <div style={{ marginTop: 8 }}>Unggah</div>\n  //     </div>\n  // );\n\n\n  return /*#__PURE__*/_jsx(Layout, {\n    tok: initProps,\n    dataProfile: dataProfile,\n    sidemenu: sidemenu,\n    pathArr: pathArr,\n    st: st,\n    children: /*#__PURE__*/_jsxs(\"div\", {\n      className: \"w-full border-t border-opacity-30 border-gray-500 bg-white\",\n      children: [/*#__PURE__*/_jsxs(\"div\", {\n        className: \"w-full flex flex-col md:flex-row justify-between p-3\",\n        children: [/*#__PURE__*/_jsxs(\"div\", {\n          className: \"flex items-center\",\n          children: [/*#__PURE__*/_jsx(\"p\", {\n            className: \"font-semibold text-lg mr-3 my-0\",\n            children: dataDetailServiceItem.data.service.nama_service_item\n          }), /*#__PURE__*/_jsx(_Fragment, {\n            children: /*#__PURE__*/_jsx(_Fragment, {\n              children: dataDetailServiceItem.data.service.is_publish ? /*#__PURE__*/_jsx(_Switch, {\n                checked: true,\n                onChange: function onChange() {\n                  setmodalpublish(true);\n                },\n                checkedChildren: \"Published\"\n              }) : /*#__PURE__*/_jsx(_Switch, {\n                checked: false,\n                onChange: function onChange() {\n                  setmodalnonpublish(true);\n                },\n                unCheckedChildren: \"Draft\"\n              })\n            })\n          })]\n        }), /*#__PURE__*/_jsxs(\"div\", {\n          className: \"pt-3\",\n          children: [/*#__PURE__*/_jsx(_Button, {\n            type: \"default\",\n            style: {\n              marginRight: \"1rem\"\n            },\n            onClick: function onClick() {\n              rt.push('/admin/service');\n            },\n            children: \"Cancel\"\n          }),\n          /*#__PURE__*/\n          // [191].every((curr) => dataProfile.data.registered_feature.includes(curr)) &&\n          _jsx(_Button, {\n            type: \"ghost\",\n            style: {\n              marginRight: \"1rem\"\n            },\n            onClick: function onClick() {\n              setmodalkonfhapuskateg(true);\n            },\n            children: \"Delete\"\n          }),\n          /*#__PURE__*/\n          // [190].every((curr) => dataProfile.data.registered_feature.includes(curr)) &&\n          _jsx(_Button, {\n            style: {\n              backgroundColor: \"rgb(24,144,255)\",\n              color: \"white\"\n            },\n            loading: loadingupdate,\n            onClick: handleUpdateService,\n            children: \"Save \"\n          })]\n        })]\n      }), /*#__PURE__*/_jsxs(\"div\", {\n        className: \"w-full grid grid-cols-7\",\n        children: [/*#__PURE__*/_jsx(\"div\", {\n          className: \"col-span-7 lg:col-span-1 flex flex-col p-3\",\n          children: /*#__PURE__*/_jsxs(_Anchor, {\n            children: [/*#__PURE__*/_jsx(Link, {\n              href: \"#generalDetail\",\n              title: \"General Detail\"\n            }), /*#__PURE__*/_jsx(Link, {\n              href: \"#customFields\",\n              title: \"Custom Fields\"\n            }), /*#__PURE__*/_jsx(Link, {\n              href: \"#additionalFields\",\n              title: \"Addtional Fields\"\n            }), /*#__PURE__*/_jsx(Link, {\n              href: \"#settings\",\n              title: \"Settings\"\n            })]\n          })\n        }), /*#__PURE__*/_jsxs(\"div\", {\n          className: \"col-span-7 lg:col-span-6 flex flex-col\",\n          children: [/*#__PURE__*/_jsxs(\"div\", {\n            id: \"generalDetail\",\n            className: \"mb-5 flex flex-col\",\n            children: [/*#__PURE__*/_jsxs(\"div\", {\n              className: \"flex justify-between items-center p-3\",\n              children: [/*#__PURE__*/_jsx(\"div\", {\n                children: /*#__PURE__*/_jsx(\"p\", {\n                  className: \"font-semibold text-base\",\n                  children: \"General Detail\"\n                })\n              }), /*#__PURE__*/_jsx(\"div\", {\n                children: /*#__PURE__*/_jsx(\"a\", {\n                  href: \"#\",\n                  children: \"Help\"\n                })\n              })]\n            }), /*#__PURE__*/_jsx(\"div\", {\n              className: \"flex p-3\",\n              children: /*#__PURE__*/_jsx(\"div\", {\n                className: \"w-full lg:w-7/12\",\n                children: /*#__PURE__*/_jsxs(_Form, {\n                  layout: \"vertical\",\n                  onFinish: handleUpdateService,\n                  initialValues: dataupdate,\n                  children: [/*#__PURE__*/_jsx(_Form.Item, {\n                    label: \"Item Name\",\n                    name: \"nama_service_item\",\n                    rules: [{\n                      required: true,\n                      message: 'Nama Item wajib diisi'\n                    }],\n                    children: /*#__PURE__*/_jsx(_Input, {\n                      name: \"nama_service_item\",\n                      onChange: function onChange(e) {\n                        setdataupdate(_objectSpread(_objectSpread({}, dataupdate), {}, {\n                          nama_service_item: e.target.value\n                        }));\n                      },\n                      defaultValue: dataupdate.nama_service_item\n                    })\n                  }), /*#__PURE__*/_jsx(_Form.Item, {\n                    label: \"Service Category\",\n                    name: \"id_service_kategori\",\n                    rules: [{\n                      required: true,\n                      message: 'Service Category wajib diisi'\n                    }],\n                    children: /*#__PURE__*/_jsx(_Select, {\n                      placeholder: \"Pilih Service Category\",\n                      onChange: function onChange(value) {\n                        setdataupdate(_objectSpread(_objectSpread({}, dataupdate), {}, {\n                          id_service_kategori: value\n                        }));\n                      },\n                      name: \"id_service_kategori\",\n                      defaultValue: dataupdate.id_service_kategori,\n                      children: dataListServiceCategories.data.map(function (doc, idx) {\n                        return /*#__PURE__*/_jsx(Option, {\n                          value: doc.id,\n                          children: doc.nama_kategori\n                        }, idx);\n                      })\n                    })\n                  }), /*#__PURE__*/_jsx(_Form.Item, {\n                    label: \"Short Description\",\n                    name: \"deskripsi_singkat\",\n                    children: /*#__PURE__*/_jsx(_Input, {\n                      name: \"deskripsi_singkat\",\n                      onChange: function onChange(e) {\n                        setdataupdate(_objectSpread(_objectSpread({}, dataupdate), {}, {\n                          deskripsi_singkat: e.target.value\n                        }));\n                      },\n                      defaultValue: dataupdate.deskripsi_singkat\n                    })\n                  }), /*#__PURE__*/_jsx(_Form.Item, {\n                    label: \"Description\",\n                    name: \"deskripsi_lengkap\",\n                    children: /*#__PURE__*/_jsx(_Input.TextArea, {\n                      name: \"deskripsi_lengkap\",\n                      onChange: function onChange(e) {\n                        setdataupdate(_objectSpread(_objectSpread({}, dataupdate), {}, {\n                          deskripsi_lengkap: e.target.value\n                        }));\n                      },\n                      defaultValue: dataupdate.deskripsi_lengkap\n                    })\n                  })]\n                })\n              })\n            })]\n          }), /*#__PURE__*/_jsx(\"div\", {\n            id: \"customFields\",\n            className: \" h-96 mb-5\",\n            children: /*#__PURE__*/_jsx(\"div\", {\n              className: \"flex justify-between items-center p-3\",\n              children: /*#__PURE__*/_jsx(\"div\", {\n                children: /*#__PURE__*/_jsx(\"p\", {\n                  className: \"font-semibold text-base\",\n                  children: \"Custom Fields\"\n                })\n              })\n            })\n          }), /*#__PURE__*/_jsxs(\"div\", {\n            id: \"additionalFields\",\n            className: \" flex flex-col mb-5 p-3\",\n            children: [/*#__PURE__*/_jsx(\"h1\", {\n              className: \"font-semibold text-base\",\n              children: \"Additional Items\"\n            }), /*#__PURE__*/_jsx(\"p\", {\n              className: \"text-xs text-gray-500\",\n              children: \"Add related service items that can be requested along with this item\"\n            }),\n            /*#__PURE__*/\n            // [190].every((curr) => dataProfile.data.registered_feature.includes(curr)) &&\n            _jsx(_Select, {\n              showSearch: true,\n              placeholder: \"Cari & Tambah Service Items\",\n              onChange: onChangeAddAdditionalItems,\n              onSearch: function onSearch(value) {\n                onSearchAdditionalItems(value);\n              },\n              optionFilterProp: \"children\",\n              filterOption: function filterOption(input, option) {\n                return option.children.toLowerCase().indexOf(input.toLowerCase()) >= 0;\n              },\n              style: {\n                marginBottom: \"0.7rem\",\n                width: \"20rem\"\n              },\n              allowClear: true,\n              children: dataListServiceItemMap.map(function (doc, idx) {\n                return /*#__PURE__*/_jsx(Option, {\n                  value: doc.id,\n                  children: doc.itemName\n                }, idx);\n              })\n            }), /*#__PURE__*/_jsx(\"div\", {\n              className: \"flex flex-col\",\n              children: addfields.map(function (doc, idx) {\n                return /*#__PURE__*/_jsxs(\"div\", {\n                  className: \" w-6/12 flex justify-between border-2 border-blue-500 p-3 divide-x-2 mb-2\",\n                  children: [/*#__PURE__*/_jsxs(\"div\", {\n                    className: \"flex items-center\",\n                    children: [\n                    /*#__PURE__*/\n                    // [190].every((curr) => dataProfile.data.registered_feature.includes(curr)) &&\n                    _jsx(MinusCircleTwoTone, {\n                      style: {\n                        marginRight: \"0.5rem\",\n                        cursor: \"pointer\"\n                      },\n                      onClick: function onClick() {\n                        onDeleteAdditionalItems(doc.id);\n                      }\n                    }), doc.nama_service_item]\n                  }), /*#__PURE__*/_jsxs(\"div\", {\n                    className: \"flex pl-3\",\n                    children: [/*#__PURE__*/_jsx(_Checkbox, {\n                      disabled: true,\n                      style: {\n                        marginRight: \"0.7rem\"\n                      }\n                    }), \" Tandai sebagai Wajib\"]\n                  })]\n                });\n              })\n            })]\n          }), /*#__PURE__*/_jsx(\"div\", {\n            id: \"settings\",\n            className: \" h-96 mb-5\",\n            children: /*#__PURE__*/_jsx(\"div\", {\n              className: \"flex justify-between items-center p-3\",\n              children: /*#__PURE__*/_jsx(\"div\", {\n                children: /*#__PURE__*/_jsx(\"p\", {\n                  className: \"font-semibold text-base\",\n                  children: \"Settings\"\n                })\n              })\n            })\n          }), /*#__PURE__*/_jsxs(_Modal, {\n            title: \"Konfirmasi Hapus Service Item\",\n            visible: modalkonfhapuskateg,\n            okButtonProps: {\n              disabled: loadinghapus\n            },\n            onCancel: function onCancel() {\n              setmodalkonfhapuskateg(false);\n            },\n            onOk: handleHapusService,\n            maskClosable: false,\n            style: {\n              top: \"3rem\"\n            },\n            width: 500,\n            destroyOnClose: true,\n            children: [\"Yakin ingin hapus Service Item: \", /*#__PURE__*/_jsx(\"strong\", {\n              children: dataDetailServiceItem.data.service.nama_service_item\n            }), \"?\"]\n          }), /*#__PURE__*/_jsxs(_Modal, {\n            title: \"Konfirmasi Draft Service Item\",\n            visible: modalpublish,\n            okButtonProps: {\n              disabled: loadinghapus\n            },\n            onCancel: function onCancel() {\n              setmodalpublish(false);\n            },\n            onOk: handlePublish,\n            maskClosable: false,\n            style: {\n              top: \"3rem\"\n            },\n            width: 500,\n            destroyOnClose: true,\n            children: [\"Yakin ingin mengubah status menjadi draft pada Service Item: \", /*#__PURE__*/_jsx(\"strong\", {\n              children: dataDetailServiceItem.data.service.nama_service_item\n            }), \"?\"]\n          }), /*#__PURE__*/_jsxs(_Modal, {\n            title: \"Konfirmasi Publish Service Item\",\n            visible: modalnonpublish,\n            okButtonProps: {\n              disabled: loadinghapus\n            },\n            onCancel: function onCancel() {\n              setmodalnonpublish(false);\n            },\n            onOk: handleNonPublish,\n            maskClosable: false,\n            style: {\n              top: \"3rem\"\n            },\n            width: 500,\n            destroyOnClose: true,\n            children: [\"Yakin ingin mengubah status menjadi Published pada Service Item: \", /*#__PURE__*/_jsx(\"strong\", {\n              children: dataDetailServiceItem.data.service.nama_service_item\n            }), \"?\"]\n          })]\n        })]\n      })]\n    })\n  });\n}\n\nexport var __N_SSP = true;\nexport default ServiceUpdate;","map":null,"metadata":{},"sourceType":"module"}