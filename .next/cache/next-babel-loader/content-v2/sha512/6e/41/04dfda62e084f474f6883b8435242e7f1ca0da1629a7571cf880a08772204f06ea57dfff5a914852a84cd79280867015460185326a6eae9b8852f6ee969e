{"ast":null,"code":"// import Formidable from \"Formidable\";\n// const fs = require(\"fs\");\n// export const config = {\n//   api: {\n//     bodyParser: false\n//   }\n// };\n// const uploadForm = next => (req, res) => {\n//   return new Promise(async (resolve, reject) => {\n//     try {\n//       const form = new Formidable.IncomingForm({\n//         multiples: true,\n//         keepExtensions: true\n//       });\n//       form.once(\"error\", console.error);\n//       form\n//         .on(\"fileBegin\", (name, file) => {\n//           console.log(\"start uploading: \", file.name);\n//         })\n//         .on(\"aborted\", () => console.log(\"Aborted...\"));\n//       form.once(\"end\", () => {\n//         console.log(\"Done!\");\n//       });\n//       await form.parse(req, async (err, fields, files) => {\n//         if (err) {\n//           throw String(JSON.stringify(err, null, 2));\n//         }\n//         console.log(\n//           \"moving file: \",\n//           files.file.path,\n//           \" to \",\n//           `public/upload/${files.file}`\n//         );\n//         // await fs.rename(\n//         //   files.file.path,\n//         //   `public/upload/${files.file.name}`,\n//         //   err => {\n//         //     if (err) throw err;\n//         //   }\n//         // );\n//         // fs.renameSync(files.file.path, `public/upload/${files.file.name}`);\n//         req.form = { fields, files };\n//         return resolve(next(req, res));\n//       });\n//     } catch (error) {\n//       return resolve(res.status(403).send(error));\n//     }\n//   });\n// };\n// function handler(req, res) {\n//   try {\n//     if (req.method === \"POST\") {\n//       res.status(200).send(req.form);\n//     } else {\n//       throw String(\"Method not allowed\");\n//     }\n//   } catch (error) {\n//     res.status(400).json({ message: JSON.stringify(error, null, 2) });\n//   }\n// }\n// export default uploadForm(handler);","map":null,"metadata":{},"sourceType":"script"}