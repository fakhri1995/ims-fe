{"ast":null,"code":"import _Select from \"antd/lib/select\";\nimport _defineProperty from \"/home/kjokken/mig/code/frontend/ims-fe-ssh-dev/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _TreeSelect from \"antd/lib/tree-select\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport _Spin from \"antd/lib/spin\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport _notification from \"antd/lib/notification\";\nimport _JSXStyle from \"styled-jsx/style\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useState, useEffect } from 'react';\nimport DrawerCore from '../drawerCore';\nimport { Label } from '../../typography';\nimport { SearchOutlined } from '@ant-design/icons';\n\nfunction modifData(dataa) {\n  for (var i = 0; i < dataa.length; i++) {\n    dataa[i]['key'] = dataa[i].id;\n    dataa[i]['value'] = dataa[i].id;\n\n    if (dataa[i].children) {\n      modifData(dataa[i].children);\n    }\n  }\n\n  return dataa;\n}\n\nvar DrawerTicketConnectItem = function DrawerTicketConnectItem(_ref) {\n  var title = _ref.title,\n      visible = _ref.visible,\n      onvisible = _ref.onvisible,\n      onClose = _ref.onClose,\n      buttonOkText = _ref.buttonOkText,\n      disabled = _ref.disabled,\n      initProps = _ref.initProps,\n      refresh = _ref.refresh,\n      setrefresh = _ref.setrefresh,\n      setrefreshclosed = _ref.setrefreshclosed,\n      datapayload = _ref.datapayload,\n      setdatapayload = _ref.setdatapayload,\n      selectedassettype = _ref.selectedassettype,\n      setselectedassettype = _ref.setselectedassettype,\n      ticketid = _ref.ticketid;\n\n  //useState\n  var _useState = useState(false),\n      loadingsave = _useState[0],\n      setloadingsave = _useState[1];\n\n  var _useState2 = useState(false),\n      loadinggetasset = _useState2[0],\n      setloadinggetasset = _useState2[1];\n\n  var _useState3 = useState([]),\n      dataassettype = _useState3[0],\n      setdataassettype = _useState3[1];\n\n  var _useState4 = useState([]),\n      dataasset = _useState4[0],\n      setdataasset = _useState4[1];\n\n  var _useState5 = useState(false),\n      fetchingdataasset = _useState5[0],\n      setfetchingdataasset = _useState5[1];\n\n  var _useState6 = useState(true),\n      disabledcreate = _useState6[0],\n      setdisabledcreate = _useState6[1];\n\n  var _useState7 = useState(-1),\n      disabledtrigger = _useState7[0],\n      setdisabledtrigger = _useState7[1]; //handler\n\n\n  var handleSetAsset = function handleSetAsset() {\n    setloadingsave(true);\n    setdisabledcreate(true);\n    fetch(\"https://boiling-thicket-46501.herokuapp.com/setItemTicket\", {\n      method: 'PUT',\n      headers: {\n        'Authorization': JSON.parse(initProps),\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify(datapayload)\n    }).then(function (res) {\n      return res.json();\n    }).then(function (res2) {\n      setloadingsave(false);\n      setdisabledcreate(false);\n\n      if (res2.success) {\n        setrefresh(function (prev) {\n          return prev + 1;\n        });\n        onvisible(false);\n        setdatapayload({\n          id: Number(ticketid),\n          inventory_id: null\n        });\n\n        _notification['success']({\n          message: res2.message,\n          duration: 3\n        });\n      } else {\n        _notification['error']({\n          message: res2.message,\n          duration: 3\n        });\n      }\n    });\n  }; //useEffect\n\n\n  useEffect(function () {\n    fetch(\"https://boiling-thicket-46501.herokuapp.com/getAssets\", {\n      method: \"GET\",\n      headers: {\n        'Authorization': JSON.parse(initProps)\n      }\n    }).then(function (res) {\n      return res.json();\n    }).then(function (res2) {\n      var assettypemap = modifData(res2.data);\n      setdataassettype(assettypemap);\n    });\n  }, []);\n  useEffect(function () {\n    fetch(\"https://boiling-thicket-46501.herokuapp.com/getFilterInventories\", {\n      method: \"GET\",\n      headers: {\n        'Authorization': JSON.parse(initProps)\n      }\n    }).then(function (res) {\n      return res.json();\n    }).then(function (res2) {\n      setdataasset(res2.data);\n    });\n  }, []);\n  useEffect(function () {\n    if (datapayload.inventory_id !== null) {\n      setdisabledcreate(false);\n    } else {\n      setdisabledcreate(true);\n    }\n  }, [disabledtrigger]);\n  return /*#__PURE__*/_jsx(DrawerCore, {\n    title: title,\n    visible: visible,\n    onClose: function onClose() {\n      setrefreshclosed(function (prev) {\n        return prev + 1;\n      });\n      setdatapayload({\n        id: Number(ticketid),\n        inventory_id: null\n      });\n      onvisible(false);\n    },\n    buttonOkText: buttonOkText,\n    onClick: handleSetAsset,\n    disabled: disabledcreate,\n    children: loadingsave ? /*#__PURE__*/_jsx(_Fragment, {\n      children: /*#__PURE__*/_jsx(_Spin, {})\n    }) : /*#__PURE__*/_jsxs(\"div\", {\n      className: \"flex flex-col\",\n      children: [/*#__PURE__*/_jsx(\"div\", {\n        className: \"mb-6\",\n        children: /*#__PURE__*/_jsx(\"p\", {\n          className: \"mb-0 text-red-500 text-xs italic\",\n          children: \"*Informasi ini harus diisi\"\n        })\n      }), /*#__PURE__*/_jsxs(\"div\", {\n        className: \"flex flex-col mb-6\",\n        children: [/*#__PURE__*/_jsxs(\"div\", {\n          className: \"jsx-2185086480\" + \" \" + \"flex mb-2\",\n          children: [/*#__PURE__*/_jsx(Label, {\n            children: \"Tipe Aset\"\n          }), /*#__PURE__*/_jsx(\"span\", {\n            className: \"jsx-2185086480\" + \" \" + \"assettypes\"\n          }), /*#__PURE__*/_jsx(_JSXStyle, {\n            id: \"2185086480\",\n            children: [\".assettypes.jsx-2185086480::before{content:'*';color:red;}\"]\n          })]\n        }), /*#__PURE__*/_jsx(\"div\", {\n          className: \" mb-2 flex\",\n          children: /*#__PURE__*/_jsx(_TreeSelect, {\n            style: {\n              width: \"100%\"\n            },\n            showArrow: true,\n            name: \"asset_type\",\n            onChange: function onChange(value, label, extra) {\n              setselectedassettype(extra.allCheckedNodes[0].node.props.id);\n              setloadinggetasset(true);\n              fetch(\"https://boiling-thicket-46501.herokuapp.com/getFilterInventories?asset_id=\".concat(extra.allCheckedNodes[0].node.props.id), {\n                method: \"GET\",\n                headers: {\n                  'Authorization': JSON.parse(initProps)\n                }\n              }).then(function (res) {\n                return res.json();\n              }).then(function (res2) {\n                console.log(res2);\n                setdataasset(res2.data);\n                setloadinggetasset(false);\n              });\n            },\n            treeData: dataassettype,\n            treeDefaultExpandAll: true,\n            value: selectedassettype\n          })\n        })]\n      }), /*#__PURE__*/_jsx(\"div\", {\n        className: \"flex flex-col mb-6\",\n        children: /*#__PURE__*/_jsx(\"div\", {\n          className: \" mb-2 flex\",\n          children: /*#__PURE__*/_jsx(_Select, {\n            style: {\n              width: \"100%\"\n            },\n            placeholder: \"Nama aset...\",\n            suffixIcon: /*#__PURE__*/_jsx(SearchOutlined, {}),\n            showArrow: true,\n            onChange: function onChange(value, option) {\n              setdatapayload(_objectSpread(_objectSpread({}, datapayload), {}, {\n                inventory_id: value\n              }));\n              setdisabledtrigger(function (prev) {\n                return prev + 1;\n              });\n            },\n            loading: loadinggetasset,\n            showSearch: true,\n            optionFilterProp: \"children\",\n            notFoundContent: fetchingdataasset ? /*#__PURE__*/_jsx(_Spin, {\n              size: \"small\"\n            }) : null,\n            onSearch: function onSearch(value) {\n              setfetchingdataasset(true);\n              fetch(\"https://boiling-thicket-46501.herokuapp.com/getFilterInventories?asset_id=\".concat(selectedassettype, \"&keyword=\").concat(value), {\n                method: \"GET\",\n                headers: {\n                  'Authorization': JSON.parse(initProps)\n                }\n              }).then(function (res) {\n                return res.json();\n              }).then(function (res2) {\n                setdataasset(res2.data);\n                setfetchingdataasset(false);\n              });\n            },\n            value: datapayload.inventory_id,\n            children: dataasset.map(function (doc, idx) {\n              return /*#__PURE__*/_jsxs(_Select.Option, {\n                value: doc.id,\n                children: [doc.mig_id, \" - \", doc.model_name, \" - \", doc.asset_name]\n              }, idx);\n            })\n          })\n        })\n      })]\n    })\n  });\n};\n\nexport default DrawerTicketConnectItem;","map":null,"metadata":{},"sourceType":"module"}