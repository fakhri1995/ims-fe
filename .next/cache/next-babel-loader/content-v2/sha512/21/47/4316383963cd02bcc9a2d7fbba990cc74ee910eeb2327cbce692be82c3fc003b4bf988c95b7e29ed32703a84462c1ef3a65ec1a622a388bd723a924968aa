{"ast":null,"code":"import _Input from \"antd/lib/input\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport _defineProperty from \"/tmp/mig/ims-fe/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport _Spin from \"antd/lib/spin\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport _notification from \"antd/lib/notification\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { SearchOutlined } from \"@ant-design/icons\";\nimport React, { useEffect, useState } from \"react\";\nimport { UserIconSvg } from \"../../icon\";\nimport { H2, Label } from \"../../typography\";\nimport DrawerCore from \"../drawerCore\";\n\nvar DrawerTicketAssign = function DrawerTicketAssign(_ref) {\n  var title = _ref.title,\n      visible = _ref.visible,\n      onvisible = _ref.onvisible,\n      onClose = _ref.onClose,\n      buttonOkText = _ref.buttonOkText,\n      disabled = _ref.disabled,\n      initProps = _ref.initProps,\n      refresh = _ref.refresh,\n      setrefresh = _ref.setrefresh,\n      setrefreshclosed = _ref.setrefreshclosed,\n      datapayload = _ref.datapayload,\n      setdatapayload = _ref.setdatapayload,\n      ticketid = _ref.ticketid;\n\n  //useState\n  var _useState = useState([]),\n      listengs = _useState[0],\n      setlistengs = _useState[1];\n\n  var _useState2 = useState(false),\n      loadinggetengs = _useState2[0],\n      setloadinggetengs = _useState2[1];\n\n  var _useState3 = useState([]),\n      listgroups = _useState3[0],\n      setlistgroups = _useState3[1];\n\n  var _useState4 = useState(false),\n      loadinggetgroups = _useState4[0],\n      setloadinggetgroups = _useState4[1];\n\n  var _useState5 = useState(false),\n      loadingsave = _useState5[0],\n      setloadingsave = _useState5[1];\n\n  var _useState6 = useState(true),\n      disabledcreate = _useState6[0],\n      setdisabledcreate = _useState6[1];\n\n  var _useState7 = useState(-1),\n      disabledtrigger = _useState7[0],\n      setdisabledtrigger = _useState7[1]; //handler\n\n\n  var handleAssign = function handleAssign() {\n    setloadingsave(true);\n    setdisabledcreate(true);\n    fetch(\"\".concat(process.env.NEXT_PUBLIC_BACKEND_URL, \"/assignTicket\"), {\n      method: \"PUT\",\n      headers: {\n        Authorization: JSON.parse(initProps),\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify(datapayload)\n    }).then(function (res) {\n      return res.json();\n    }).then(function (res2) {\n      setloadingsave(false);\n      setdisabledcreate(false);\n\n      if (res2.success) {\n        setrefresh(function (prev) {\n          return prev + 1;\n        });\n        onvisible(false);\n\n        _notification[\"success\"]({\n          message: res2.message,\n          duration: 3\n        });\n      } else {\n        _notification[\"error\"]({\n          message: res2.message,\n          duration: 3\n        });\n      }\n    });\n  }; //useEffect\n\n\n  useEffect(function () {\n    /** NOTE: `assignable_type` === 0 is for group */\n    fetch(\"\".concat(process.env.NEXT_PUBLIC_BACKEND_URL, \"/getAssignToList?assignable_type=0\"), {\n      method: \"GET\",\n      headers: {\n        Authorization: JSON.parse(initProps)\n      }\n    }).then(function (res) {\n      return res.json();\n    }).then(function (res2) {\n      setlistgroups(res2.data);\n    });\n  }, []);\n  useEffect(function () {\n    /** NOTE: `assignable_type` === 1 is for an engineer (individual) */\n    fetch(\"\".concat(process.env.NEXT_PUBLIC_BACKEND_URL, \"/getAssignToList?assignable_type=1\"), {\n      method: \"GET\",\n      headers: {\n        Authorization: JSON.parse(initProps)\n      }\n    }).then(function (res) {\n      return res.json();\n    }).then(function (res2) {\n      setlistengs(res2.data);\n    });\n  }, []);\n  useEffect(function () {\n    if (datapayload.assignable_id !== null) {\n      setdisabledcreate(false);\n    } else {\n      setdisabledcreate(true);\n    }\n  }, [disabledtrigger]);\n  return /*#__PURE__*/_jsx(DrawerCore, {\n    title: title,\n    visible: visible,\n    onClose: function onClose() {\n      setrefreshclosed(function (prev) {\n        return prev + 1;\n      });\n      onvisible(false);\n    },\n    buttonOkText: buttonOkText,\n    onClick: handleAssign,\n    disabled: disabledcreate,\n    children: loadingsave ? /*#__PURE__*/_jsx(_Fragment, {\n      children: /*#__PURE__*/_jsx(_Spin, {})\n    }) : /*#__PURE__*/_jsxs(\"div\", {\n      className: \" flex flex-col px-3\",\n      children: [/*#__PURE__*/_jsxs(\"div\", {\n        className: \" my-5 flex items-center\",\n        children: [/*#__PURE__*/_jsx(\"div\", {\n          id: \"ind\",\n          className: \"mr-4 text-primary100 bg-white hover:bg-primary100 hover:border-primary100 border-2 hover:text-white border-primary100 \".concat(datapayload.assignable_type === false && \"border-opacity-20\", \" px-6 btn btn-sm\"),\n          onClick: function onClick() {\n            setdatapayload(_objectSpread(_objectSpread({}, datapayload), {}, {\n              assignable_type: true\n            }));\n          },\n          children: \"Individu\"\n        }), /*#__PURE__*/_jsx(\"div\", {\n          id: \"grup\",\n          className: \"mr-4 text-primary100 bg-white hover:bg-primary100 hover:border-primary100 border-2 hover:text-white border-primary100 \".concat(datapayload.assignable_type === true && \"border-opacity-20\", \" px-6 btn btn-sm\"),\n          onClick: function onClick() {\n            setdatapayload(_objectSpread(_objectSpread({}, datapayload), {}, {\n              assignable_type: false\n            }));\n          },\n          children: \"Grup\"\n        })]\n      }), /*#__PURE__*/_jsx(\"div\", {\n        className: \"my-5\",\n        children: /*#__PURE__*/_jsx(_Input, {\n          suffix: /*#__PURE__*/_jsx(SearchOutlined, {}),\n          allowClear: true,\n          placeholder: \"Nama Staff, Group..\",\n          onChange: function onChange(e) {\n            if (datapayload.assignable_type === true) {\n              setloadinggetengs(true);\n              fetch(\"\".concat(process.env.NEXT_PUBLIC_BACKEND_URL, \"/getAssignToList?assignable_type=1&name=\").concat(e.target.value), {\n                method: \"GET\",\n                headers: {\n                  Authorization: JSON.parse(initProps)\n                }\n              }).then(function (res) {\n                return res.json();\n              }).then(function (res2) {\n                setlistengs(res2.data);\n                setloadinggetengs(false);\n              });\n            } else {\n              setloadinggetgroups(true);\n              fetch(\"\".concat(process.env.NEXT_PUBLIC_BACKEND_URL, \"/getAssignToList?assignable_type=0&name=\").concat(e.target.value), {\n                method: \"GET\",\n                headers: {\n                  Authorization: JSON.parse(initProps)\n                }\n              }).then(function (res) {\n                return res.json();\n              }).then(function (res2) {\n                setlistgroups(res2.data);\n                setloadinggetgroups(false);\n              });\n            }\n          }\n        })\n      }), /*#__PURE__*/_jsxs(\"div\", {\n        className: \"my-5 flex flex-col max-h-screen overflow-y-scroll\",\n        children: [loadinggetengs ? /*#__PURE__*/_jsx(_Fragment, {\n          children: /*#__PURE__*/_jsx(_Spin, {})\n        }) : datapayload.assignable_type === true && listengs.map(function (eng, idx) {\n          return /*#__PURE__*/_jsxs(\"div\", {\n            className: \"\".concat(datapayload.assignable_id === eng.id && \"bg-primary10\", \" mb-4 flex items-center cursor-pointer\"),\n            onClick: function onClick() {\n              setdatapayload(_objectSpread(_objectSpread({}, datapayload), {}, {\n                assignable_id: eng.id\n              }));\n              setdisabledtrigger(function (prev) {\n                return prev + 1;\n              });\n            },\n            children: [/*#__PURE__*/_jsx(\"div\", {\n              className: \" w-10 h-10 rounded-full mr-3\",\n              children: /*#__PURE__*/_jsx(\"img\", {\n                src: eng.profile_image === \"\" || eng.profile_image === \"-\" ? \"/image/staffTask.png\" : \"\".concat(eng.profile_image),\n                className: \" object-contain w-10 h-10\",\n                alt: \"\"\n              })\n            }), /*#__PURE__*/_jsxs(\"div\", {\n              className: \" flex flex-col justify-center\",\n              children: [/*#__PURE__*/_jsx(\"div\", {\n                className: \"mb-1 flex\",\n                children: /*#__PURE__*/_jsx(\"div\", {\n                  className: \"mr-1\",\n                  children: /*#__PURE__*/_jsx(H2, {\n                    children: eng.name\n                  })\n                })\n              }), /*#__PURE__*/_jsx(\"div\", {\n                children: /*#__PURE__*/_jsx(Label, {\n                  children: eng.position\n                })\n              })]\n            })]\n          });\n        }), loadinggetgroups ? /*#__PURE__*/_jsx(_Fragment, {\n          children: /*#__PURE__*/_jsx(_Spin, {})\n        }) : datapayload.assignable_type === false && listgroups.map(function (group, idx) {\n          return /*#__PURE__*/_jsxs(\"div\", {\n            className: \"\".concat(datapayload.assignable_id === group.id && \"bg-primary10\", \" mb-4 flex items-center cursor-pointer\"),\n            onClick: function onClick() {\n              setdatapayload(_objectSpread(_objectSpread({}, datapayload), {}, {\n                assignable_id: group.id\n              }));\n              setdisabledtrigger(function (prev) {\n                return prev + 1;\n              });\n            },\n            children: [/*#__PURE__*/_jsx(\"div\", {\n              className: \" w-10 h-10 rounded-full mr-3\",\n              children: /*#__PURE__*/_jsx(UserIconSvg, {})\n            }), /*#__PURE__*/_jsx(\"div\", {\n              className: \" flex flex-col justify-center\",\n              children: /*#__PURE__*/_jsx(\"div\", {\n                className: \"mb-1 flex\",\n                children: /*#__PURE__*/_jsx(\"div\", {\n                  className: \"mr-1\",\n                  children: /*#__PURE__*/_jsx(H2, {\n                    children: group.name\n                  })\n                })\n              })\n            })]\n          });\n        })]\n      })]\n    })\n  });\n};\n\nexport default DrawerTicketAssign;","map":null,"metadata":{},"sourceType":"module"}