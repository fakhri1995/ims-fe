{"ast":null,"code":"import _Checkbox from \"antd/lib/checkbox\";\nimport _Form from \"antd/lib/form\";\nimport _Input from \"antd/lib/input\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport _Button from \"antd/lib/button\";\nimport _Menu from \"antd/lib/menu\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport _notification from \"antd/lib/notification\";\nimport _Select from \"antd/lib/select\";\nimport _Anchor from \"antd/lib/anchor\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport { useRouter } from 'next/router';\nimport { useState } from 'react';\nimport httpcookie from 'cookie';\nimport { DownOutlined, MinusCircleTwoTone } from '@ant-design/icons';\nimport Layout from '../../../../components/layout-dashboard';\nimport st from '../../../../components/layout-dashboard.module.css';\n\nfunction ServiceCreate({\n  initProps,\n  dataProfile,\n  dataListServiceCategories,\n  dataListServiceItem,\n  sidemenu\n}) {\n  const rt = useRouter();\n  const pathArr = rt.pathname.split(\"/\").slice(1);\n  const {\n    Link\n  } = _Anchor;\n  const {\n    Option\n  } = _Select; //data Source\n\n  const dataListServiceItemMap = dataListServiceItem.data.map((doc, idx) => {\n    return {\n      id: doc.id,\n      itemName: doc.nama_service_item,\n      categoryName: doc.nama_kategori,\n      usageType: 'Permanent',\n      status: doc.is_publish\n    };\n  }); // const dataSource = [\n  //     {\n  //         key: '1',\n  //         itemName: 'Adobe Illustrator',\n  //         categoryName: 'Software Installation',\n  //         usageType: 'Permanent',\n  //         status: 'Published'\n  //     },\n  //     {\n  //         key: '2',\n  //         itemName: 'Adobe Photoshop CS6',\n  //         categoryName: 'Software Installation',\n  //         usageType: 'Permanent',\n  //         status: 'Published'\n  //     },\n  //     {\n  //         key: '3',\n  //         itemName: 'Microsoft Outlook',\n  //         categoryName: 'Software Installation',\n  //         usageType: 'Permanent',\n  //         status: 'Published'\n  //     },\n  //     {\n  //         key: '4',\n  //         itemName: 'Microsoft Excel',\n  //         categoryName: 'Software Installation',\n  //         usageType: 'Permanent',\n  //         status: 'Published'\n  //     },\n  //     {\n  //         key: '5',\n  //         itemName: 'Apple Macbook',\n  //         categoryName: 'Hardware Provisioning',\n  //         usageType: 'Permanent',\n  //         status: 'Published'\n  //     },\n  //     {\n  //         key: '6',\n  //         itemName: 'Scan Printer Epson',\n  //         categoryName: 'Hardware Provisioning',\n  //         usageType: 'Permanent',\n  //         status: 'Published'\n  //     },\n  //     {\n  //         key: '7',\n  //         itemName: 'Employement Verification Letter',\n  //         categoryName: 'HR Management',\n  //         usageType: 'Permanent',\n  //         status: 'Published'\n  //     },\n  // ];\n  //UseState\n\n  const {\n    0: idfields,\n    1: setidfields\n  } = useState([]);\n  const {\n    0: datanew,\n    1: setdatanew\n  } = useState({\n    id_service_kategori: '',\n    nama_service_item: '',\n    deskripsi_singkat: '',\n    deskripsi_lengkap: '' // child_ids: []\n\n  });\n  const {\n    0: addfields,\n    1: setaddfields\n  } = useState([]);\n  const {\n    0: loadingbtntambahitem,\n    1: setloadingbtntambahitem\n  } = useState(false); // const [loadingupload, setloadingupload] = useState(false)\n  //onChange\n\n  const onChangeAddAdditionalItems = val => {\n    const selectedData = dataListServiceItemMap.filter(dataa => {\n      return dataa.id == val;\n    })[0];\n\n    if (selectedData) {\n      setaddfields([...addfields, selectedData]);\n      setidfields(prev => [...prev, val]);\n    }\n  };\n\n  const onSearchAdditionalItems = val => {\n    if (val === \"\") {\n      setaddfields(addfields);\n    }\n  };\n\n  const onDeleteAdditionalItems = id => {\n    setaddfields(prev => prev.filter(dataa => {\n      return dataa.id !== id;\n    }));\n    setidfields(prev => prev.filter(dataa => {\n      return dataa !== id;\n    }));\n  }; //handler\n\n\n  const handleCreateService = () => {\n    const objnew = _objectSpread(_objectSpread({}, datanew), {}, {\n      child_ids: idfields\n    });\n\n    setloadingbtntambahitem(true);\n    fetch(`https://boiling-thicket-46501.herokuapp.com/addServiceItem`, {\n      method: 'POST',\n      headers: {\n        'Authorization': JSON.parse(initProps),\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify(objnew)\n    }).then(res => res.json()).then(res2 => {\n      if (res2.success) {\n        _notification['success']({\n          message: res2.message,\n          duration: 3\n        });\n\n        setTimeout(() => {\n          setloadingbtntambahitem(false);\n          rt.push(`/admin/service`);\n        }, 500);\n      } else if (!res2.success) {\n        _notification['error']({\n          message: res2.message.errorInfo.status_detail,\n          duration: 3\n        });\n\n        setloadingbtntambahitem(false);\n      }\n    });\n  }; //Render Components\n\n\n  const menu = /*#__PURE__*/_jsx(_Menu, {\n    children: /*#__PURE__*/_jsx(_Menu.Item, {\n      onClick: handleCreateService,\n      children: \"Save As Draft\"\n    }, \"2\")\n  }); // const uploadButton = (\n  //     <div>\n  //         {loadingupload ? <LoadingOutlined /> : <PlusOutlined />}\n  //         <div style={{ marginTop: 8 }}>Unggah</div>\n  //     </div>\n  // );\n\n\n  return /*#__PURE__*/_jsx(Layout, {\n    tok: initProps,\n    dataProfile: dataProfile,\n    sidemenu: sidemenu,\n    pathArr: pathArr,\n    st: st,\n    children: /*#__PURE__*/_jsxs(\"div\", {\n      className: \"w-full border-t border-opacity-30 border-gray-500 bg-white\",\n      children: [/*#__PURE__*/_jsxs(\"div\", {\n        className: \"w-full flex flex-col md:flex-row justify-between p-3\",\n        children: [/*#__PURE__*/_jsx(\"div\", {\n          children: /*#__PURE__*/_jsx(\"p\", {\n            className: \"font-semibold text-lg\",\n            children: \"Add Service Item\"\n          })\n        }), /*#__PURE__*/_jsxs(\"div\", {\n          children: [/*#__PURE__*/_jsx(_Button, {\n            type: \"default\",\n            style: {\n              marginRight: `1rem`\n            },\n            onClick: () => {\n              rt.push('/admin/service');\n            },\n            children: \"Cancel\"\n          }), /*#__PURE__*/_jsx(_Button, {\n            style: {\n              backgroundColor: `rgb(24,144,255)`,\n              color: `white`\n            },\n            loading: loadingbtntambahitem,\n            onClick: handleCreateService,\n            children: \"Save \"\n          })]\n        })]\n      }), /*#__PURE__*/_jsxs(\"div\", {\n        className: \"w-full grid grid-cols-7\",\n        children: [/*#__PURE__*/_jsx(\"div\", {\n          className: \" col-span-7 md:col-span-1 flex flex-col\",\n          children: /*#__PURE__*/_jsxs(_Anchor, {\n            children: [/*#__PURE__*/_jsx(Link, {\n              href: \"#generalDetail\",\n              title: \"General Detail\"\n            }), /*#__PURE__*/_jsx(Link, {\n              href: \"#customFields\",\n              title: \"Custom Fields\"\n            }), /*#__PURE__*/_jsx(Link, {\n              href: \"#additionalFields\",\n              title: \"Addtional Fields\"\n            }), /*#__PURE__*/_jsx(Link, {\n              href: \"#settings\",\n              title: \"Settings\"\n            })]\n          })\n        }), /*#__PURE__*/_jsxs(\"div\", {\n          className: \" col-span-7 md:col-span-6 flex flex-col\",\n          children: [/*#__PURE__*/_jsxs(\"div\", {\n            id: \"generalDetail\",\n            className: \"mb-5 flex flex-col\",\n            children: [/*#__PURE__*/_jsxs(\"div\", {\n              className: \"flex justify-between items-center p-3\",\n              children: [/*#__PURE__*/_jsx(\"div\", {\n                children: /*#__PURE__*/_jsx(\"p\", {\n                  className: \"font-semibold text-base\",\n                  children: \"General Detail\"\n                })\n              }), /*#__PURE__*/_jsx(\"div\", {\n                children: /*#__PURE__*/_jsx(\"a\", {\n                  href: \"#\",\n                  children: \"Help\"\n                })\n              })]\n            }), /*#__PURE__*/_jsx(\"div\", {\n              className: \"flex p-3\",\n              children: /*#__PURE__*/_jsx(\"div\", {\n                className: \" w-full md:w-7/12\",\n                children: /*#__PURE__*/_jsxs(_Form, {\n                  layout: \"vertical\",\n                  onFinish: handleCreateService,\n                  initialValues: datanew,\n                  children: [/*#__PURE__*/_jsx(_Form.Item, {\n                    label: \"Item Name\",\n                    name: \"nama_service_item\",\n                    rules: [{\n                      required: true,\n                      message: 'Nama Item wajib diisi'\n                    }],\n                    children: /*#__PURE__*/_jsx(_Input, {\n                      name: \"nama_service_item\",\n                      onChange: e => {\n                        setdatanew(_objectSpread(_objectSpread({}, datanew), {}, {\n                          nama_service_item: e.target.value\n                        }));\n                      },\n                      defaultValue: datanew.nama_service_item\n                    })\n                  }), /*#__PURE__*/_jsx(_Form.Item, {\n                    label: \"Service Category\",\n                    name: \"id_service_kategori\",\n                    rules: [{\n                      required: true,\n                      message: 'Service Category wajib diisi'\n                    }],\n                    children: /*#__PURE__*/_jsx(_Select, {\n                      placeholder: \"Pilih Service Category\",\n                      onChange: value => {\n                        setdatanew(_objectSpread(_objectSpread({}, datanew), {}, {\n                          id_service_kategori: value\n                        }));\n                      },\n                      name: \"id_service_kategori\",\n                      defaultValue: datanew.id_service_kategori,\n                      children: dataListServiceCategories.data.map((doc, idx) => {\n                        return /*#__PURE__*/_jsx(Option, {\n                          value: doc.id,\n                          children: doc.nama_kategori\n                        }, idx);\n                      })\n                    })\n                  }), /*#__PURE__*/_jsx(_Form.Item, {\n                    label: \"Deskripsi Singkat\",\n                    name: \"deskripsi_singkat\",\n                    children: /*#__PURE__*/_jsx(_Input, {\n                      name: \"deskripsi_singkat\",\n                      onChange: e => {\n                        setdatanew(_objectSpread(_objectSpread({}, datanew), {}, {\n                          deskripsi_singkat: e.target.value\n                        }));\n                      },\n                      defaultValue: datanew.deskripsi_singkat\n                    })\n                  }), /*#__PURE__*/_jsx(_Form.Item, {\n                    label: \"Deskripsi\",\n                    name: \"deskripsi_lengkap\",\n                    children: /*#__PURE__*/_jsx(_Input.TextArea, {\n                      name: \"deskripsi_lengkap\",\n                      onChange: e => {\n                        setdatanew(_objectSpread(_objectSpread({}, datanew), {}, {\n                          deskripsi_lengkap: e.target.value\n                        }));\n                      },\n                      defaultValue: datanew.deskripsi_lengkap\n                    })\n                  })]\n                })\n              })\n            })]\n          }), /*#__PURE__*/_jsx(\"div\", {\n            id: \"customFields\",\n            className: \" h-96 mb-5\",\n            children: /*#__PURE__*/_jsx(\"div\", {\n              className: \"flex justify-between items-center p-3\",\n              children: /*#__PURE__*/_jsx(\"div\", {\n                children: /*#__PURE__*/_jsx(\"p\", {\n                  className: \"font-semibold text-base\",\n                  children: \"Custom Fields\"\n                })\n              })\n            })\n          }), /*#__PURE__*/_jsxs(\"div\", {\n            id: \"additionalFields\",\n            className: \" flex flex-col mb-5 p-3\",\n            children: [/*#__PURE__*/_jsx(\"h1\", {\n              className: \"font-semibold text-base\",\n              children: \"Additional Items\"\n            }), /*#__PURE__*/_jsx(\"p\", {\n              className: \"text-xs text-gray-500\",\n              children: \"Add related service items that can be requested along with this item\"\n            }), /*#__PURE__*/_jsx(_Select, {\n              showSearch: true,\n              placeholder: \"Cari & Tambah Service Items\",\n              onChange: onChangeAddAdditionalItems,\n              onSearch: value => {\n                onSearchAdditionalItems(value);\n              },\n              optionFilterProp: \"children\",\n              filterOption: (input, option) => option.children.toLowerCase().indexOf(input.toLowerCase()) >= 0,\n              style: {\n                marginBottom: `0.7rem`,\n                width: `20rem`\n              },\n              allowClear: true,\n              children: dataListServiceItemMap.map((doc, idx) => {\n                return /*#__PURE__*/_jsx(Option, {\n                  value: doc.id,\n                  children: doc.itemName\n                });\n              })\n            }), /*#__PURE__*/_jsx(\"div\", {\n              className: \"flex flex-col\",\n              children: addfields.map((doc, idx) => {\n                return /*#__PURE__*/_jsxs(\"div\", {\n                  className: \" w-6/12 flex justify-between border-2 border-blue-500 p-3 divide-x-2 mb-2\",\n                  children: [/*#__PURE__*/_jsxs(\"div\", {\n                    className: \"flex items-center\",\n                    children: [/*#__PURE__*/_jsx(MinusCircleTwoTone, {\n                      style: {\n                        marginRight: `0.5rem`,\n                        cursor: `pointer`\n                      },\n                      onClick: () => {\n                        onDeleteAdditionalItems(doc.id);\n                      }\n                    }), doc.itemName]\n                  }), /*#__PURE__*/_jsxs(\"div\", {\n                    className: \"flex pl-3\",\n                    children: [/*#__PURE__*/_jsx(_Checkbox, {\n                      style: {\n                        marginRight: `0.7rem`\n                      }\n                    }), \" Tandai sebagai Wajib\"]\n                  })]\n                });\n              })\n            })]\n          }), /*#__PURE__*/_jsx(\"div\", {\n            id: \"settings\",\n            className: \" h-96 mb-5\",\n            children: /*#__PURE__*/_jsx(\"div\", {\n              className: \"flex justify-between items-center p-3\",\n              children: /*#__PURE__*/_jsx(\"div\", {\n                children: /*#__PURE__*/_jsx(\"p\", {\n                  className: \"font-semibold text-base\",\n                  children: \"Settings\"\n                })\n              })\n            })\n          })]\n        })]\n      })]\n    })\n  });\n}\n\nexport async function getServerSideProps({\n  req,\n  res\n}) {\n  var initProps = {};\n\n  if (req && req.headers) {\n    const cookies = req.headers.cookie;\n\n    if (!cookies) {\n      res.writeHead(302, {\n        Location: '/login'\n      });\n      res.end();\n    }\n\n    if (typeof cookies === 'string') {\n      const cookiesJSON = httpcookie.parse(cookies);\n      initProps = cookiesJSON.token;\n    }\n  }\n\n  const resources = await fetch(`https://boiling-thicket-46501.herokuapp.com/detailProfile`, {\n    method: `GET`,\n    headers: {\n      'Authorization': JSON.parse(initProps)\n    }\n  });\n  const resjson = await resources.json();\n  const dataProfile = resjson; // if(![189].every((curr) => dataProfile.data.registered_feature.includes(curr))){\n  //     res.writeHead(302, { Location: '/dashboard/admin' })\n  //     res.end()\n  // }\n\n  const resourcesGSI = await fetch(`https://boiling-thicket-46501.herokuapp.com/getServiceItems`, {\n    method: `GET`,\n    headers: {\n      'Authorization': JSON.parse(initProps)\n    }\n  });\n  const resjsonGSI = await resourcesGSI.json();\n  const dataListServiceItem = resjsonGSI;\n  const resourcesGSC = await fetch(`https://boiling-thicket-46501.herokuapp.com/getServiceCategories`, {\n    method: `GET`,\n    headers: {\n      'Authorization': JSON.parse(initProps)\n    }\n  });\n  const resjsonGSC = await resourcesGSC.json();\n  const dataListServiceCategories = resjsonGSC;\n  return {\n    props: {\n      initProps,\n      dataProfile,\n      dataListServiceItem,\n      dataListServiceCategories,\n      sidemenu: \"4\"\n    }\n  };\n}\nexport default ServiceCreate;","map":null,"metadata":{},"sourceType":"module"}