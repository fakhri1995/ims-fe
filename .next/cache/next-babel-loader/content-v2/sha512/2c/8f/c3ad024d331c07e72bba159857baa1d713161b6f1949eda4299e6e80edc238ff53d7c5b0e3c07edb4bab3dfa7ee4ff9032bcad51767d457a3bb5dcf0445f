{"ast":null,"code":"import _Spin from \"antd/lib/spin\";\nimport _Input from \"antd/lib/input\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport _notification from \"antd/lib/notification\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React, { useState, useEffect } from 'react';\nimport DrawerCore from '../drawerCore';\nimport { DateNotRequired, DateRequired, InputNotRequired, InputRequired, RadioRequired, TreeSelectRequired, TextAreaRequired, SelectNotRequired, RadioNotRequired } from '../../input';\nimport { AlignJustifiedIconSvg, BorderAllSvg, CameraIconSvg, CheckboxIconSvg, CircleXIconSvg, CopyIconSvg, EmailIconSvg, FaxIconSvg, ListNumbersSvg, NotesIconSvg, PkpIconSvg, RefreshIconSvg, RulerIconSvg, SquarePlusIconSvg, TrashIconSvg, WebIconSvg } from '../../icon';\nimport { useRouter } from 'next/router';\nimport { Label, Text, H2 } from '../../typography';\nimport ButtonSys from '../../button';\nimport { LoadingOutlined, UpOutlined, DownOutlined } from '@ant-design/icons';\nimport moment from 'moment';\n\nconst DrawerSublokasi = ({\n  title,\n  visible,\n  onClose,\n  children,\n  buttonOkText,\n  initProps,\n  onvisible,\n  subchildren\n}) => {\n  const rt = useRouter();\n  const {\n    0: createdata,\n    1: setcreatedata\n  } = useState({\n    name: '',\n    address_same: false,\n    address: \"\",\n    phone_number: \"\",\n    image_logo: '',\n    parent_id: null,\n    singkatan: \"\",\n    tanggal_pkp: null,\n    penanggung_jawab: \"\",\n    npwp: \"\",\n    fax: \"\",\n    email: \"\",\n    website: \"\"\n  });\n  const {\n    0: disabledsave,\n    1: setdisabledsave\n  } = useState(true);\n  const {\n    0: disabledtrigger,\n    1: setdisabledtrigger\n  } = useState(-1);\n  const {\n    0: treedata,\n    1: settreedata\n  } = useState([]);\n  const {\n    0: sameaddress,\n    1: setsameaddress\n  } = useState(false);\n  const {\n    0: lokasiloading,\n    1: setlokasiloading\n  } = useState(false);\n  const {\n    0: loadingfoto,\n    1: setloadingfoto\n  } = useState(false);\n  const {\n    0: warningphonenumber,\n    1: setwarningphonenumber\n  } = useState(false);\n  const {\n    0: warningemail,\n    1: setwarningemail\n  } = useState(false);\n\n  const onChangeInput = e => {\n    setcreatedata(_objectSpread(_objectSpread({}, createdata), {}, {\n      [e.target.name]: e.target.value\n    }));\n    setdisabledtrigger(prev => prev + 1);\n  };\n\n  const onChangeTreeselect = (value, label, extra) => {\n    setcreatedata(_objectSpread(_objectSpread({}, createdata), {}, {\n      parent_id: value\n    }));\n    setdisabledtrigger(prev => prev + 1);\n  };\n\n  const onChangeRadioAlamat = e => {\n    e.target.value === true ? setsameaddress(true) : setsameaddress(false);\n    setcreatedata(_objectSpread(_objectSpread({}, createdata), {}, {\n      address_same: e.target.value\n    }));\n    setdisabledtrigger(prev => prev + 1);\n  };\n\n  const onChangeGambar = async e => {\n    setloadingfoto(true);\n    const foto = e.target.files;\n    const formdata = new FormData();\n    formdata.append('file', foto[0]);\n    formdata.append('upload_preset', 'migsys');\n    const fetching = await fetch(`https://api.Cloudinary.com/v1_1/aqlpeduli/image/upload`, {\n      method: 'POST',\n      body: formdata\n    });\n    const datajson = await fetching.json();\n    setcreatedata(_objectSpread(_objectSpread({}, createdata), {}, {\n      image_logo: datajson.secure_url\n    }));\n    setloadingfoto(false);\n  };\n\n  const handleCreateSubLokasi = () => {\n    if (/(^\\d+$)/.test(createdata.phone_number) === false) {\n      // console.log(new RegExp(/(^\\d+$)/).test(createdata.phone_number))\n      new RegExp(/(^\\d+$)/).test(createdata.phone_number) === false ? setwarningphonenumber(true) : setwarningphonenumber(false);\n      setdisabledsave(true);\n    } else {\n      setlokasiloading(true);\n      fetch(`https://boiling-thicket-46501.herokuapp.com/addCompanySub`, {\n        method: 'POST',\n        headers: {\n          'Authorization': JSON.parse(initProps),\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(createdata)\n      }).then(res => res.json()).then(res2 => {\n        setlokasiloading(false);\n\n        if (res2.success) {\n          setcreatedata({\n            name: '',\n            address_same: false,\n            address: \"\",\n            phone_number: \"\",\n            image_logo: '',\n            parent_id: null,\n            singkatan: \"\",\n            tanggal_pkp: null,\n            penanggung_jawab: \"\",\n            npwp: \"\",\n            fax: \"\",\n            email: \"\",\n            website: \"\"\n          });\n          setsameaddress(false);\n          setdisabledsave(true);\n          onvisible(false);\n\n          _notification['success']({\n            message: res2.message,\n            duration: 3\n          });\n        } else {\n          _notification['error']({\n            message: res2.message,\n            duration: 3\n          });\n        }\n      });\n    }\n  };\n\n  useEffect(() => {\n    fetch(`https://boiling-thicket-46501.herokuapp.com/getBranchCompanyList`, {\n      method: `GET`,\n      headers: {\n        'Authorization': JSON.parse(initProps)\n      }\n    }).then(res => res.json()).then(res2 => {\n      settreedata([res2.data]);\n    });\n  }, [lokasiloading]);\n  useEffect(() => {\n    if (disabledtrigger !== -1) {\n      if (createdata.parent_id !== null && createdata.name !== \"\" && (createdata.address_same !== false || createdata.address !== \"\") && createdata.phone_number !== \"\" && createdata.penanggung_jawab !== \"\") {\n        setdisabledsave(false);\n      } else {\n        setdisabledsave(true);\n      }\n    }\n  }, [disabledtrigger]);\n  return /*#__PURE__*/_jsx(DrawerCore, {\n    title: title,\n    visible: visible,\n    onClose: () => {\n      setcreatedata({\n        name: '',\n        address_same: false,\n        address: \"\",\n        phone_number: \"\",\n        image_logo: '',\n        parent_id: null,\n        singkatan: \"\",\n        tanggal_pkp: null,\n        penanggung_jawab: \"\",\n        npwp: \"\",\n        fax: \"\",\n        email: \"\",\n        website: \"\"\n      });\n      setsameaddress(false);\n      setdisabledsave(true);\n      onvisible(false);\n    },\n    buttonOkText: buttonOkText,\n    onClick: handleCreateSubLokasi,\n    disabled: disabledsave // onClick={()=>{console.log(createdata)}}\n    ,\n    children: /*#__PURE__*/_jsx(_Spin, {\n      spinning: lokasiloading,\n      children: /*#__PURE__*/_jsxs(\"div\", {\n        className: \"flex flex-col\",\n        children: [/*#__PURE__*/_jsx(\"div\", {\n          className: \"mb-8\",\n          children: /*#__PURE__*/_jsx(\"p\", {\n            className: \"mb-0 text-red-500 text-xs italic\",\n            children: \"*Informasi ini harus diisi\"\n          })\n        }), /*#__PURE__*/_jsxs(\"div\", {\n          className: \"mb-5 flex\",\n          children: [/*#__PURE__*/_jsx(\"div\", {\n            className: \"mr-2\",\n            children: createdata.image_logo === \"\" ? /*#__PURE__*/_jsx(\"div\", {\n              className: \"w-20 h-20 rounded-full bg-gray-400 flex justify-center items-center\",\n              children: /*#__PURE__*/_jsx(CameraIconSvg, {\n                size: 20,\n                color: `#ffffff`\n              })\n            }) : /*#__PURE__*/_jsx(\"img\", {\n              src: createdata.image_logo,\n              className: \"object-contain w-20 h-20 rounded-full\",\n              alt: \"\"\n            })\n          }), /*#__PURE__*/_jsxs(\"div\", {\n            className: \"flex flex-col w-9/12 px-3\",\n            children: [/*#__PURE__*/_jsx(\"div\", {\n              className: \"mb-5\",\n              children: /*#__PURE__*/_jsx(Text, {\n                children: \"Unggah gambar JPG/PNG dari komputer Anda (Max. 5 MB)\"\n              })\n            }), /*#__PURE__*/_jsx(\"div\", {\n              className: \"flex justify-end items-end\",\n              children: /*#__PURE__*/_jsxs(ButtonSys, {\n                type: \"primaryInput\",\n                onChangeGambar: onChangeGambar,\n                children: [loadingfoto ? /*#__PURE__*/_jsx(LoadingOutlined, {\n                  style: {\n                    marginRight: `0.5rem`\n                  }\n                }) : /*#__PURE__*/_jsx(RefreshIconSvg, {\n                  size: 15,\n                  color: `#ffffff`\n                }), \"Atur Ulang\"]\n              })\n            })]\n          })]\n        }), /*#__PURE__*/_jsxs(\"div\", {\n          className: \"flex flex-col mb-5\",\n          children: [/*#__PURE__*/_jsx(TreeSelectRequired, {\n            name: \"parent_id\",\n            onChangeTreeselect: onChangeTreeselect,\n            label: \"Induk Lokasi\",\n            treeData: subchildren\n          }), /*#__PURE__*/_jsx(InputRequired, {\n            name: \"name\",\n            onChangeInput: onChangeInput,\n            label: \"Nama Sub Lokasi\"\n          }), /*#__PURE__*/_jsx(RadioRequired, {\n            name: \"address\",\n            label: \"Alamat Sub Lokasi\",\n            onChangeRadio: onChangeRadioAlamat,\n            options: [{\n              value: true,\n              title: \"Sama dengan Induk\"\n            }, {\n              value: false,\n              title: \"Alamat Berbeda\"\n            }]\n          }), /*#__PURE__*/_jsx(\"div\", {\n            className: \"mb-5 px-3\",\n            children: /*#__PURE__*/_jsx(_Input, {\n              name: \"address\",\n              onChange: onChangeInput,\n              disabled: sameaddress ? true : false\n            })\n          }), /*#__PURE__*/_jsx(InputRequired, {\n            name: \"phone_number\",\n            onChangeInput: onChangeInput,\n            label: \"Nomor Telepon\"\n          }), warningphonenumber && /*#__PURE__*/_jsx(\"p\", {\n            className: \" text-red-500 text-sm mb-3 -mt-3 mx-3\",\n            children: \"Nomor Telepon harus angka\"\n          }), /*#__PURE__*/_jsx(InputRequired, {\n            name: \"penanggung_jawab\",\n            onChangeInput: onChangeInput,\n            label: \"Penanggung Jawab (PIC)\"\n          })]\n        })]\n      })\n    })\n  });\n};\n\nexport default DrawerSublokasi;","map":null,"metadata":{},"sourceType":"module"}