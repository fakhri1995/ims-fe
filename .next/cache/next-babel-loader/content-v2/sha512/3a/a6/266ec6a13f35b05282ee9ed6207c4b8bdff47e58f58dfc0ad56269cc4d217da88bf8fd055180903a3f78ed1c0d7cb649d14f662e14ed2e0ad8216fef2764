{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport _Select from \"antd/lib/select\";\nimport _Spin from \"antd/lib/spin\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport _notification from \"antd/lib/notification\";\nimport _JSXStyle from \"styled-jsx/style\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport { DownOutlined, LoadingOutlined, UpOutlined } from \"@ant-design/icons\";\nimport moment from \"moment\";\nimport { useRouter } from \"next/router\";\nimport React, { useEffect, useState } from \"react\";\nimport ButtonSys from \"../../../button\";\nimport { AlignJustifiedIconSvg, BorderAllSvg, CameraIconSvg, CheckboxIconSvg, CircleXIconSvg, CopyIconSvg, EmailIconSvg, FaxIconSvg, ListNumbersSvg, NotesIconSvg, PkpIconSvg, RefreshIconSvg, RulerIconSvg, SquarePlusIconSvg, TrashIconSvg, WebIconSvg } from \"../../../icon\";\nimport { DateNotRequired, DateRequired, InputNotRequired, InputRequired, RadioNotRequired, RadioRequired, SelectNotRequired, TextAreaRequired, TreeSelectRequired } from \"../../../input\";\nimport { H2, Label, Text } from \"../../../typography\";\nimport DrawerCore from \"../../drawerCore\";\n\nconst DrawerAddRelasi = ({\n  id,\n  title,\n  visible,\n  onClose,\n  children,\n  buttonOkText,\n  initProps,\n  onvisible\n}) => {\n  //add\n  const {\n    0: dataApiadd,\n    1: setdataApiadd\n  } = useState({\n    subject_id: Number(id),\n    relationship_id: null,\n    is_inverse: null,\n    from_inverse: true,\n    type_id: -3,\n    connected_ids: null,\n    backup_connected_ids: null\n  });\n  const {\n    0: displaydatarelations,\n    1: setdisplaydatarelations\n  } = useState([]);\n  const {\n    0: relationnameadd,\n    1: setrelationnameadd\n  } = useState(\"\");\n  const {\n    0: relationnameddadd,\n    1: setrelationnameddadd\n  } = useState(false);\n  const {\n    0: relationselectedidxadd,\n    1: setrelationselectedidxadd\n  } = useState(-1);\n  const {\n    0: relationselectedisinverseadd,\n    1: setrelationselectedisinverseadd\n  } = useState(-1);\n  const {\n    0: detailtipeadd,\n    1: setdetailtipeadd\n  } = useState(-9);\n  const {\n    0: detailtipedataadd,\n    1: setdetailtipedataadd\n  } = useState([]);\n  const {\n    0: modaladd,\n    1: setmodaladd\n  } = useState(false);\n  const {\n    0: disabledadd,\n    1: setdisabledadd\n  } = useState(true);\n  const {\n    0: loadingadd,\n    1: setloadingadd\n  } = useState(false);\n  const {\n    0: fetchingmodel,\n    1: setfetchingmodel\n  } = useState(false);\n  const {\n    0: sublocdata,\n    1: setsublocdata\n  } = useState(null);\n  const {\n    0: subloctrig,\n    1: setsubloctrig\n  } = useState(-1);\n\n  const handleAddRelationshipItem = () => {\n    setloadingadd(true);\n    fetch(`${process.env.NEXT_PUBLIC_BACKEND_URL}/addRelationshipInventories`, {\n      method: \"POST\",\n      headers: {\n        Authorization: JSON.parse(initProps),\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify(dataApiadd)\n    }).then(res => res.json()).then(res2 => {\n      setloadingadd(false);\n      onvisible(false);\n\n      if (res2.success) {\n        setdataApiadd({\n          subject_id: Number(id),\n          relationship_id: null,\n          is_inverse: null,\n          type_id: -3,\n          connected_ids: null,\n          backup_connected_ids: null,\n          from_inverse: true\n        });\n        setrelationnameadd(\"\");\n        setsublocdata(null);\n        setrelationselectedidxadd(-1);\n        setrelationselectedisinverseadd(-1);\n        setsubloctrig(-1);\n\n        _notification[\"success\"]({\n          message: \"Relationship Item berhasil ditambahkan\",\n          duration: 3\n        });\n      } else if (!res2.success) {\n        _notification[\"error\"]({\n          message: res2.message,\n          duration: 3\n        });\n      }\n    });\n  };\n\n  useEffect(() => {\n    fetch(`${process.env.NEXT_PUBLIC_BACKEND_URL}/getRelationships`, {\n      method: `GET`,\n      headers: {\n        Authorization: JSON.parse(initProps)\n      }\n    }).then(res => res.json()).then(res2 => {\n      setdisplaydatarelations(res2.data);\n    });\n  }, []);\n  useEffect(() => {\n    if (subloctrig !== -1) {\n      fetch(`${process.env.NEXT_PUBLIC_BACKEND_URL}/getRelationshipInventoryDetailList?type_id=${subloctrig}`, {\n        method: `GET`,\n        headers: {\n          Authorization: JSON.parse(initProps)\n        }\n      }).then(res => res.json()).then(res2 => {\n        setsublocdata(res2.data.children);\n      });\n    } else if (detailtipeadd !== -10) {\n      fetch(`${process.env.NEXT_PUBLIC_BACKEND_URL}/getFilterInventories`, {\n        method: `GET`,\n        headers: {\n          Authorization: JSON.parse(initProps)\n        }\n      }).then(res => res.json()).then(res2 => {\n        setdetailtipedataadd(res2.data); // dataApiadd.type_id === -3 && setdetailtipedataadd([res2.data])\n        // dataApiadd.type_id === -1 && setdetailtipedataadd(res2.data)\n        // dataApiadd.type_id === -2 && setdetailtipedataadd(res2.data)\n        // dataApiadd.type_id === -4 && setdetailtipedataadd(res2.data.data)\n      });\n    }\n  }, [detailtipeadd, subloctrig]);\n  return /*#__PURE__*/_jsx(DrawerCore, {\n    title: title,\n    visible: visible,\n    onClose:\n    /*()=>{console.log(dataApiadd)}*/\n    onClose,\n    buttonOkText: buttonOkText,\n    onClick: handleAddRelationshipItem,\n    children: /*#__PURE__*/_jsx(_Spin, {\n      spinning: loadingadd,\n      children: /*#__PURE__*/_jsxs(\"div\", {\n        className: \"flex flex-col mb-3\",\n        children: [/*#__PURE__*/_jsxs(\"div\", {\n          className: \"jsx-656990793\" + \" \" + \"flex flex-col mb-3\",\n          children: [/*#__PURE__*/_jsxs(\"p\", {\n            className: \"jsx-656990793\" + \" \" + \"mb-0\",\n            children: [\"Relationship Type \", /*#__PURE__*/_jsx(\"span\", {\n              className: \"jsx-656990793\" + \" \" + \"namapart\"\n            })]\n          }), /*#__PURE__*/_jsxs(\"div\", {\n            onClick: () => {\n              setrelationnameddadd(prev => !prev);\n            },\n            className: \"jsx-656990793\" + \" \" + \"w-full border p-2 hover:border-primary100 rounded-sm flex items-center justify-between cursor-pointer\",\n            children: [/*#__PURE__*/_jsx(\"p\", {\n              className: \"jsx-656990793\" + \" \" + \"mb-0\",\n              children: relationnameadd\n            }), relationnameddadd ? /*#__PURE__*/_jsx(UpOutlined, {\n              style: {\n                color: `rgb(229,231,235)`\n              }\n            }) : /*#__PURE__*/_jsx(DownOutlined, {\n              style: {\n                color: `rgb(229,231,235)`\n              }\n            })]\n          }), relationnameddadd ? /*#__PURE__*/_jsxs(\"div\", {\n            className: \"jsx-656990793\" + \" \" + \"flex flex-col\",\n            children: [/*#__PURE__*/_jsxs(\"div\", {\n              className: \"jsx-656990793\" + \" \" + \"flex\",\n              children: [/*#__PURE__*/_jsx(\"div\", {\n                className: \"jsx-656990793\" + \" \" + \"bg-gray-200 font-semibold p-3 w-6/12\",\n                children: \"Relationship Type\"\n              }), /*#__PURE__*/_jsx(\"div\", {\n                className: \"jsx-656990793\" + \" \" + \"bg-gray-200 font-semibold p-3 w-6/12\",\n                children: \"Inverse Relationship Type\"\n              })]\n            }), displaydatarelations.map((doc, idx) => {\n              return /*#__PURE__*/_jsxs(\"div\", {\n                className: \"jsx-656990793\" + \" \" + \"flex\",\n                children: [/*#__PURE__*/_jsx(\"div\", {\n                  onClick: e => {\n                    setrelationnameddadd(false);\n                    setrelationnameadd(doc.relationship_type);\n                    setdataApiadd(_objectSpread(_objectSpread({}, dataApiadd), {}, {\n                      relationship_id: doc.id,\n                      is_inverse: false\n                    }));\n                    doc.id === null || dataApiadd.type_id === null ? setdisabledadd(true) : setdisabledadd(false);\n                    setrelationselectedidxadd(idx);\n                    setrelationselectedisinverseadd(false);\n                  },\n                  className: \"jsx-656990793\" + \" \" + ` hover:bg-primary10 cursor-pointer hover:text-black p-3 w-6/12 ${relationselectedidxadd === idx && relationselectedisinverseadd === false ? \" bg-primary50\" : \"bg-white\"}`,\n                  children: doc.relationship_type\n                }), /*#__PURE__*/_jsx(\"div\", {\n                  onClick: e => {\n                    setrelationnameddadd(false);\n                    setrelationnameadd(doc.inverse_relationship_type);\n                    setdataApiadd(_objectSpread(_objectSpread({}, dataApiadd), {}, {\n                      relationship_id: doc.id,\n                      is_inverse: true\n                    }));\n                    doc.id === null || dataApiadd.type_id === null ? setdisabledadd(true) : setdisabledadd(false);\n                    setrelationselectedidxadd(idx);\n                    setrelationselectedisinverseadd(true);\n                  },\n                  className: \"jsx-656990793\" + \" \" + ` hover:bg-primary10 cursor-pointer hover:text-black p-3 w-6/12 ${relationselectedidxadd === idx && relationselectedisinverseadd === true ? \" bg-primary50\" : \"bg-white\"}`,\n                  children: doc.inverse_relationship_type\n                })]\n              });\n            })]\n          }) : null, /*#__PURE__*/_jsx(_JSXStyle, {\n            id: \"656990793\",\n            children: [\".namapart.jsx-656990793::before{content:'*';color:red;}\"]\n          })]\n        }), dataApiadd.type_id !== null ? /*#__PURE__*/_jsx(_Fragment, {\n          children: /*#__PURE__*/_jsxs(\"div\", {\n            className: \"flex flex-col mb-3\",\n            children: [/*#__PURE__*/_jsx(\"p\", {\n              className: \"mb-0\",\n              children: \"Item\"\n            }), /*#__PURE__*/_jsx(_Select, {\n              allowClear: true,\n              value: dataApiadd.connected_ids,\n              showSearch: true,\n              optionFilterProp: \"children\",\n              notFoundContent: fetchingmodel ? /*#__PURE__*/_jsx(_Spin, {\n                size: \"small\"\n              }) : null,\n              onSearch: value => {\n                setfetchingmodel(true);\n                fetch(`${process.env.NEXT_PUBLIC_BACKEND_URL}/getFilterInventories?keyword=${value !== \"\" ? value : \"\"}`, {\n                  method: `GET`,\n                  headers: {\n                    Authorization: JSON.parse(initProps)\n                  }\n                }).then(res => res.json()).then(res2 => {\n                  setdetailtipedataadd(res2.data);\n                  setfetchingmodel(false);\n                });\n              } // filterOption={(input, opt) => (\n              //     opt.children.toLowerCase().indexOf(input.toLowerCase()) >= 0\n              // )}\n              ,\n              onChange: value => {\n                setdataApiadd(_objectSpread(_objectSpread({}, dataApiadd), {}, {\n                  connected_ids: [value],\n                  backup_connected_ids: [value]\n                }));\n              },\n              children: detailtipedataadd.map((doc, idx) => {\n                return /*#__PURE__*/_jsxs(_Select.Option, {\n                  value: doc.id,\n                  children: [doc.mig_id, \" - \", doc.model_name, \" - \", doc.asset_name]\n                });\n              })\n            })]\n          })\n        }) : null]\n      })\n    })\n  });\n};\n\nexport default DrawerAddRelasi;","map":null,"metadata":{},"sourceType":"module"}