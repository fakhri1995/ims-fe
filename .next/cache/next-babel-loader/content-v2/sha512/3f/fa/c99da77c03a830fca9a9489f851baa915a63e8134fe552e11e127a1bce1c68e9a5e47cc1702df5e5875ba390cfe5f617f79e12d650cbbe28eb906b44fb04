{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport _Select from \"antd/lib/select\";\nimport _Spin from \"antd/lib/spin\";\nimport _defineProperty from \"/home/kjokken/mig/code/frontend/ims-fe-ssh-dev/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport _notification from \"antd/lib/notification\";\nimport _JSXStyle from \"styled-jsx/style\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useState, useEffect } from 'react';\nimport DrawerCore from '../../drawerCore';\nimport { DateNotRequired, DateRequired, InputNotRequired, InputRequired, RadioRequired, TreeSelectRequired, TextAreaRequired, SelectNotRequired, RadioNotRequired } from '../../../input';\nimport { AlignJustifiedIconSvg, BorderAllSvg, CameraIconSvg, CheckboxIconSvg, CircleXIconSvg, CopyIconSvg, EmailIconSvg, FaxIconSvg, ListNumbersSvg, NotesIconSvg, PkpIconSvg, RefreshIconSvg, RulerIconSvg, SquarePlusIconSvg, TrashIconSvg, WebIconSvg } from '../../../icon';\nimport { useRouter } from 'next/router';\nimport { Label, Text, H2 } from '../../../typography';\nimport ButtonSys from '../../../button';\nimport { LoadingOutlined, UpOutlined, DownOutlined } from '@ant-design/icons';\nimport moment from 'moment';\n\nvar DrawerAddRelasi = function DrawerAddRelasi(_ref) {\n  var id = _ref.id,\n      title = _ref.title,\n      visible = _ref.visible,\n      onClose = _ref.onClose,\n      children = _ref.children,\n      buttonOkText = _ref.buttonOkText,\n      initProps = _ref.initProps,\n      onvisible = _ref.onvisible;\n\n  //add\n  var _useState = useState({\n    subject_id: Number(id),\n    relationship_id: null,\n    is_inverse: null,\n    from_inverse: true,\n    type_id: -3,\n    connected_ids: null,\n    backup_connected_ids: null\n  }),\n      dataApiadd = _useState[0],\n      setdataApiadd = _useState[1];\n\n  var _useState2 = useState([]),\n      displaydatarelations = _useState2[0],\n      setdisplaydatarelations = _useState2[1];\n\n  var _useState3 = useState(\"\"),\n      relationnameadd = _useState3[0],\n      setrelationnameadd = _useState3[1];\n\n  var _useState4 = useState(false),\n      relationnameddadd = _useState4[0],\n      setrelationnameddadd = _useState4[1];\n\n  var _useState5 = useState(-1),\n      relationselectedidxadd = _useState5[0],\n      setrelationselectedidxadd = _useState5[1];\n\n  var _useState6 = useState(-1),\n      relationselectedisinverseadd = _useState6[0],\n      setrelationselectedisinverseadd = _useState6[1];\n\n  var _useState7 = useState(-9),\n      detailtipeadd = _useState7[0],\n      setdetailtipeadd = _useState7[1];\n\n  var _useState8 = useState([]),\n      detailtipedataadd = _useState8[0],\n      setdetailtipedataadd = _useState8[1];\n\n  var _useState9 = useState(false),\n      modaladd = _useState9[0],\n      setmodaladd = _useState9[1];\n\n  var _useState10 = useState(true),\n      disabledadd = _useState10[0],\n      setdisabledadd = _useState10[1];\n\n  var _useState11 = useState(false),\n      loadingadd = _useState11[0],\n      setloadingadd = _useState11[1];\n\n  var _useState12 = useState(false),\n      fetchingmodel = _useState12[0],\n      setfetchingmodel = _useState12[1];\n\n  var _useState13 = useState(null),\n      sublocdata = _useState13[0],\n      setsublocdata = _useState13[1];\n\n  var _useState14 = useState(-1),\n      subloctrig = _useState14[0],\n      setsubloctrig = _useState14[1];\n\n  var handleAddRelationshipItem = function handleAddRelationshipItem() {\n    setloadingadd(true);\n    fetch(\"https://boiling-thicket-46501.herokuapp.com/addRelationshipInventories\", {\n      method: 'POST',\n      headers: {\n        'Authorization': JSON.parse(initProps),\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify(dataApiadd)\n    }).then(function (res) {\n      return res.json();\n    }).then(function (res2) {\n      setloadingadd(false);\n      onvisible(false);\n\n      if (res2.success) {\n        setdataApiadd({\n          subject_id: Number(id),\n          relationship_id: null,\n          is_inverse: null,\n          type_id: -3,\n          connected_ids: null,\n          backup_connected_ids: null,\n          from_inverse: true\n        });\n        setrelationnameadd(\"\");\n        setsublocdata(null);\n        setrelationselectedidxadd(-1);\n        setrelationselectedisinverseadd(-1);\n        setsubloctrig(-1);\n\n        _notification['success']({\n          message: \"Relationship Item berhasil ditambahkan\",\n          duration: 3\n        });\n      } else if (!res2.success) {\n        _notification['error']({\n          message: res2.message,\n          duration: 3\n        });\n      }\n    });\n  };\n\n  useEffect(function () {\n    fetch(\"https://boiling-thicket-46501.herokuapp.com/getRelationships\", {\n      method: \"GET\",\n      headers: {\n        'Authorization': JSON.parse(initProps)\n      }\n    }).then(function (res) {\n      return res.json();\n    }).then(function (res2) {\n      setdisplaydatarelations(res2.data);\n    });\n  }, []);\n  useEffect(function () {\n    if (subloctrig !== -1) {\n      fetch(\"https://boiling-thicket-46501.herokuapp.com/getRelationshipInventoryDetailList?type_id=\".concat(subloctrig), {\n        method: \"GET\",\n        headers: {\n          'Authorization': JSON.parse(initProps)\n        }\n      }).then(function (res) {\n        return res.json();\n      }).then(function (res2) {\n        setsublocdata(res2.data.children);\n      });\n    } else if (detailtipeadd !== -10) {\n      fetch(\"https://boiling-thicket-46501.herokuapp.com/getFilterInventories\", {\n        method: \"GET\",\n        headers: {\n          'Authorization': JSON.parse(initProps)\n        }\n      }).then(function (res) {\n        return res.json();\n      }).then(function (res2) {\n        setdetailtipedataadd(res2.data); // dataApiadd.type_id === -3 && setdetailtipedataadd([res2.data])\n        // dataApiadd.type_id === -1 && setdetailtipedataadd(res2.data)\n        // dataApiadd.type_id === -2 && setdetailtipedataadd(res2.data)\n        // dataApiadd.type_id === -4 && setdetailtipedataadd(res2.data.data)\n      });\n    }\n  }, [detailtipeadd, subloctrig]);\n  return /*#__PURE__*/_jsx(DrawerCore, {\n    title: title,\n    visible: visible,\n    onClose:\n    /*()=>{console.log(dataApiadd)}*/\n    onClose,\n    buttonOkText: buttonOkText,\n    onClick: handleAddRelationshipItem,\n    children: /*#__PURE__*/_jsx(_Spin, {\n      spinning: loadingadd,\n      children: /*#__PURE__*/_jsxs(\"div\", {\n        className: \"flex flex-col mb-3\",\n        children: [/*#__PURE__*/_jsxs(\"div\", {\n          className: \"jsx-656990793\" + \" \" + \"flex flex-col mb-3\",\n          children: [/*#__PURE__*/_jsxs(\"p\", {\n            className: \"jsx-656990793\" + \" \" + \"mb-0\",\n            children: [\"Relationship Type \", /*#__PURE__*/_jsx(\"span\", {\n              className: \"jsx-656990793\" + \" \" + \"namapart\"\n            })]\n          }), /*#__PURE__*/_jsxs(\"div\", {\n            onClick: function onClick() {\n              setrelationnameddadd(function (prev) {\n                return !prev;\n              });\n            },\n            className: \"jsx-656990793\" + \" \" + \"w-full border p-2 hover:border-primary100 rounded-sm flex items-center justify-between cursor-pointer\",\n            children: [/*#__PURE__*/_jsx(\"p\", {\n              className: \"jsx-656990793\" + \" \" + \"mb-0\",\n              children: relationnameadd\n            }), relationnameddadd ? /*#__PURE__*/_jsx(UpOutlined, {\n              style: {\n                color: \"rgb(229,231,235)\"\n              }\n            }) : /*#__PURE__*/_jsx(DownOutlined, {\n              style: {\n                color: \"rgb(229,231,235)\"\n              }\n            })]\n          }), relationnameddadd ? /*#__PURE__*/_jsxs(\"div\", {\n            className: \"jsx-656990793\" + \" \" + \"flex flex-col\",\n            children: [/*#__PURE__*/_jsxs(\"div\", {\n              className: \"jsx-656990793\" + \" \" + \"flex\",\n              children: [/*#__PURE__*/_jsx(\"div\", {\n                className: \"jsx-656990793\" + \" \" + \"bg-gray-200 font-semibold p-3 w-6/12\",\n                children: \"Relationship Type\"\n              }), /*#__PURE__*/_jsx(\"div\", {\n                className: \"jsx-656990793\" + \" \" + \"bg-gray-200 font-semibold p-3 w-6/12\",\n                children: \"Inverse Relationship Type\"\n              })]\n            }), displaydatarelations.map(function (doc, idx) {\n              return /*#__PURE__*/_jsxs(\"div\", {\n                className: \"jsx-656990793\" + \" \" + \"flex\",\n                children: [/*#__PURE__*/_jsx(\"div\", {\n                  onClick: function onClick(e) {\n                    setrelationnameddadd(false);\n                    setrelationnameadd(doc.relationship_type);\n                    setdataApiadd(_objectSpread(_objectSpread({}, dataApiadd), {}, {\n                      relationship_id: doc.id,\n                      is_inverse: false\n                    }));\n                    doc.id === null || dataApiadd.type_id === null ? setdisabledadd(true) : setdisabledadd(false);\n                    setrelationselectedidxadd(idx);\n                    setrelationselectedisinverseadd(false);\n                  },\n                  className: \"jsx-656990793\" + \" \" + \" hover:bg-primary10 cursor-pointer hover:text-black p-3 w-6/12 \".concat(relationselectedidxadd === idx && relationselectedisinverseadd === false ? \" bg-primary50\" : \"bg-white\"),\n                  children: doc.relationship_type\n                }), /*#__PURE__*/_jsx(\"div\", {\n                  onClick: function onClick(e) {\n                    setrelationnameddadd(false);\n                    setrelationnameadd(doc.inverse_relationship_type);\n                    setdataApiadd(_objectSpread(_objectSpread({}, dataApiadd), {}, {\n                      relationship_id: doc.id,\n                      is_inverse: true\n                    }));\n                    doc.id === null || dataApiadd.type_id === null ? setdisabledadd(true) : setdisabledadd(false);\n                    setrelationselectedidxadd(idx);\n                    setrelationselectedisinverseadd(true);\n                  },\n                  className: \"jsx-656990793\" + \" \" + \" hover:bg-primary10 cursor-pointer hover:text-black p-3 w-6/12 \".concat(relationselectedidxadd === idx && relationselectedisinverseadd === true ? \" bg-primary50\" : \"bg-white\"),\n                  children: doc.inverse_relationship_type\n                })]\n              });\n            })]\n          }) : null, /*#__PURE__*/_jsx(_JSXStyle, {\n            id: \"656990793\",\n            children: [\".namapart.jsx-656990793::before{content:'*';color:red;}\"]\n          })]\n        }), dataApiadd.type_id !== null ? /*#__PURE__*/_jsx(_Fragment, {\n          children: /*#__PURE__*/_jsxs(\"div\", {\n            className: \"flex flex-col mb-3\",\n            children: [/*#__PURE__*/_jsx(\"p\", {\n              className: \"mb-0\",\n              children: \"Item\"\n            }), /*#__PURE__*/_jsx(_Select, {\n              allowClear: true,\n              value: dataApiadd.connected_ids,\n              showSearch: true,\n              optionFilterProp: \"children\",\n              notFoundContent: fetchingmodel ? /*#__PURE__*/_jsx(_Spin, {\n                size: \"small\"\n              }) : null,\n              onSearch: function onSearch(value) {\n                setfetchingmodel(true);\n                fetch(\"https://boiling-thicket-46501.herokuapp.com/getFilterInventories?keyword=\".concat(value !== \"\" ? value : \"\"), {\n                  method: \"GET\",\n                  headers: {\n                    'Authorization': JSON.parse(initProps)\n                  }\n                }).then(function (res) {\n                  return res.json();\n                }).then(function (res2) {\n                  setdetailtipedataadd(res2.data);\n                  setfetchingmodel(false);\n                });\n              } // filterOption={(input, opt) => (\n              //     opt.children.toLowerCase().indexOf(input.toLowerCase()) >= 0\n              // )} \n              ,\n              onChange: function onChange(value) {\n                setdataApiadd(_objectSpread(_objectSpread({}, dataApiadd), {}, {\n                  connected_ids: [value],\n                  backup_connected_ids: [value]\n                }));\n              },\n              children: detailtipedataadd.map(function (doc, idx) {\n                return /*#__PURE__*/_jsxs(_Select.Option, {\n                  value: doc.id,\n                  children: [doc.mig_id, \" - \", doc.model_name, \" - \", doc.asset_name]\n                });\n              })\n            })]\n          })\n        }) : null]\n      })\n    })\n  });\n};\n\nexport default DrawerAddRelasi;","map":null,"metadata":{},"sourceType":"module"}