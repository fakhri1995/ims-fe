{"ast":null,"code":"import _Select from \"antd/lib/select\";\nimport _TreeSelect from \"antd/lib/tree-select\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport _Spin from \"antd/lib/spin\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport _notification from \"antd/lib/notification\";\nimport _JSXStyle from \"styled-jsx/style\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport { SearchOutlined } from \"@ant-design/icons\";\nimport React, { useEffect, useState } from \"react\";\nimport { Label } from \"../../typography\";\nimport DrawerCore from \"../drawerCore\";\n\nfunction modifData(dataa) {\n  for (var i = 0; i < dataa.length; i++) {\n    dataa[i][\"key\"] = dataa[i].id;\n    dataa[i][\"value\"] = dataa[i].id;\n\n    if (dataa[i].children) {\n      modifData(dataa[i].children);\n    }\n  }\n\n  return dataa;\n}\n\nconst DrawerTicketConnectItem = ({\n  title,\n  visible,\n  onvisible,\n  onClose,\n  buttonOkText,\n  disabled,\n  initProps,\n  refresh,\n  setrefresh,\n  setrefreshclosed,\n  datapayload,\n  setdatapayload,\n  selectedassettype,\n  setselectedassettype,\n  ticketid\n}) => {\n  //useState\n  const {\n    0: loadingsave,\n    1: setloadingsave\n  } = useState(false);\n  const {\n    0: loadinggetasset,\n    1: setloadinggetasset\n  } = useState(false);\n  const {\n    0: dataassettype,\n    1: setdataassettype\n  } = useState([]);\n  const {\n    0: dataasset,\n    1: setdataasset\n  } = useState([]);\n  const {\n    0: fetchingdataasset,\n    1: setfetchingdataasset\n  } = useState(false);\n  const {\n    0: disabledcreate,\n    1: setdisabledcreate\n  } = useState(true);\n  const {\n    0: disabledtrigger,\n    1: setdisabledtrigger\n  } = useState(-1); //handler\n\n  const handleSetAsset = () => {\n    setloadingsave(true);\n    setdisabledcreate(true);\n    fetch(`${process.env.NEXT_PUBLIC_BACKEND_URL}/setItemTicket`, {\n      method: \"PUT\",\n      headers: {\n        Authorization: JSON.parse(initProps),\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify(datapayload)\n    }).then(res => res.json()).then(res2 => {\n      setloadingsave(false);\n      setdisabledcreate(false);\n\n      if (res2.success) {\n        setrefresh(prev => prev + 1);\n        onvisible(false);\n        setdatapayload({\n          id: Number(ticketid),\n          inventory_id: null\n        });\n\n        _notification[\"success\"]({\n          message: res2.message,\n          duration: 3\n        });\n      } else {\n        _notification[\"error\"]({\n          message: res2.message,\n          duration: 3\n        });\n      }\n    });\n  }; //useEffect\n\n\n  useEffect(() => {\n    fetch(`${process.env.NEXT_PUBLIC_BACKEND_URL}/getAssets`, {\n      method: `GET`,\n      headers: {\n        Authorization: JSON.parse(initProps)\n      }\n    }).then(res => res.json()).then(res2 => {\n      var assettypemap = modifData(res2.data);\n      setdataassettype(assettypemap);\n    });\n  }, []);\n  useEffect(() => {\n    fetch(`${process.env.NEXT_PUBLIC_BACKEND_URL}/getFilterInventories`, {\n      method: `GET`,\n      headers: {\n        Authorization: JSON.parse(initProps)\n      }\n    }).then(res => res.json()).then(res2 => {\n      setdataasset(res2.data);\n    });\n  }, []);\n  useEffect(() => {\n    if (datapayload.inventory_id !== null) {\n      setdisabledcreate(false);\n    } else {\n      setdisabledcreate(true);\n    }\n  }, [disabledtrigger]);\n  return /*#__PURE__*/_jsx(DrawerCore, {\n    title: title,\n    visible: visible,\n    onClose: () => {\n      setrefreshclosed(prev => prev + 1);\n      setdatapayload({\n        id: Number(ticketid),\n        inventory_id: null\n      });\n      onvisible(false);\n    },\n    buttonOkText: buttonOkText,\n    onClick: handleSetAsset,\n    disabled: disabledcreate,\n    children: loadingsave ? /*#__PURE__*/_jsx(_Fragment, {\n      children: /*#__PURE__*/_jsx(_Spin, {})\n    }) : /*#__PURE__*/_jsxs(\"div\", {\n      className: \"flex flex-col\",\n      children: [/*#__PURE__*/_jsx(\"div\", {\n        className: \"mb-6\",\n        children: /*#__PURE__*/_jsx(\"p\", {\n          className: \"mb-0 text-red-500 text-xs italic\",\n          children: \"*Informasi ini harus diisi\"\n        })\n      }), /*#__PURE__*/_jsxs(\"div\", {\n        className: \"flex flex-col mb-6\",\n        children: [/*#__PURE__*/_jsxs(\"div\", {\n          className: \"jsx-2185086480\" + \" \" + \"flex mb-2\",\n          children: [/*#__PURE__*/_jsx(Label, {\n            children: \"Tipe Aset\"\n          }), /*#__PURE__*/_jsx(\"span\", {\n            className: \"jsx-2185086480\" + \" \" + \"assettypes\"\n          }), /*#__PURE__*/_jsx(_JSXStyle, {\n            id: \"2185086480\",\n            children: [\".assettypes.jsx-2185086480::before{content:'*';color:red;}\"]\n          })]\n        }), /*#__PURE__*/_jsx(\"div\", {\n          className: \" mb-2 flex\",\n          children: /*#__PURE__*/_jsx(_TreeSelect, {\n            style: {\n              width: `100%`\n            },\n            showArrow: true,\n            name: `asset_type`,\n            onChange: (value, label, extra) => {\n              setselectedassettype(extra.allCheckedNodes[0].node.props.id);\n              setloadinggetasset(true);\n              fetch(`${process.env.NEXT_PUBLIC_BACKEND_URL}/getFilterInventories?asset_id=${extra.allCheckedNodes[0].node.props.id}`, {\n                method: `GET`,\n                headers: {\n                  Authorization: JSON.parse(initProps)\n                }\n              }).then(res => res.json()).then(res2 => {\n                console.log(res2);\n                setdataasset(res2.data);\n                setloadinggetasset(false);\n              });\n            },\n            treeData: dataassettype,\n            treeDefaultExpandAll: true,\n            value: selectedassettype\n          })\n        })]\n      }), /*#__PURE__*/_jsx(\"div\", {\n        className: \"flex flex-col mb-6\",\n        children: /*#__PURE__*/_jsx(\"div\", {\n          className: \" mb-2 flex\",\n          children: /*#__PURE__*/_jsx(_Select, {\n            style: {\n              width: `100%`\n            },\n            placeholder: \"Nama aset...\",\n            suffixIcon: /*#__PURE__*/_jsx(SearchOutlined, {}),\n            showArrow: true,\n            onChange: (value, option) => {\n              setdatapayload(_objectSpread(_objectSpread({}, datapayload), {}, {\n                inventory_id: value\n              }));\n              setdisabledtrigger(prev => prev + 1);\n            },\n            loading: loadinggetasset,\n            showSearch: true,\n            optionFilterProp: \"children\",\n            notFoundContent: fetchingdataasset ? /*#__PURE__*/_jsx(_Spin, {\n              size: \"small\"\n            }) : null,\n            onSearch: value => {\n              setfetchingdataasset(true);\n              fetch(`${process.env.NEXT_PUBLIC_BACKEND_URL}/getFilterInventories?asset_id=${selectedassettype}&keyword=${value}`, {\n                method: `GET`,\n                headers: {\n                  Authorization: JSON.parse(initProps)\n                }\n              }).then(res => res.json()).then(res2 => {\n                setdataasset(res2.data);\n                setfetchingdataasset(false);\n              });\n            },\n            value: datapayload.inventory_id,\n            children: dataasset.map((doc, idx) => /*#__PURE__*/_jsxs(_Select.Option, {\n              value: doc.id,\n              children: [doc.mig_id, \" - \", doc.model_name, \" - \", doc.asset_name]\n            }, idx))\n          })\n        })\n      })]\n    })\n  });\n};\n\nexport default DrawerTicketConnectItem;","map":null,"metadata":{},"sourceType":"module"}